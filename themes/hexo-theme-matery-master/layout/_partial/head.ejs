<%
    var title = page.title;

    // tags, categories, about pages title
    if (title == 'tags') {
        title = __('tags');
    } else if (title == 'categories') {
        title = __('categories');
    } else if (title == 'about') {
        title = __('about');
    }

    // archives, category, tag pages title
    if (is_archive()) {
        title = __('archives');
        if (is_month()) {
            title += ': ' + page.year + '/' + page.month;
        } else if (is_year()) {
            title += ': ' + page.year;
        }
    } else if (is_category()) {
        title = __('category') + ': ' + page.category;
    } else if (is_tag()) {
        title = __('tag') + ': ' + page.tag;
    }

    // final page title.
    var pageTitle = title ? title + ' | ' + config.title : config.title;

    // keywords.
    var keyWords = config.keywords ? config.keywords : config.title;
    if (page.keywords) {
        keyWords = page.keywords;
    } else {
    	keyWords = title ? title  + ', ' + keyWords : keyWords;
    }

    // description.
    var description = null;
    if (page.summary) {
        description = page.summary;
    } else if (page.hasOwnProperty('__post') && page.__post) {
        description = strip_html(page.content).substring(0, 120);
    }
    description = description ? description : pageTitle;

    let iconType = 'image/png'
    let faviconExt = theme.favicon.substr(theme.favicon.lastIndexOf('.') + 1, theme.favicon.length)
    if (faviconExt === 'png') {
        iconType = 'image/png'
    } else if (faviconExt === 'svg') {
        iconType = 'image/svg+xml'
    } else if (faviconExt === 'gif') {
        iconType = 'image/gif'
    } else if (faviconExt === 'jpeg') {
        iconType = 'image/jpeg'
    } else if (faviconExt === 'jpg') {
        iconType = 'image/jpeg'
    } else if (faviconExt === 'ico') {
        iconType = 'image/x-icon, image/vnd.microsoft.icon'
    } else {
        // more definitions
    }
%>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
	<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta name="keywords" content="<%= keyWords %>">
    <meta name="description" content="<%= description %>">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title><%= pageTitle %></title>
    <link rel="icon" type="<%= iconType %>" href="<%- theme.favicon %>">

    <link rel="stylesheet" type="text/css" href="<%- theme.libs.css.fontAwesome %>">
    <link rel="stylesheet" type="text/css" href="<%- theme.libs.css.materialize %>">
    <link rel="stylesheet" type="text/css" href="<%- theme.libs.css.aos %>">
    <link rel="stylesheet" type="text/css" href="<%- theme.libs.css.animate %>">
    <link rel="stylesheet" type="text/css" href="<%- theme.libs.css.lightgallery %>">
    <!-- 草莓图标库-->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/athink8/cdn/icon/strawberry/style.css">
	<!-- 是否开启jsDelivr 加速 -->
	<% if (theme.jsDelivr.enable) { %>
	    <link rel="stylesheet" type="text/css" href="<%- theme.jsDelivr.url %>/css/matery.css">
	    <link rel="stylesheet" type="text/css" href="<%- theme.jsDelivr.url %>/css/my.css">
	<% } else { %>
		<link rel="stylesheet" type="text/css" href="/css/matery.css">
		<link rel="stylesheet" type="text/css" href="/css/my.css">
	<%}%>
 
    <script src="<%- theme.libs.js.jquery %>"></script>

	<!-- 百度统计 -->
    <script>
    	var _hmt = _hmt || [];
    	(function() {
    	  var hm = document.createElement("script");
    	  hm.src = "https://hm.baidu.com/hm.js?4afaf8e6511f78b2416499c24b59bb0e";
    	  var s = document.getElementsByTagName("script")[0]; 
    	  s.parentNode.insertBefore(hm, s);
    	})();
    </script>
	 
	 <% if (theme.pageLoading.enable) { %>
	    <!-- 添加页面加载前动画-->
	     <style>
	    	#pageLoading {
	    		position: fixed;
	    		z-index: 1000;
	    		width: 100%;
	    		height: 100%;
	    		top: 0;
	    		left: 0;
	    		text-align: center;
	    		background-color: rgba(239,254,254,1);
	    		margin: 0 auto;
	    	}
	    	
	    	.pageLoadingInfo {
	    		margin: 0 auto;
	    		margin-top: 15%;
	    		width: 400px;
	    		height: 400px;
	    		color: #696969;
	    		font-family: 'Microsoft YaHei';
	    		font-size: 20px;
	    		text-align: center;
	    		overflow: hidden;
	    	}
	    	
	    	.pageLoadingInfo img {
	    		width: 200px;
	    		height: 200px;
	    		object-fit: cover;
	    	}
	     </style>
	    <script>
	    	var _LoadingHtml='<div id="pageLoading">'+
	    			'<div class="pageLoadingInfo">'+
	    			'<img class="LoadImg" src=<%- theme.pageLoading.url %> alt />'+
	    			'<p>&nbsp;&nbsp;<%- theme.pageLoading.ptitle %></p>'+
					'<p><%- theme.pageLoading.pface %></p>'+
	    			'</div></div>';
	    	document.write(_LoadingHtml);
	    	document.onreadystatechange = completeLoading;
	    	function completeLoading() {
	    	  if (document.readyState == "complete") {
	    	 var loadingMask = document.getElementById('pageLoading');
	    	 loadingMask.parentNode.removeChild(loadingMask);
	    	  }
	    	}
	    </script> 
	 <% } %>
	 
</head>
