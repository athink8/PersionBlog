<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>11分钟实现springBoot整合springcahe组件</title>
      <link href="/posts/e072c9f8.html"/>
      <url>/posts/e072c9f8.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟实现springBoot整合springcahe组件"><a href="#11分钟实现springBoot整合springcahe组件" class="headerlink" title="11分钟实现springBoot整合springcahe组件"></a>11分钟实现springBoot整合springcahe组件</h2><blockquote><p><code>宁可清贫自乐，不可浊富多忧</code></p></blockquote><hr><h3 id="一、是什么"><a href="#一、是什么" class="headerlink" title="一、是什么"></a>一、是什么</h3><p>SpringCache本身是一个缓存体系的抽象实现，并没有具体的缓存能力，要使用SpringCache还需要配合具体的缓存实现来完成。</p><p>缓存作用是将方法的运行结果进行缓存；以后再要相同的数据，直接从缓存中获取，不用调用方法；</p><h3 id="二、分析"><a href="#二、分析" class="headerlink" title="二、分析"></a>二、分析</h3><p>CacheManager管理多个Cache组件的，对缓存的真正CRUD操作在Cache组件中，每一个缓存组件有自己唯一一个名字；</p><ul><li><p>原理：</p><p>1、自动配置类 <code>CacheAutoConfiguration</code></p><p> 2、缓存的配置类</p><pre class=" language-java"><code class="language-java">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>GenericCacheConfigurationorg<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>JCacheCacheConfigurationorg<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>EhCacheCacheConfigurationorg<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>HazelcastCacheConfigurationorg<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>InfinispanCacheConfigurationorg<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>CouchbaseCacheConfigurationorg<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>RedisCacheConfigurationorg<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>CaffeineCacheConfigurationorg<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>GuavaCacheConfigurationorg<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>SimpleCacheConfiguration【默认】org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>NoOpCacheConfiguration</code></pre><p>3、哪个配置类默认生效：<code>SimpleCacheConfiguration</code>；</p><p>4、给容器中注册了一个CacheManager：<code>ConcurrentMapCacheManager</code></p><p>5、可以获取和创建ConcurrentMapCache类型的缓存组件；他的作用将数据保存在ConcurrentMap中；</p></li></ul><ul><li><p>运行流程：</p><p>@Cacheable：</p><p>1、方法运行之前，先去查询Cache（缓存组件），按照cacheNames指定的名字获取；</p><p>   （CacheManager先获取相应的缓存），第一次获取缓存如果没有Cache组件会自动创建。</p><p>2、去Cache中查找缓存的内容，使用一个key，默认就是方法的参数；</p><p>   key是按照某种策略生成的；默认是使用keyGenerator生成的，默认使用SimpleKeyGenerator生成key；</p><p>​       SimpleKeyGenerator生成key的默认策略；</p><p>​               如果没有参数；key=new SimpleKey()；</p><p>​               如果有一个参数：key=参数的值</p><p>​               如果有多个参数：key=new SimpleKey(params)；</p><p>3、没有查到缓存就调用目标方法；</p><p>4、将目标方法返回的结果，放进缓存中</p><p>​    @Cacheable标注的方法执行之前先来检查缓存中有没有这个数据，默认按照参数的值作为key去查询缓存，</p><p>​    如果没有就运行方法并将结果放入缓存；以后再来调用就可以直接使用缓存中的数据；</p></li><li><p>核心：</p><p>   1）、使用CacheManager【ConcurrentMapCacheManager】按照名字得到Cache【ConcurrentMapCache】组件</p><p>   2）、key使用keyGenerator生成的，默认是SimpleKeyGenerator</p></li></ul><h3 id="三、注解使用"><a href="#三、注解使用" class="headerlink" title="三、注解使用"></a>三、注解使用</h3><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/Spring%20cache1.png" alt=""></p><h4 id="Cacheable：触发缓存"><a href="#Cacheable：触发缓存" class="headerlink" title="@Cacheable：触发缓存"></a>@Cacheable：触发缓存</h4><ul><li><p>常用属性：</p><ul><li>cacheNames/value：指定缓存组件的名字;将方法的返回结果放在哪个缓存中，是数组的方式，可以指定多个缓存；</li><li>key：缓存数据使用的key；可以用它来指定。默认是使用方法参数的值  1-方法的返回值</li></ul><p>​           编写SpEL； #i d;参数id的值   #a0  #p0  #root.args[0]</p><p>​           getEmp[2]</p><ul><li><p>keyGenerator：key的生成器；可以自己指定key的生成器的组件id</p></li><li><p>key/keyGenerator：二选一使用;</p></li><li><p>cacheManager：指定缓存管理器；或者cacheResolver指定获取解析器</p></li><li><p>condition：指定符合条件的情况下才缓存；</p></li></ul><p>​           ,condition = “#id&gt;0”</p><p>​           condition = “#a0&gt;1”：第一个参数的值》1的时候才进行缓存</p><ul><li>unless:否定缓存；当unless指定的条件为true，方法的返回值就不会被缓存；可以获取到结果进行判断</li></ul><p>​           unless = “#result == null”</p><p>​           unless = “#a0==2”:如果第一个参数的值是2，结果不缓存；</p><ul><li>sync：是否使用异步模式</li><li>自定义 keyGenerator：</li></ul><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCacheConfig</span> <span class="token punctuation">{</span>     <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">"myKeyGenerator"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> KeyGenerator <span class="token function">keyGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">KeyGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                     <span class="token keyword">public</span> Object <span class="token function">generate</span><span class="token punctuation">(</span>Object target<span class="token punctuation">,</span> Method method<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>                            <span class="token keyword">return</span> method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"["</span><span class="token operator">+</span> Arrays<span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"]"</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></pre></li></ul><h4 id="CachePut：缓存更新"><a href="#CachePut：缓存更新" class="headerlink" title="@CachePut：缓存更新"></a>@CachePut：缓存更新</h4><p>既调用方法，又更新缓存数据；同步更新缓存</p><p>修改了数据库的某个数据，同时更新缓存；</p><ul><li><p>运行时机：</p><p>1、先调用目标方法</p><p>2、将目标方法的结果缓存起来</p></li></ul><h4 id="CacheEvict：缓存清除"><a href="#CacheEvict：缓存清除" class="headerlink" title="@CacheEvict：缓存清除"></a>@CacheEvict：缓存清除</h4><p>​    代表清除缓存操作是在方法运行之前执行，无论方法是否出现异常，缓存都清除</p><ul><li><p>key：指定要清除的数据</p></li><li><p>allEntries = true：指定清除这个缓存中所有的数据</p></li><li><p>beforeInvocation = false：缓存的清除是否在方法之前执行</p></li><li><p>默认代表缓存清除操作是在方法执行之后执行;如果出现异常缓存就不会清除</p><p> beforeInvocation = true：</p></li></ul><h3 id="四、SpEl"><a href="#四、SpEl" class="headerlink" title="四、SpEl"></a>四、SpEl</h3><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/Spring%20cache2.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> springcahe </tag>
            
            <tag> springBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟实现springBoot打war包和发布</title>
      <link href="/posts/ed7edb2d.html"/>
      <url>/posts/ed7edb2d.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟实现springBoot打war包和发布"><a href="#11分钟实现springBoot打war包和发布" class="headerlink" title="11分钟实现springBoot打war包和发布"></a>11分钟实现springBoot打war包和发布</h2><blockquote><p><code>平安是幸，知足是福，清心是禄，寡欲是寿</code></p></blockquote><p>用springBoot使开发变得很简便，其内置Tomcat更是实现了无法外置Tomcat启动项目，大大提高了便利性，然而有时候需要统一管理程序，或发布多个同端口项目时，不得不得打包成War包，方便防止在所需发布的服务器上。</p><h4 id="一、修改打包形式"><a href="#一、修改打包形式" class="headerlink" title="一、修改打包形式"></a>一、修改打包形式</h4><blockquote><p>在pom.xml里设置 </p></blockquote><pre><code>    &lt;packaging&gt;war&lt;/packaging&gt;</code></pre><h4 id="二、移除嵌入式tomcat插件"><a href="#二、移除嵌入式tomcat插件" class="headerlink" title="二、移除嵌入式tomcat插件"></a>二、移除嵌入式tomcat插件</h4><blockquote><p>在pom.xml里找到spring-boot-starter-web依赖节点，添加<exclusions></exclusions>之间的内容，</p></blockquote><pre><code>    &lt;dependency&gt;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;        &lt;!-- 移除嵌入式tomcat插件 --&gt;        &lt;exclusions&gt;            &lt;exclusion&gt;                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;                &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;            &lt;/exclusion&gt;        &lt;/exclusions&gt;    &lt;/dependency&gt;</code></pre><h4 id="三、添加servlet-api的依赖"><a href="#三、添加servlet-api的依赖" class="headerlink" title="三、添加servlet-api的依赖"></a>三、添加servlet-api的依赖</h4><blockquote><p>下面两种方式都可以，任选其一</p></blockquote><pre><code>    &lt;dependency&gt;        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;        &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;        &lt;version&gt;3.1.0&lt;/version&gt;        &lt;scope&gt;provided&lt;/scope&gt;    &lt;/dependency&gt;</code></pre><blockquote><pre><code>    &lt;dependency&gt;        &lt;groupId&gt;org.apache.tomcat&lt;/groupId&gt;        &lt;artifactId&gt;tomcat-servlet-api&lt;/artifactId&gt;        &lt;version&gt;8.0.36&lt;/version&gt;        &lt;scope&gt;provided&lt;/scope&gt;    &lt;/dependency&gt;</code></pre></blockquote><h4 id="四、修改启动类，并重写初始化方法"><a href="#四、修改启动类，并重写初始化方法" class="headerlink" title="四、修改启动类，并重写初始化方法"></a>四、修改启动类，并重写初始化方法</h4><blockquote><p>平常用main方法启动的方式，都有一个App的启动类，代码如下：</p></blockquote><pre><code>    @SpringBootApplication    public class Application {        public static void main(String[] args) {            SpringApplication.run(Application.class, args);        }    }</code></pre><blockquote><p>需要类似于web.xml的配置方式来启动spring上下文了，在Application类的同级添加一个SpringBootStartApplication类，其代码如下:</p></blockquote><pre><code>    /**     * 修改启动类，继承 SpringBootServletInitializer 并重写 configure 方法     */    public class SpringBootStartApplication extends SpringBootServletInitializer {        @Override        protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) {            // 注意这里要指向原先用main方法执行的Application启动类            return builder.sources(Application.class);        }    }</code></pre><h4 id="五-application-propertis添加"><a href="#五-application-propertis添加" class="headerlink" title="五 application.propertis添加"></a>五 application.propertis添加</h4><blockquote><p>当需要发布多个springboot项目到tomcat时需要添加如下，否则报错如下</p></blockquote><blockquote><p>Caused by: org.springframework.jmx.export.UnableToRegisterMBeanException: Unable to register MBean [HikariDataSource (HikariPool-2)] with key ‘dataSource’; nested exception is javax.management.InstanceAlreadyExistsException: com.zaxxer.hikari:name=dataSource,type=HikariDataSource</p></blockquote><pre><code>    spring.jmx.enabled=false；</code></pre><blockquote><p>或者如下：        </p></blockquote><pre><code>    spring.jmx.default-domain</code></pre><h4 id="六、打包部署"><a href="#六、打包部署" class="headerlink" title="六、打包部署"></a>六、打包部署</h4>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> war </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟实现SpringBoot实现邮件发送</title>
      <link href="/posts/f5433e08.html"/>
      <url>/posts/f5433e08.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟实现SpringBoot实现邮件发送"><a href="#11分钟实现SpringBoot实现邮件发送" class="headerlink" title="11分钟实现SpringBoot实现邮件发送"></a>11分钟实现SpringBoot实现邮件发送</h2><blockquote><p><code>一个人的快乐，不是因为他拥有的多，而是因为他计较的少</code></p></blockquote><hr><p>邮件发送在很多场景都需要使用，比如注册登录需要邮箱验证等；</p><p>而要想网络上实现邮件功能，必须要有专门的<strong>邮件服务器</strong>。这些邮件服务器类似于现实生活中的邮局，它主要负责接收用户投递过来的邮件，并把邮件投递到邮件接收者的电子邮箱中。</p><h3 id="一、邮件传输协议"><a href="#一、邮件传输协议" class="headerlink" title="一、邮件传输协议"></a>一、邮件传输协议</h3><ul><li><p>SMTP服务器地址</p><p>一般是 smtp.xxx.com，比如163邮箱是smtp.163.com，qq邮箱是smtp.qq.com。</p></li><li><p>SMTP协议</p><p>通常把处理用户smtp请求(邮件发送请求)的服务器称之为SMTP服务器(邮件发送服务器)。</p></li><li><p>POP3协议</p><p>通常把处理用户pop3请求(邮件接收请求)的服务器称之为POP3服务器(邮件接收服务器)。</p></li></ul><h3 id="二、邮件发送流程"><a href="#二、邮件发送流程" class="headerlink" title="二、邮件发送流程"></a>二、邮件发送流程</h3><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn@master/imgs/arctle/java%E9%82%AE%E7%AE%B1%E5%8F%91%E9%80%81.png" alt="image"></p><h3 id="三、SpringBoot整合"><a href="#三、SpringBoot整合" class="headerlink" title="三、SpringBoot整合"></a>三、SpringBoot整合</h3><ul><li><p>pom</p><pre class=" language-xml"><code class="language-xml"><span class="token comment" spellcheck="true">&lt;!--添加maill的依赖支持--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-mail<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre></li><li><p>yml</p><pre class=" language-yml"><code class="language-yml">spring:  mail:    #自定义的邮箱发送者    sender: athink8@163.com    host: smtp.163.com    #服务地址    username: athink8@163.com #邮件发送者    password: asdfghjkqwert    #smtp/POP3 密钥    protocol: smtp    #服务协议    default-encoding: UTF-8</code></pre></li><li><p>类MailBean</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>Serializable<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * author: jz * Time: 2019/9/24 13:54 **/</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MailBean</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> String recipient<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//邮件接收人</span>    <span class="token keyword">private</span> String subject<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//邮件主题</span>    <span class="token keyword">private</span> String content<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//邮件内容</span>    <span class="token keyword">private</span> String attachmentFilename<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//附件内容</span>    <span class="token keyword">private</span> String attachmentSource<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//附件路径内容</span>    <span class="token keyword">public</span> <span class="token function">MailBean</span><span class="token punctuation">(</span>String recipient<span class="token punctuation">,</span> String subject<span class="token punctuation">,</span> String content<span class="token punctuation">,</span> String attachmentFilename<span class="token punctuation">,</span> String attachmentSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>recipient <span class="token operator">=</span> recipient<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>subject <span class="token operator">=</span> subject<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>attachmentFilename <span class="token operator">=</span> attachmentFilename<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>attachmentSource <span class="token operator">=</span> attachmentSource<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token function">MailBean</span><span class="token punctuation">(</span>String recipient<span class="token punctuation">,</span> String subject<span class="token punctuation">,</span> String content<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>recipient <span class="token operator">=</span> recipient<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>subject <span class="token operator">=</span> subject<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token function">MailBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>   </code></pre></li><li><p>mail操作类</p><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> athink<span class="token punctuation">.</span>athink_travel<span class="token punctuation">.</span>service<span class="token punctuation">;</span><span class="token keyword">import</span> athink<span class="token punctuation">.</span>athink_travel<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>MailBean<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Value<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileSystemResource<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>SimpleMailMessage<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>javamail<span class="token punctuation">.</span>JavaMailSender<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>javamail<span class="token punctuation">.</span>MimeMessageHelper<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span>Service<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>internet<span class="token punctuation">.</span>MimeMessage<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>File<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * author: jz * Time: 2019/9/24 14:06 **/</span><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MailService</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${spring.mail.sender}"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//yml里的配置</span>    <span class="token keyword">private</span> String MAIL_SENDER<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//邮件发送者</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> JavaMailSender javaMailSender<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * 发送一个简单格式的邮件     *     * @param mailBean     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendSimpleMail</span><span class="token punctuation">(</span>MailBean mailBean<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            SimpleMailMessage simpleMailMessage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleMailMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//邮件发送人</span>            simpleMailMessage<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>MAIL_SENDER<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//邮件接收人</span>            simpleMailMessage<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getRecipient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//邮件主题</span>            simpleMailMessage<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//邮件内容</span>            simpleMailMessage<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//这里添加抄送人名称列表</span>            String<span class="token punctuation">[</span><span class="token punctuation">]</span> ccList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>MAIL_SENDER<span class="token punctuation">}</span><span class="token punctuation">;</span>            simpleMailMessage<span class="token punctuation">.</span><span class="token function">setCc</span><span class="token punctuation">(</span>ccList<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//这里添加密送人名称列表</span>            String<span class="token punctuation">[</span><span class="token punctuation">]</span> bccList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>MAIL_SENDER<span class="token punctuation">}</span><span class="token punctuation">;</span>            simpleMailMessage<span class="token punctuation">.</span><span class="token function">setBcc</span><span class="token punctuation">(</span>bccList<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//发送邮件</span>            javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>simpleMailMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"邮件发送success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"邮件发送失败："</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 发送一个HTML格式的邮件     *     * @param mailBean     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendHTMLMail</span><span class="token punctuation">(</span>MailBean mailBean<span class="token punctuation">)</span> <span class="token punctuation">{</span>        MimeMessage mimeMailMessage <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            mimeMailMessage <span class="token operator">=</span> javaMailSender<span class="token punctuation">.</span><span class="token function">createMimeMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            MimeMessageHelper mimeMessageHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeMessageHelper</span><span class="token punctuation">(</span>mimeMailMessage<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>MAIL_SENDER<span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getRecipient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//这里添加抄送人名称列表</span>            String<span class="token punctuation">[</span><span class="token punctuation">]</span> ccList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>MAIL_SENDER<span class="token punctuation">}</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setCc</span><span class="token punctuation">(</span>ccList<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//这里添加密送人名称列表</span>            String<span class="token punctuation">[</span><span class="token punctuation">]</span> bccList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>MAIL_SENDER<span class="token punctuation">}</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setBcc</span><span class="token punctuation">(</span>bccList<span class="token punctuation">)</span><span class="token punctuation">;</span>            javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>mimeMailMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"邮件发送success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"邮件发送失败："</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 发送带附件格式的邮件     *     * @param mailBean     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendAttachmentMail</span><span class="token punctuation">(</span>MailBean mailBean<span class="token punctuation">)</span> <span class="token punctuation">{</span>        MimeMessage mimeMailMessage <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            mimeMailMessage <span class="token operator">=</span> javaMailSender<span class="token punctuation">.</span><span class="token function">createMimeMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            MimeMessageHelper mimeMessageHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeMessageHelper</span><span class="token punctuation">(</span>mimeMailMessage<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>MAIL_SENDER<span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getRecipient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//这里添加抄送人名称列表</span>            String<span class="token punctuation">[</span><span class="token punctuation">]</span> ccList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>MAIL_SENDER<span class="token punctuation">}</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setCc</span><span class="token punctuation">(</span>ccList<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//这里添加密送人名称列表</span>            String<span class="token punctuation">[</span><span class="token punctuation">]</span> bccList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>MAIL_SENDER<span class="token punctuation">}</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setBcc</span><span class="token punctuation">(</span>bccList<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//文件路径</span>            FileSystemResource file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getAttachmentSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">addAttachment</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getAttachmentFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>            javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>mimeMailMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"邮件发送success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"邮件发送失败："</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * 发送带静态资源的邮件     *     * @param mailBean     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendInlineMail</span><span class="token punctuation">(</span>MailBean mailBean<span class="token punctuation">)</span> <span class="token punctuation">{</span>        MimeMessage mimeMailMessage <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            mimeMailMessage <span class="token operator">=</span> javaMailSender<span class="token punctuation">.</span><span class="token function">createMimeMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            MimeMessageHelper mimeMessageHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeMessageHelper</span><span class="token punctuation">(</span>mimeMailMessage<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>MAIL_SENDER<span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getRecipient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"&lt;html>&lt;body>"</span> <span class="token operator">+</span> mailBean<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//这里添加抄送人名称列表</span>            String<span class="token punctuation">[</span><span class="token punctuation">]</span> ccList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>MAIL_SENDER<span class="token punctuation">}</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setCc</span><span class="token punctuation">(</span>ccList<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//这里添加密送人名称列表</span>            String<span class="token punctuation">[</span><span class="token punctuation">]</span> bccList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>MAIL_SENDER<span class="token punctuation">}</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setBcc</span><span class="token punctuation">(</span>bccList<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//文件路径</span>            FileSystemResource file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getAttachmentSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">addAttachment</span><span class="token punctuation">(</span>mailBean<span class="token punctuation">.</span><span class="token function">getAttachmentFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>            javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>mimeMailMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"邮件发送success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"邮件发送失败："</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre></li><li><p>好了，测试下呗</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span>SpringRunner<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token annotation punctuation">@SpringBootTest</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AthinkTravelApplicationTests</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Autowired</span>    UserService userservice<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    MailService mailService<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// 做测试用</span>        MailBean mail1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MailBean</span><span class="token punctuation">(</span><span class="token string">"888880@qq.com"</span><span class="token punctuation">,</span> <span class="token string">"Athink -注册用户激活"</span><span class="token punctuation">,</span>                <span class="token string">"尊敬的用户你好："</span> <span class="token operator">+</span> <span class="token string">"&lt;br/>&lt;a href=\"http://localhost:8080/user/code?email="</span> <span class="token operator">+</span> <span class="token number">123</span> <span class="token operator">+</span> <span class="token string">"&amp;code="</span> <span class="token operator">+</span> <span class="token number">123</span> <span class="token operator">+</span> <span class="token string">"\">点击激活&lt;/a>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mailService<span class="token punctuation">.</span><span class="token function">sendHTMLMail</span><span class="token punctuation">(</span>mail1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><hr></li></ul>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
            <tag> JavaMail </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟学会springboot热部署</title>
      <link href="/posts/63687d21.html"/>
      <url>/posts/63687d21.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟学会springboot热部署"><a href="#11分钟学会springboot热部署" class="headerlink" title="11分钟学会springboot热部署"></a>11分钟学会springboot热部署</h2><blockquote><p><code>一个人的快乐，不是因为他拥有的多，而是因为他计较的少。</code></p></blockquote><h3 id="一、spring-boot-devtools"><a href="#一、spring-boot-devtools" class="headerlink" title="一、spring-boot-devtools"></a>一、spring-boot-devtools</h3><blockquote><p>spring为开发者提供了一个名为spring-boot-devtools的模块来使Spring Boot应用支持热部署，提高开发者的开发效率，无需手动重启Spring Boot应用。</p></blockquote><p><strong>devtools的原理</strong></p><blockquote><p>深层原理是使用了两个ClassLoader，一个Classloader加载那些不会改变的类（第三方Jar包），另一个ClassLoader加载会更改的类，称为restart ClassLoader,这样在有代码更改的时候，原来的restart ClassLoader 被丢弃，重新创建一个restart ClassLoader，由于需要加载的类相比较少，所以实现了较快的重启时间。</p></blockquote><h4 id="1-添加以下的配置："><a href="#1-添加以下的配置：" class="headerlink" title="1.添加以下的配置："></a>1.添加以下的配置：</h4><pre><code>&lt;dependency&gt;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;        &lt;optional&gt;true&lt;/optional&gt;&lt;/dependency&gt;&lt;plugin&gt;    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;    &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;    &lt;configuration&gt;     &lt;!--fork:如果没有该项配置,整个devtools不会起作用--&gt;        &lt;fork&gt;true&lt;/fork&gt;    &lt;/configuration&gt;&lt;/plugin&gt;</code></pre><p><strong>说明：</strong></p><p>（1） devtools可以实现页面热部署（即页面修改后会立即生效，这个可以直接在application.properties文件中配置spring.thymeleaf.cache=false来实现），<br>实现类文件热部署（类文件修改后不会立即生效），实现对属性文件的热部署。<br>即devtools会监听classpath下的文件变动，并且会立即重启应用（发生在保存时机），注意：因为其采用的虚拟机机制，该项重启是很快的</p><p>（2）配置了true后在修改java文件后也就支持了热启动，不过这种方式是属于项目重启（速度比较快的项目重启），会清空session中的值，也就是如果有用户登陆的话，项目重启后需要重新登陆。</p><blockquote><p>默认情况下，/META-INF/maven，/META-INF/resources，/resources，/static，/templates，/public这些文件夹下的文件修改不会使应用重启，但是会重新加载（devtools内嵌了一个LiveReload server，当资源发生改变时，浏览器刷新）。</p></blockquote><p><strong>devtools的配置</strong></p><p>在application.properties中配置spring.devtools.restart.enabled=false，此时restart类加载器还会初始化，但不会监视文件更新。</p><p>在SprintApplication.run之前调用System.setProperty(“spring.devtools.restart.enabled”, “false”);可以完全关闭重启支持，配置内容： </p><pre class=" language-xml"><code class="language-xml">#热部署生效spring.devtools.restart.enabled: true#设置重启的目录#spring.devtools.restart.additional-paths: src/main/java#classpath目录下的WEB-INF文件夹内容修改不重启spring.devtools.restart.exclude: WEB-INF/**</code></pre><p>二选一</p><pre><code> #热部署 devtools:   restart:     enabled: true     additional-paths: src/main/java</code></pre><h4 id="2-设置IDEA的自动编译："><a href="#2-设置IDEA的自动编译：" class="headerlink" title="2.设置IDEA的自动编译："></a>2.设置IDEA的自动编译：</h4><blockquote><p>File-Settings-Compiler勾选 Build Project automatically</p></blockquote><h4 id="3-设置IDEA允许"><a href="#3-设置IDEA允许" class="headerlink" title="3..设置IDEA允许"></a>3..设置IDEA允许</h4><blockquote><p>快捷键 ctrl + shift + alt + /,选择Registry,勾上 Compiler autoMake allow when app running</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
            <tag> 热部署 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟了解logback的配置和使用</title>
      <link href="/posts/19d5fc10.html"/>
      <url>/posts/19d5fc10.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟了解logback的配置和使用"><a href="#11分钟了解logback的配置和使用" class="headerlink" title="11分钟了解logback的配置和使用"></a>11分钟了解logback的配置和使用</h2><blockquote><p><code>不论你在什么时候开始，重要的是开始之后就不要停止</code></p></blockquote><h3 id="一、logback简介"><a href="#一、logback简介" class="headerlink" title="一、logback简介"></a>一、logback简介</h3><p>Logback 继承自 log4j。</p><p>Logback 的架构非常通用，适用不同的使用场景。Logback 被分成三个不同的模块：logback-core，logback-classic，logback-access。</p><p>logback-core 是其它两个模块的基础。logback-classic 模块可以看作是 log4j 的一个优化版本，它天然的支持 SLF4J，所以你可以随意的从其它日志框架（例如：log4j 或者 java.util.logging）切回到 logack。</p><p>logback-access 可以与 Servlet 容器进行整合，例如：Tomcat、Jetty。它提供了 http 访问日志的功能。</p><h3 id="二、logback配置"><a href="#二、logback配置" class="headerlink" title="二、logback配置"></a>二、logback配置</h3><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token comment" spellcheck="true">&lt;!--scan：当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true。scanPeriod：设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒当scan为true时，此属性生效。默认的时间间隔为1分钟。debug：当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false。--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">scan</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token attr-name">scanPeriod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60 seconds<span class="token punctuation">"</span></span> <span class="token attr-name">debug</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- 定义日志的根目录 --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>LOG_HOME<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/app/log<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token comment" spellcheck="true">&lt;!-- 定义日志文件名称 --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>appName<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>atguigu-springboot<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- ch.qos.logback.core.ConsoleAppender 表示控制台输出 --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stdout<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!--        日志输出格式：            %d表示日期时间，            %thread表示线程名，            %-5level：级别从左显示5个字符宽度            %logger{50} 表示logger名字最长50个字符，否则按照句点分割。             %msg：日志消息，            %n是换行符        --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- 滚动记录文件，先将日志记录到指定文件，当符合某个条件时，将日志记录到其他文件 --></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>appLogAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- 指定日志文件的名称 --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>${LOG_HOME}/${appName}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!--        当发生滚动时，决定 RollingFileAppender 的行为，涉及文件移动和重命名        TimeBasedRollingPolicy： 最常用的滚动策略，它根据时间来制定滚动策略，既负责滚动也负责出发滚动。        --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--            滚动时产生的文件的存放位置及文件名称 %d{yyyy-MM-dd}：按天进行日志滚动             %i：当文件大小超过maxFileSize时，按照i进行文件滚动            --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>${LOG_HOME}/${appName}-%d{yyyy-MM-dd}-%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--             可选节点，控制保留的归档文件的最大数量，超出数量就删除旧文件。假设设置每天滚动，            且maxHistory是365，则只保存最近365天的文件，删除之前的旧文件。注意，删除旧文件是，            那些为了归档而创建的目录也会被删除。            --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MaxHistory</span><span class="token punctuation">></span></span>365<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MaxHistory</span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--             当日志文件超过maxFileSize指定的大小是，根据上面提到的%i进行日志文件滚动 注意此处配置SizeBasedTriggeringPolicy是无法实现按文件大小进行滚动的，必须配置timeBasedFileNamingAndTriggeringPolicy            --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>100MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- 日志输出格式： --></span>             <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d{yyyy-MM-dd HH:mm:ss.SSS} [ %thread ] - [ %-5level ] [ %logger{50} : %line ] - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--         logger主要用于存放日志对象，也可以定义日志类型、级别        name：表示匹配的logger类型前缀，也就是包的前半部分        level：要记录的日志级别，包括 TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR        additivity：作用在于children-logger是否使用 rootLogger配置的appender进行输出，        false：表示只用当前logger的appender-ref，true：        表示当前logger的appender-ref和rootLogger的appender-ref都有效    --></span>    <span class="token comment" spellcheck="true">&lt;!-- hibernate logger --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.atguigu<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>debug<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token comment" spellcheck="true">&lt;!-- Spring framework logger --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.springframework<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>debug<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--     root与logger是父子关系，没有特别定义则默认为root，任何一个类只会和一个logger对应，    要么是定义的logger，要么是root，判断的关键在于找到这个logger，然后判断这个logger的appender和level。     --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stdout<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>appLogAppender<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span> </code></pre>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> logback </tag>
            
            <tag> 日志 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟了解Java中lombok使用</title>
      <link href="/posts/9eb5d68a.html"/>
      <url>/posts/9eb5d68a.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟了解Java中lombok使用"><a href="#11分钟了解Java中lombok使用" class="headerlink" title="11分钟了解Java中lombok使用"></a>11分钟了解Java中lombok使用</h2><blockquote><p><code>让我们将事前的忧虑，换为事前的思考和计划吧</code></p></blockquote><hr><h3 id="一、Lombok是什么？"><a href="#一、Lombok是什么？" class="headerlink" title="一、Lombok是什么？"></a>一、Lombok是什么？</h3><p>Lombok是一个Java库，能自动插入编辑器并构建工具，简化Java开发。通过添加注解的方式，不需要为类编写getter或setter方法，同时可以自动化变量。意思就是说可以只通过一个注解就让编译器自动编译类是getter、setter等重复写的方法。</p><blockquote><p>官方介绍<br>Project Lombok is a java library that automatically plugs into your editor and build tools, spicing up your java.Never write another getter or equals method again, with one annotation your class has a fully featured builder, Automate your logging variables, and much more.</p></blockquote><h3 id="二、如果使用？"><a href="#二、如果使用？" class="headerlink" title="二、如果使用？"></a>二、如果使用？</h3><h4 id="1-添加依赖"><a href="#1-添加依赖" class="headerlink" title="1.添加依赖"></a>1.添加依赖</h4><pre><code>    &lt;dependency&gt;        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;        &lt;artifactId&gt;lombok&lt;/artifactId&gt;        &lt;version&gt;1.18.10&lt;/version&gt;        &lt;scope&gt;provided&lt;/scope&gt;    &lt;/dependency&gt;</code></pre><h4 id="2-添加插件"><a href="#2-添加插件" class="headerlink" title="2.添加插件"></a>2.添加插件</h4><blockquote><p>在idea上安装lombok插件，并在File-Settings-build-AnnocationProcessors启用</p></blockquote><blockquote><p>开启该项是为了让Lombok注解在编译阶段起到作用。</p></blockquote><h4 id="3-常用注解"><a href="#3-常用注解" class="headerlink" title="3.常用注解"></a>3.常用注解</h4><blockquote><p><a href="https://projectlombok.org/features/all" target="_blank" rel="noopener">官方文档地址</a></p></blockquote><pre><code>val注解在字段，不可变局部变量var注解在字段，可变局部变量@NonNull注解在参数上，判断不为空，抛出NullPointerException@Cleanup执行调用close方法@Getter/@Setter注解在类或字段，注解在类时为所有字段生成Getter/setter方法，注解在字段上时只为该字段生成Getter/setter方法@ToString注解在类，添加toString方法@EqualsAndHashCode注解在类，生成hashCode和equals方法@NoArgsConstructor注解在类，生成无参的构造方法@RequiredArgsConstructor 注解在类，为类中需要特殊处理的字段生成构造方法，比如final和被@NonNull注解的字段。@AllArgsConstructor注解在类，生成包含类中所有字段的构造方法@Data注解在类，生成setter/getter、equals、canEqual、hashCode、toString方法，如为final属性，则不会为该属性生成setter方法@Value注解在类，相当于：final @ToString @EqualsAndHashCode @AllArgsConstructor @FieldDefaults(makeFinal = true, level = AccessLevel.PRIVATE) @Getter@Builder注解在类，注解后可赋值新对象和修改原对象的属性值@SneakyThrows注解在方法上，相当于添加了try-catch捕捉异常@Synchronized注解在方法上，锁定一个private的常量。如果当前类中没有这个常量，就会自动生成一个。@Getter(lazy=true)Getter高级版，会提高代码效率，同时由Lombok帮助你管理线程安全问题</code></pre>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> lombok </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟掌握Eclipse 常用快捷键</title>
      <link href="/posts/58d9ea91.html"/>
      <url>/posts/58d9ea91.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟掌握Eclipse-常用快捷键"><a href="#11分钟掌握Eclipse-常用快捷键" class="headerlink" title="11分钟掌握Eclipse 常用快捷键"></a>11分钟掌握Eclipse 常用快捷键</h2><blockquote><p><code>必须从过去的错误学习教训而非依赖过去的成功</code></p></blockquote><hr><p>很多人一开始学习开发时，都是使用Eclipse 来开发，然后肯定因为种种原因需要切换到Idea上；</p><p>而快捷键是必不可少且是快捷开发的途径之一，切换开发工具后，使用同一套快捷键可以减少重新学习工具的快捷键。</p><p>以下整理了Eclipse 常用的快捷键：</p><pre><code>1    执行(run)        alt+r2    提示补全 (Class Name Completion)    alt+/3    单行注释        ctrl + /4    多行注释    ctrl + shift + /5    向下复制一行 (Duplicate Lines)                ctrl+alt+down6    删除一行或选中行 (delete line)                ctrl+d7    向下移动行(move statement down)            alt+down8    向上移动行(move statement up)                alt+up9    向下开始新的一行(start new line)                shift+enter10    向上开始新的一行 (Start New Line before current)         ctrl+shift+enter11    如何查看源码 (class)        ctrl + 选中指定的结构 或 ctrl + shift + t12    万能解错/生成返回值变量                    alt + enter13    退回到前一个编辑的页面 (back)                alt + left14    进入到下一个编辑的页面(针对于上条) (forward)       alt + right15    查看继承关系(type hierarchy)                    F416    格式化代码(reformat code)                    ctrl+shift+F17    提示方法参数类型(Parameter Info)                ctrl+alt+/18    复制代码                            ctrl + c19    撤销                                ctrl + z20    反撤销                            ctrl + y21    剪切                                 ctrl + x22    粘贴                                ctrl + v23    保存                                ctrl + s24    全选                                ctrl + a25    选中数行，整体往后移动                    tab26    选中数行，整体往前移动                    shift + tab27    查看类的结构：类似于eclipse的outline            ctrl+o28    重构：修改变量名与方法名(rename)            alt+shift+r29    大写转小写/小写转大写(toggle case)            ctrl+shift+y30    生成构造器/get/set/toString                     alt +shift + s31    查看文档说明(quick documentation)            F232    收起所有的方法(collapse all)                    alt + shift + c33    打开所有方法(expand all)                    alt+shift+x34    打开代码所在硬盘文件夹(show in explorer)        ctrl+shift+x35    生成try-catch等(surround with)                alt+shift+z36    局部变量抽取为成员变量(introduce field)        alt+shift+f37    查找/替换(当前)                            ctrl+f38    查找(全局)                                ctrl+h39    查找文件                                double Shift40    查看类的继承结构图(Show UML Diagram)        ctrl + shift + u41    查看方法的多层重写结构(method hierarchy)         ctrl+alt+h42    添加到收藏(add to favorites)    ctrl+alt+f43    抽取方法(Extract Method)                alt+shift+m44    打开最近修改的文件(Recently Files)        ctrl+E45    关闭当前打开的代码栏(close)                ctrl + w46    关闭打开的所有代码栏(close all)            ctrl + shift + w47    快速搜索类中的错误(next highlighted error)        ctrl + shift + q48    选择要粘贴的内容(Show in Explorer)            ctrl+shift+v49    查找方法在哪里被调用(Call Hierarchy)            ctrl+shift+h</code></pre>]]></content>
      
      
      <categories>
          
          <category> 其他 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Eclipse </tag>
            
            <tag> 快捷键 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟了解Spring及mybatis等xml常见配置</title>
      <link href="/posts/1572e255.html"/>
      <url>/posts/1572e255.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟了解Spring及mybatis等xml常见配置"><a href="#11分钟了解Spring及mybatis等xml常见配置" class="headerlink" title="11分钟了解Spring及mybatis等xml常见配置"></a>11分钟了解Spring及mybatis等xml常见配置</h2><blockquote><p><code>世界会向那些有目标和远见的人让路。</code></p></blockquote><p>总所周知，在使用Spring、SpringMVC和mybatis开发时，往往要配置的文件信息太多了，自己敲的话太麻烦了，以下整理了关于了常见的配置信息，可直接复制粘贴修改使用就好啦。</p><h3 id="1-web-xml"><a href="#1-web-xml" class="headerlink" title="1.web.xml :"></a>1.web.xml :</h3><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;web-app xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot; xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot; id=&quot;WebApp_ID&quot; version=&quot;3.1&quot;&gt;&lt;!-- 欢迎页 --&gt;&lt;welcome-file-list&gt;    &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;&lt;/welcome-file-list&gt;&lt;!-- 配置Spring --&gt;  &lt;context-param&gt;     &lt;param-name&gt; contextConfigLocation &lt;/param-name&gt;     &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt; &lt;/context-param&gt; &lt;!-- 配置监听器 --&gt;&lt;listener&gt;     &lt;listener-class&gt; org.springframework.web.context.ContextLoaderListener &lt;/listener-class&gt; &lt;/listener&gt;  &lt;!-- 前端配置器 spring mvc--&gt;  &lt;servlet&gt;    &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;    &lt;init-param&gt;      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;      &lt;param-value&gt;classpath:spring-mvc.xml&lt;/param-value&gt;    &lt;/init-param&gt;    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;  &lt;/servlet&gt;  &lt;servlet-mapping&gt;    &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;    &lt;url-pattern&gt;/&lt;/url-pattern&gt;  &lt;/servlet-mapping&gt;  &lt;!-- 中文处理过滤 --&gt;  &lt;filter&gt;    &lt;filter-name&gt;Encoding&lt;/filter-name&gt;    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;    &lt;init-param&gt;      &lt;param-name&gt;encoding&lt;/param-name&gt;      &lt;param-value&gt;UTF-8&lt;/param-value&gt;    &lt;/init-param&gt;    &lt;init-param&gt;     &lt;param-name&gt;forceEncoding&lt;/param-name&gt;    &lt;param-value&gt;true&lt;/param-value&gt;&lt;/init-param&gt;  &lt;/filter&gt;  &lt;filter-mapping&gt;    &lt;filter-name&gt;Encoding&lt;/filter-name&gt;    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;  &lt;/filter-mapping&gt;&lt;/web-app&gt;</code></pre><h3 id="2-applicationContext-xml"><a href="#2-applicationContext-xml" class="headerlink" title="2. applicationContext.xml:"></a>2. applicationContext.xml:</h3><pre><code>&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot;xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.3.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.3.xsd&quot;&gt;&lt;!-- 加载db.properties --&gt;&lt;context:property-placeholder location=&quot;classpath:db.properties&quot;/&gt;&lt;!-- 加载log4j.properties --&gt;&lt;context:property-placeholder location=&quot;classpath:log4j.properties&quot; /&gt;&lt;!-- 配置数据源 --&gt;&lt;bean id=&quot;datasource&quot; class=&quot;org.apache.commons.dbcp2.BasicDataSource&quot;&gt;    &lt;property name=&quot;driverClassName&quot; value=&quot;${jdbc.driver}&quot;&gt;&lt;/property&gt;    &lt;property name=&quot;url&quot; value=&quot;${jdbc.url}&quot;&gt;&lt;/property&gt;    &lt;property name=&quot;username&quot; value=&quot;${jdbc.username}&quot;&gt;&lt;/property&gt;    &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot;&gt;&lt;/property&gt;    &lt;!-- 最大连接数 --&gt;    &lt;property name=&quot;maxTotal&quot; value=&quot;${jdbc.maxTotal}&quot;&gt;&lt;/property&gt;      &lt;!-- 最大空闲连接数 --&gt;    &lt;property name=&quot;maxIdle&quot; value=&quot;${jdbc.maxIdle}&quot;&gt;&lt;/property&gt;     &lt;!-- 初始化连接数 --&gt;     &lt;property name=&quot;initialSize&quot; value=&quot;${jdbc.initialSize}&quot;&gt;&lt;/property&gt; &lt;/bean&gt;&lt;!-- 配置事务管理 --&gt;&lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;    &lt;property name=&quot;dataSource&quot; ref=&quot;datasource&quot;/&gt;&lt;/bean&gt;&lt;!-- 开启事务注解 --&gt;&lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot;/&gt;&lt;!-- 配置 MyBatis的工厂 --&gt;&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;    &lt;!-- 数据源 --&gt;    &lt;property name=&quot;dataSource&quot; ref=&quot;datasource&quot; /&gt;    &lt;!-- 配置MyBatis的核心配置文件所在位置 --&gt;    &lt;property name=&quot;configLocation&quot; value=&quot;classpath:mybatis-config.xml&quot; /&gt;&lt;/bean&gt;&lt;!-- 配置Mapper 自动扫描器 --&gt;&lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;    &lt;property name=&quot;basePackage&quot; value=&quot;com.dao&quot;&gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- 开启注解扫描com.service --&gt;    &lt;context:component-scan base-package=&quot;com.service&quot;/&gt;&lt;/beans&gt;</code></pre><h3 id="3-mybatis-config-xml"><a href="#3-mybatis-config-xml" class="headerlink" title="3. mybatis-config.xml"></a>3. mybatis-config.xml</h3><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;&lt;configuration&gt;    &lt;typeAliases&gt;        &lt;package name=&quot;com.po&quot;/&gt;    &lt;/typeAliases&gt;    &lt;mappers&gt;        &lt;mapper resource=&quot;com/dao/Userdao.xml&quot;/&gt;    &lt;/mappers&gt;&lt;/configuration&gt;</code></pre><h3 id="4-mybatis-mapper-xml"><a href="#4-mybatis-mapper-xml" class="headerlink" title="4.mybatis-mapper.xml"></a>4.mybatis-mapper.xml</h3><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE mapper  PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;  &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.mapper.StudentMapper&quot;&gt;    &lt;select id=&quot;findbyid&quot; parameterType=&quot;Integer&quot; resultMap=&quot;StudentResult&quot;&gt;        select *from student where id=#{id}    &lt;/select&gt;&lt;/mapper&gt;</code></pre><h3 id="5-spring-mvc-xml"><a href="#5-spring-mvc-xml" class="headerlink" title="5.spring-mvc.xml"></a>5.spring-mvc.xml</h3><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;   xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;   xmlns:context=&quot;http://www.springframework.org/schema/context&quot;   xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;   xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans                           http://www.springframework.org/schema/beans/spring-beans.xsd                          http://www.springframework.org/schema/context                           http://www.springframework.org/schema/context/spring-context.xsd                          http://www.springframework.org/schema/mvc                          http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt;&lt;context:component-scan base-package=&quot;com.controller&quot;&gt;&lt;/context:component-scan&gt;&lt;!--&lt;bean name=&quot;/index&quot; class=&quot;com.controller.Controller1 &quot;/&gt;--&gt;&lt;!-- 定义视图 --&gt;&lt;bean id=&quot;viewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;    &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/jsp/&quot;&gt;&lt;/property&gt;    &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;&gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- 配置注解驱动     自动注册org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping    和org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter --&gt;&lt;mvc:annotation-driven /&gt;&lt;!-- 配置静态资源的访问映射 使其不被前端控制器拦截 --&gt;&lt;mvc:resources location=&quot;/js/&quot; mapping=&quot;/js/**&quot; /&gt;&lt;!-- 使用使用默认的服务器请求处理器自动判断筛选 --&gt;&lt;!-- &lt;mvc:default-servlet-handler/&gt; --&gt;&lt;!-- 配置拦截器 --&gt;&lt;mvc:interceptors&gt;    &lt;!-- 全局拦截器 --&gt;    &lt;!--&lt;bean class=&quot;&quot; /&gt;  --&gt;    &lt;mvc:interceptor&gt;           &lt;mvc:mapping path=&quot;/**&quot;/&gt; &lt;!-- 配置拦截器作用的路径 --&gt;        &lt;mvc:exclude-mapping path=&quot;&quot;/&gt; &lt;!-- 配置拦截器不作用的路径 --&gt;           &lt;bean class=&quot;com.interceptor.LoginInterceptor&quot;&gt;&lt;/bean&gt;    &lt;/mvc:interceptor&gt;&lt;/mvc:interceptors&gt;&lt;!-- 配置文件上传解析器 multipartResolver --&gt;&lt;!-- 因为CommonsMultipartResolver内部是引用MultipartResolver字符串来完成文件解析 所以指定的ID必须为multipartResolver  --&gt;&lt;bean id=&quot;multipartResolver&quot; class=&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;&gt;    &lt;!-- 配置缓存中最大阈值 低于此值，只保留在内存里，超过此阈值，生成硬盘上的临时文件 --&gt;    &lt;property name=&quot;maxInMemorySize&quot; value=&quot;&quot; /&gt;     &lt;!-- 推迟文件解析 --&gt;    &lt;property name=&quot;resolveLazily&quot; value=&quot;&quot;/&gt;    &lt;!-- 允许文件上传的最大尺寸 --&gt;    &lt;property name=&quot;maxUploadSize&quot; value=&quot;10485760&quot; /&gt;    &lt;!-- 默认编码格式 --&gt;    &lt;property name=&quot;defaultEncoding&quot; value=&quot;UTF-8&quot; /&gt;&lt;/bean&gt;&lt;!-- 显示装配的自定义的转换器 --&gt;&lt;!-- &lt;mvc:annotation-driven conversion-service=&quot;conversionservice1&quot;&gt;&lt;/mvc:annotation-driven&gt; --&gt;&lt;!-- 自定义类型转换器配置 converters--&gt;&lt;!-- &lt;bean id=&quot;conversionservice1&quot; class=&quot;org.springframework.context.support.ConversionServiceFactoryBean&quot;&gt;    &lt;property name=&quot;converters&quot;&gt;        &lt;set&gt;            &lt;bean class=&quot;com.converter.DateConverter&quot;&gt;&lt;/bean&gt;        &lt;/set&gt;    &lt;/property&gt;&lt;/bean&gt; --&gt;&lt;!-- 自定义类型转换器配置formatters--&gt;&lt;!-- &lt;bean id=&quot;conversionservice2&quot; class=&quot;org.springframework.format.support.FormattingConversionServiceFactoryBean&quot;&gt;    &lt;property name=&quot;formatters&quot;&gt;        &lt;set&gt;            &lt;bean class=&quot;com.converter.DateFormatter&quot;&gt;&lt;/bean&gt;        &lt;/set&gt;    &lt;/property&gt;&lt;/bean&gt; --&gt;&lt;/beans&gt;</code></pre><h3 id="6-db-properties"><a href="#6-db-properties" class="headerlink" title="6.db.properties"></a>6.db.properties</h3><pre><code>jdbc.driver=com.mysql.jdbc.Driverjdbc.url=jdbc:mysql://localhost:3306/test1jdbc.username=rootjdbc.password=123456jdbc.maxTotal=30jdbc.maxIdle=10jdbc.initialSize=5</code></pre><h3 id="7-log4j-properties"><a href="#7-log4j-properties" class="headerlink" title="7.log4j.properties"></a>7.log4j.properties</h3><pre><code># Global logging configurationlog4j.rootLogger=ERROR, stdout# MyBatis logging configuration...log4j.logger.com=DEBUG# Console output...log4j.appender.stdout=org.apache.log4j.ConsoleAppenderlog4j.appender.stdout.layout=org.apache.log4j.PatternLayoutlog4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</code></pre>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> mybatis </tag>
            
            <tag> SpringMVC </tag>
            
            <tag> 配置 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟学习Spring控制反转(IOC)方式</title>
      <link href="/posts/631766d3.html"/>
      <url>/posts/631766d3.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟学习Spring控制反转-IOC-方式"><a href="#11分钟学习Spring控制反转-IOC-方式" class="headerlink" title="11分钟学习Spring控制反转(IOC)方式"></a>11分钟学习Spring控制反转(IOC)方式</h2><blockquote><p><code>实现自己既定的目标，必须能耐得住寂寞单干。</code></p></blockquote><p>Spring框架则避免了调用者与工厂之间的耦合，通过spring容器“宏观调控”，调用者只要被动接受spring容器为调用者的成员变量赋值即可，而不需要主动获取被依赖对象。这种被动获取的方式就叫做依赖注入(DI)，又叫控制反转(IOC)。</p><h4 id="1-通过-setter-方法"><a href="#1-通过-setter-方法" class="headerlink" title="1.通过 setter 方法"></a>1.通过 setter 方法</h4><ul><li><p>bean类：</p><pre><code>  private User2 user2;  public void setUser2(User2 user2) {      this.user2 = user2;  }</code></pre></li><li><p>applicationContext.xml：</p><pre><code>  &lt;bean id=&quot;user2&quot; class=&quot;com.ioc.User2&quot;&gt;&lt;/bean&gt;  &lt;bean id=&quot;user1&quot; class=&quot;com.ioc.User1&quot;&gt;      &lt;property name=&quot;name&quot; value=&quot;jz&quot;&gt;&lt;/property&gt;      &lt;property name=&quot;user2&quot; ref=&quot;user2&quot;&gt;&lt;/property&gt;  &lt;/bean&gt;</code></pre></li></ul><h4 id="2-通过constructor-构造方法"><a href="#2-通过constructor-构造方法" class="headerlink" title="2.通过constructor 构造方法"></a>2.通过constructor 构造方法</h4><ul><li><p>bean类：</p><pre><code>  private User2 user2;      public User1(User2 user2){          this.user2=user2;      }</code></pre></li><li><p>applicationContext.xml：</p><pre><code>  &lt;bean id=&quot;user2&quot; class=&quot;com.ioc.User2&quot;&gt;&lt;/bean&gt;  &lt;bean id=&quot;user1&quot; class=&quot;com.ioc.User1&quot;&gt;      &lt;constructor-arg name=&quot;name&quot; value=&quot;jz&quot; /&gt;      &lt;constructor-arg name=&quot;user2&quot; ref=&quot;user2&quot; /&gt;  &lt;/bean&gt;</code></pre></li></ul>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> IOC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟了解Spring是什么</title>
      <link href="/posts/af11a1b8.html"/>
      <url>/posts/af11a1b8.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟了解Spring是什么"><a href="#11分钟了解Spring是什么" class="headerlink" title="11分钟了解Spring是什么"></a>11分钟了解Spring是什么</h2><blockquote><p><code>有志者自有千计万计，无志者只感千难万难。</code></p></blockquote><p>Spring框架是由于软件开发的复杂性而创建的。Spring使用的是基本的JavaBean来完成以前只可能由EJB完成的事情。然而，Spring的用途不仅仅限于服务器端的开发。从简单性、可测试性和松耦合性角度而言，绝大部分Java应用都可以从Spring中受益。</p><h3 id="1-Spring框架包的下载"><a href="#1-Spring框架包的下载" class="headerlink" title="1.Spring框架包的下载"></a>1.Spring框架包的下载</h3><blockquote><p><a href="http://repo.spring.io/simple/libs-release-local/org/springframework/spring/" target="_blank" rel="noopener">http://repo.spring.io/simple/libs-release-local/org/springframework/spring/</a></p></blockquote><h3 id="2-spring框架体系"><a href="#2-spring框架体系" class="headerlink" title="2.spring框架体系"></a>2.spring框架体系</h3><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/Spring1.png" alt="image"></p><h3 id="3-spring-核心容器"><a href="#3-spring-核心容器" class="headerlink" title="3.spring 核心容器"></a>3.spring 核心容器</h3><ul><li><p>BeanFactory接口: </p><p>  Resource resource = new FileSystemResource(“beans.xml”);<br>  BeanFactora factory = new XmlBeanFactory(resource);</p></li><li><p>ApplicationContext接口：</p><blockquote></blockquote><p>  从类路径下加载配置文件:  ClassPathXmlApplicationContext</p><p>  从硬盘的绝对路径下加载配置文件: FileSystemXmlApplication</p></li></ul><h3 id="4-spring配置详解"><a href="#4-spring配置详解" class="headerlink" title="4.spring配置详解"></a>4.spring配置详解</h3><h4 id="4-1、元素属性"><a href="#4-1、元素属性" class="headerlink" title="4.1、元素属性"></a>4.1、元素属性</h4><ul><li><p>bean元素:使用该元素描述需要spring容器管理对象</p></li><li><p>name属性:给被管理的对象起个名字,获得对象时getBean(“name值”)</p></li><li><p>class属性:被管理对象的完整类名</p></li><li><p>id属性:与name属性一模一样，名称不可重复，不能使用特殊字符</p></li></ul><p><strong>name和id之间的一些注意点:</strong></p><pre><code>1 配置两个相同的 id 或者 name 都不能通过。2 如果既配置了 id ，也配置了 name ，则两个都生效。如果id和name都没有指定，则用类全名作为name，如&lt;bean class=&quot;com.stamen.BeanLifeCycleImpl&quot;&gt;,则你可以通过getBean(&quot;com.stamen.BeanLifeCycleImpl&quot;)返回该实例3 如果配置基本类的时候，注解和配置文件都使用的时候，注解和配置文件中 name 相同的时候， 则两个冲突，配置文件生效。如果配置基本类的时候，注解和配置文件都使用的时候，注解和配置文件中 name 不相同的时候， 则两个不冲突，都能够生效。</code></pre><h4 id="4-2、bean元素进阶"><a href="#4-2、bean元素进阶" class="headerlink" title="4.2、bean元素进阶"></a>4.2、bean元素进阶</h4><ol><li><p>scope属性</p><p> (1) singleton  (默认值 )  </p><blockquote><p>单例对象:被标识为单例的对象在spring容器中只会存在一个实例</p></blockquote><p> (2) prototype    </p><blockquote><p>多例原型:被标识为多例的对象,每次在获得才会被创建,每次创建都是新的对象</p></blockquote><p> (3)request</p><blockquote><p>Web环境下,对象与request生命周期一致    </p></blockquote><p> (4)session</p><blockquote><p>Web环境下,对象与session生命周期一致</p></blockquote></li></ol><blockquote><p>总结:绝大多数情况下，使用单例singleton(默认值)，但是在与struts整合时候，务必要用prototype多例，因为struts2在每次请求都会创建一个新的Action，若为单例，在多请求情况下，每个请求找找spring拿的都是同一个action。</p></blockquote><ol start="2"><li><p>生命周期属性(了解)———初始化和销毁</p><p> (1)配置一个方法作为生命周期初始化方法,spring会在对象创建之后立刻调用 init-method</p><p> (2)配置一个方法作为生命周期的销毁方法,spring容器在关闭并销毁所有容器中的对象之前调用destory-method</p><pre><code> &lt;bean init-method=“init”  destory-method=“destory”&gt;&lt;/bean&gt; //对应注解为@PostConstruct &lt;bean name=“hello” class=“完整类名”&gt;&lt;/bean&gt; //对应注解为@PreDestory</code></pre></li></ol><ol start="3"><li><p>模块化配置,即分模块配置(导入其他spring配置文件)</p><pre><code> &lt;beans&gt;     &lt;import resource = “spring配置文件的全路径名” /&gt; &lt;/beans&gt;</code></pre></li></ol><h4 id="4-3、spring三种对象的创建方式"><a href="#4-3、spring三种对象的创建方式" class="headerlink" title="4.3、spring三种对象的创建方式"></a>4.3、spring三种对象的创建方式</h4><pre><code>(1)空参数构造(重要)(2)静态工厂创建(调用静态方法创建)调用UserFactory类的静态createUser方法创建名为user的对象,放入容器    &lt;bean name=&quot;user&quot; class=&quot;cn.itcats.UserFactory&quot; factory-method=&quot;createUser&quot;&gt;&lt;/bean&gt;(3)实例工厂创建(调用非静态方法创建)——需要配置两个bean，因为无法通过类名调用非静态方法    &lt;bean name=&quot;user2&quot; factory-bean=&quot;userFactory&quot; factory-method=&quot;createUser&quot;&gt;&lt;/bean&gt;    &lt;bean name=“userFactory” class=“cn.itcats.UserFactory”&gt;&lt;/bean&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> 简介 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟了解Spring JDBC和事务管理</title>
      <link href="/posts/461ef513.html"/>
      <url>/posts/461ef513.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟了解Spring-JDBC和事务管理"><a href="#11分钟了解Spring-JDBC和事务管理" class="headerlink" title="11分钟了解Spring JDBC和事务管理"></a>11分钟了解Spring JDBC和事务管理</h2><blockquote><p><code>不断的努力，不断的去接近梦想，越挫越勇，吃尽酸甜苦辣，能够抵御寒冬，也能够拥抱春天，这样的才叫生活。</code></p></blockquote><h3 id="1-Spring-JDBC-配置"><a href="#1-Spring-JDBC-配置" class="headerlink" title="1. Spring JDBC 配置"></a>1. Spring JDBC 配置</h3><h4 id="1-1-对应的包类："><a href="#1-1-对应的包类：" class="headerlink" title="1.1 对应的包类："></a>1.1 对应的包类：</h4><ul><li>org.springframework.jdbc.core.JdbcTemplate  提供访问数据库基本属性和操作</li><li>org.springframework.jdbc.datasource.DriverManagerDataSource 获取数据库连接</li><li>org.springframework.jdbc.support.SQLExceptionTranslator  处理SQL Exception 完成转译</li></ul><pre><code>    &lt;bean id=&quot;datasource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt;        &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;        &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/classes&quot;/&gt;        &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;        &lt;property name=&quot;password&quot; value=&quot;123456&quot; /&gt;    &lt;/bean&gt;        &lt;bean id=&quot;jdbctemplate&quot; class=&quot;org.springframework.jdbc.core.JdbcTemplate&quot;&gt;        &lt;property name=&quot;dataSource&quot; ref=&quot;datasource&quot;&gt;&lt;/property&gt;    &lt;/bean&gt;</code></pre><h4 id="1-2-JdbcTemplate-常用方法"><a href="#1-2-JdbcTemplate-常用方法" class="headerlink" title="1.2 JdbcTemplate 常用方法"></a>1.2 JdbcTemplate 常用方法</h4><h5 id="1-2-1数据库创建创建删除修改等"><a href="#1-2-1数据库创建创建删除修改等" class="headerlink" title="1.2.1数据库创建创建删除修改等:"></a>1.2.1数据库创建创建删除修改等:</h5><pre><code>    execute()  </code></pre><h5 id="1-2-2数据的增删改-："><a href="#1-2-2数据的增删改-：" class="headerlink" title="1.2.2数据的增删改 ："></a>1.2.2数据的增删改 ：</h5><ul><li>int update(String sql)  执行Sql语句 返回受影响的行数;</li><li>int update(PrepareedStatementCreator psc)  执行 PrepareedStatementCreator 返回语句 返回行数;</li><li>int update(String sql，PrepareedStatementCreator psc) 执行 PrepareedStatementCreator 设置的Sql 语句 返回行数;</li><li>int update(String sql,Object..args)  使用Object…设置Sql语句中的参数，参数不能为NULL 返回行数； </li></ul><pre><code>    public int upadte(Userdao userdao) {            String sql=&quot;update user set username=?,password=? where id=?&quot;;            Object[] object=new Object[]{                    userdao.getUsername(),                    userdao.getPassword(),                    userdao.getId()            };            int i=this.jdbcTemplate.update(sql, object);            return i;        }</code></pre><h5 id="1-2-3-数据表的查询"><a href="#1-2-3-数据表的查询" class="headerlink" title="1.2.3 数据表的查询"></a>1.2.3 数据表的查询</h5><ul><li>List query(String sql,RowMapper rowmapper)  执行Sql语句 通过RowMapper返回一个List集合；</li><li>List query(String sql,PrepareedStatementCreator psc,RowMapper rowmapper)   执行sql语句创建PrepareedStatement对象，通过RowMapper返回一个List对象；</li><li>List query(String sql,Object[] args,RowMapper rowmapper)  使用Object[] 的值设置Sql语句参数，采用RowMapper回调方法返回LIST 数据；</li><li>queryForObject(String sql,RowMapper rowmapper,Object..args) 将args 参数绑定Sql语句中，通过RowMapper返回一个Object类型的单行记录；</li><li>queryForList(String sql,Object[] args,class<T> elementType)  返回多行数据的结果，但必须是返回列表，elementType 参数返回的是List 元素类型；</li></ul><h3 id="2-Spring-事务管理"><a href="#2-Spring-事务管理" class="headerlink" title="2.Spring 事务管理"></a>2.Spring 事务管理</h3><h4 id="2-1-Spring-所需要包类："><a href="#2-1-Spring-所需要包类：" class="headerlink" title="2.1 Spring 所需要包类："></a>2.1 Spring 所需要包类：</h4><blockquote><p>spring-tx-4.3.6.RELEASE.jar</p></blockquote><h4 id="2-2-事务管理器："><a href="#2-2-事务管理器：" class="headerlink" title="2.2 事务管理器："></a>2.2 事务管理器：</h4><ul><li><p>DataSourceTransactionManager ：</p><blockquote><p>位于org.springframework.jdbc.datasource包中，数据源事务管理器，提供对单个javax.sql.DataSource事务管理，用于Spring JDBC抽象框架、iBATIS或MyBatis框架的事务管理；</p></blockquote></li><li><p>JdoTransactionManager ：</p><blockquote><p>位于org.springframework.orm.jdo包中，提供对单个javax.jdo.PersistenceManagerFactory事务管理，用于集成JDO框架时的事务管理；</p></blockquote></li><li><p>JpaTransactionManager ：</p><blockquote><p>位于org.springframework.orm.jpa包中，提供对单个javax.persistence.EntityManagerFactory事务支持，用于集成JPA实现框架时的事务管理；</p></blockquote></li><li><p>HibernateTransactionManager ：</p><blockquote><p>位于org.springframework.orm.hibernate3包中，提供对单个org.hibernate.SessionFactory事务支持，用于集成Hibernate框架时的事务管理；该事务管理器只支持Hibernate3+版本，且Spring3.0+版本只支持Hibernate 3.2+版本；</p></blockquote></li><li><p>JtaTransactionManager ：</p><blockquote><p>位于org.springframework.transaction.jta包中，提供对分布式事务管理的支持，并将事务管理委托给Java EE应用服务器事务管理器；</p></blockquote></li><li><p>OC4JjtaTransactionManager ：</p><blockquote><p>位于org.springframework.transaction.jta包中，Spring提供的对OC4J10.1.3+应用服务器事务管理器的适配器，此适配器用于对应用服务器提供的高级事务的支持；</p></blockquote></li><li><p>WebSphereUowTransactionManager ：</p><blockquote><p>位于org.springframework.transaction.jta包中，Spring提供的对WebSphere 6.0+应用服务器事务管理器的适配器，此适配器用于对应用服务器提供的高级事务的支持；</p></blockquote></li><li><p>WebLogicJtaTransactionManager ：</p><blockquote><p>位于org.springframework.transaction.jta包中，Spring提供的对WebLogic 8.1+应用服务器事务管理器的适配器，此适配器用于对应用服务器提供的高级事务的支持。</p></blockquote></li></ul><h4 id="2-3-事务定义："><a href="#2-3-事务定义：" class="headerlink" title="2.3 事务定义："></a>2.3 事务定义：</h4><blockquote><p>声明式事务通过 -传播行为，隔离级别，只读提示，事务超时及回滚规则-来进行定义。 </p></blockquote><h5 id="2-3-1事务传播行为："><a href="#2-3-1事务传播行为：" class="headerlink" title="2.3.1事务传播行为："></a>2.3.1事务传播行为：</h5><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/SpringJdbc1.png" alt="image"></p><h4 id="2-4-基于XML-声明事务"><a href="#2-4-基于XML-声明事务" class="headerlink" title="2.4 基于XML 声明事务"></a>2.4 基于XML 声明事务</h4><pre><code>    &lt;!--配置事务管理器 依赖数据源  --&gt;    &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;            &lt;property name=&quot;dataSource&quot; ref=&quot;datasource&quot;&gt;&lt;/property&gt;    &lt;/bean&gt;    &lt;!-- 配置事务通知 --&gt;    &lt;tx:advice id=&quot;txadvice&quot; transaction-manager=&quot;transactionManager&quot;&gt;        &lt;tx:attributes&gt;            &lt;tx:method name=&quot;*&quot; propagation=&quot;REQUIRED&quot;     isolation=&quot;DEFAULT&quot; read-only=&quot;false&quot; timeout=&quot;-1&quot; /&gt;        &lt;/tx:attributes&gt;    &lt;/tx:advice&gt;    &lt;!-- 配置AOP --&gt;    &lt;aop:config&gt;        &lt;aop:pointcut id=&quot;pointcut1&quot; expression=&quot;execution(* com.dao.*.*(..))&quot; /&gt;        &lt;aop:advisor advice-ref=&quot;txadvice&quot; pointcut-ref=&quot;pointcut1&quot;/&gt;    &lt;/aop:config&gt;</code></pre><h4 id="2-5-基于Annotation-声明事务"><a href="#2-5-基于Annotation-声明事务" class="headerlink" title="2.5 基于Annotation 声明事务"></a>2.5 基于Annotation 声明事务</h4><pre><code>    &lt;!--配置事务管理器 依赖数据源  --&gt;    &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;            &lt;property name=&quot;dataSource&quot; ref=&quot;datasource&quot;&gt;&lt;/property&gt;    &lt;/bean&gt;    &lt;!-- 配置事务通知 --&gt;    &lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot; /&gt;</code></pre><blockquote><p>在使用的bean类或方法前 添加 @Transactional</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Spring JDBC </tag>
            
            <tag> Spring 事务 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟搭建专属自己的影视网站</title>
      <link href="/posts/baaed056.html"/>
      <url>/posts/baaed056.html</url>
      
        <content type="html"><![CDATA[<h3 id="11分钟搭建专属自己的影视网站"><a href="#11分钟搭建专属自己的影视网站" class="headerlink" title="11分钟搭建专属自己的影视网站"></a>11分钟搭建专属自己的影视网站</h3><blockquote><p><code>你再怎么称赞我，我也不会高兴的，你这个混蛋~</code></p></blockquote><hr><p><strong>演示站：<a href="https://movie.onfree.cn" target="_blank" rel="noopener">https://movie.onfree.cn</a></strong></p><h3 id="一、前期准备"><a href="#一、前期准备" class="headerlink" title="一、前期准备"></a>一、前期准备</h3><ul><li><p>服务器/虚拟主机（阿里云服务器挺便宜的&gt; <a href="https://blog.onfree.cn/posts/24658226.html">阿里云服务器￥67/年</a>）</p></li><li><p>域名（阿里云购买或其他服务商）</p></li><li><p>下载个你喜欢的影视CMS（如苹果CMS、<a href="https://www.seacms.net" target="_blank" rel="noopener">海洋CMS</a>）</p></li></ul><h3 id="二、环境部署"><a href="#二、环境部署" class="headerlink" title="二、环境部署"></a>二、环境部署</h3><ol><li>把下载的海洋CMS压缩包上传你的服务器上并解压，建议放在根目录上，测试发现二级目录经常出现奇怪的错误；</li></ol><blockquote><p>推荐云服务器使宝塔工具，用直观的图形界面来操控linix命令，简单又好用，详情看官网帮助文档&gt;<a href="https://www.bt.cn/?invite_code=MV9wbWVjcGY=" target="_blank" rel="noopener">宝塔官网</a></p></blockquote><ol start="2"><li><p>创建个数据库，mySQL的就行。</p></li><li><p>浏览器访问：http://你的域名/install/index.php</p></li></ol><ul><li>出现欢迎界面，即代表环境对了一点。</li></ul><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian1.png" alt=""></p><ul><li>点击开始</li></ul><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian2.png" alt=""></p><ul><li>查看并点击同意</li></ul><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian3.png" alt=""></p><ul><li>按住提示修改你的环境要求，如php版本没够就升级，文件无权限就赋予权限..</li></ul><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian4.png" alt=""></p><ul><li><p>按要求填写你的实际信息</p><blockquote><p>数据库信息一定要和你一开始创建的一样</p><p>管理员设置信息设置成你自己喜欢且记得住的账号信息，方便下面登录后台</p></blockquote></li><li><p>如果数据库信息不对，会出现提示</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian5.png" alt=""></p></li><li><p>如果安装成功后，出现以下</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian6.png" alt=""></p></li></ul><blockquote><p>观察到后台地址后那一堆乱序英文了嘛，那就是你的后台文件夹，注意隐蔽，可以到你的服务器文件上直接修改成别的文件夹名</p></blockquote><h3 id="三、后台配置"><a href="#三、后台配置" class="headerlink" title="三、后台配置"></a>三、后台配置</h3><ul><li><p>登录后台</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian7.png" alt=""></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian8.png" alt=""></p></li><li><p>百度搜索资源采集站，随意挑个打开，找到它的帮助文档，查找它的<code>采集网址</code>和<code>播放器名</code></p></li></ul><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian9.png" alt=""></p><ul><li><p>后台点击 <code>系统&gt;播放来源设置</code>  添加播放器名,如 zuidam3u8 和 zuidall</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian10.png" alt=""></p></li><li><p>继续点击刚才添加的，点击修改播放器代码</p></li></ul><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian11.png" alt=""></p><blockquote><p>凡是资源站上什么的 xxxm3u8 都可以统一写以下代码就行</p></blockquote><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/1999/xhtml<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>IE<span class="token punctuation">=</span>EmulateIE9<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Content-Type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/html; charset<span class="token punctuation">=</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SCRIPT</span> <span class="token attr-name">LANGUAGE</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JavaScript1.2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">adTime<span class="token operator">=</span>parent<span class="token punctuation">.</span>adsTime<span class="token punctuation">;</span> chanceAd<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">var</span> ns<span class="token operator">=</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>layers<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> ie<span class="token operator">=</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>all<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> w3<span class="token operator">=</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>getElementById  <span class="token operator">&amp;&amp;</span>  <span class="token operator">!</span>ie<span class="token punctuation">)</span><span class="token punctuation">;</span>adCount<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">initAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ns  <span class="token operator">&amp;&amp;</span>  <span class="token operator">!</span>ie  <span class="token operator">&amp;&amp;</span>  <span class="token operator">!</span>w3<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>ie<span class="token punctuation">)</span>             adDiv<span class="token operator">=</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'document.all.sponsorAdDiv.style'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span>        adDiv<span class="token operator">=</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'document.layers["sponsorAdDiv"]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>w3<span class="token punctuation">)</span>        adDiv<span class="token operator">=</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'document.getElementById("sponsorAdDiv").style'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        randAd<span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>chanceAd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ie<span class="token operator">||</span>w3<span class="token punctuation">)</span>        adDiv<span class="token punctuation">.</span>visibility<span class="token operator">=</span><span class="token string">"visible"</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>        adDiv<span class="token punctuation">.</span>visibility <span class="token operator">=</span><span class="token string">"show"</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>randAd<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">showAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"zzzif"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src<span class="token operator">=</span>parent<span class="token punctuation">.</span>adsPage<span class="token punctuation">;</span>         document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"zzzif"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>height<span class="token operator">=</span>parent<span class="token punctuation">.</span>playerh <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"zzzif"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token operator">=</span>parent<span class="token punctuation">.</span>playerw<span class="token punctuation">;</span>         <span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">showAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span>adCount<span class="token operator">&lt;</span>adTime<span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>adCount<span class="token operator">+</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ie<span class="token punctuation">)</span><span class="token punctuation">{</span>documentWidth  <span class="token operator">=</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>offsetWidth<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollLeft<span class="token number">-20</span><span class="token punctuation">;</span>        documentHeight <span class="token operator">=</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>offsetHeight<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop<span class="token number">-20</span><span class="token punctuation">;</span><span class="token punctuation">}</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">{</span>documentWidth<span class="token operator">=</span>window<span class="token punctuation">.</span>innerWidth<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>window<span class="token punctuation">.</span>pageXOffset<span class="token number">-20</span><span class="token punctuation">;</span>        documentHeight<span class="token operator">=</span>window<span class="token punctuation">.</span>innerHeight<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>window<span class="token punctuation">.</span>pageYOffset<span class="token number">-20</span><span class="token punctuation">;</span><span class="token punctuation">}</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>w3<span class="token punctuation">)</span><span class="token punctuation">{</span>documentWidth<span class="token operator">=</span>self<span class="token punctuation">.</span>innerWidth<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>window<span class="token punctuation">.</span>pageXOffset<span class="token number">-20</span><span class="token punctuation">;</span>        documentHeight<span class="token operator">=</span>self<span class="token punctuation">.</span>innerHeight<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>window<span class="token punctuation">.</span>pageYOffset<span class="token number">-20</span><span class="token punctuation">;</span><span class="token punctuation">}</span>        adDiv<span class="token punctuation">.</span>left<span class="token operator">=</span>documentWidth<span class="token number">-200</span><span class="token punctuation">;</span>adDiv<span class="token punctuation">.</span>top <span class="token operator">=</span>documentHeight<span class="token number">-200</span><span class="token punctuation">;</span>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">"showAd()"</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token function">closeAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">closeAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span>ie<span class="token operator">||</span>w3<span class="token punctuation">)</span>adDiv<span class="token punctuation">.</span>display<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">;</span><span class="token keyword">else</span>adDiv<span class="token punctuation">.</span>visibility <span class="token operator">=</span><span class="token string">"hide"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>onload<span class="token operator">=</span>initAd<span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sponsorAdDiv<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">visibility</span><span class="token punctuation">:</span>hidden<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span><span class="token number">999</span><span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span><span class="token number">105%</span><span class="token punctuation">;</span> <span class="token property">width</span><span class="token punctuation">:</span><span class="token number">100%</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>zzzif<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>zzzif<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">scrolling</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no<span class="token punctuation">"</span></span> <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>player<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript"><span class="token keyword">var</span> playerh<span class="token operator">=</span>parent<span class="token punctuation">.</span>playerh<span class="token punctuation">;</span><span class="token keyword">var</span> str <span class="token operator">=</span> parent<span class="token punctuation">.</span>now<span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'player'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML  <span class="token operator">=</span> <span class="token string">'&lt;iframe width="100%" height="'</span><span class="token operator">+</span>playerh<span class="token operator">+</span><span class="token string">'" src="https://tool.onfree.cn/jiexi/m3u8jx/?url='</span><span class="token operator">+</span>parent<span class="token punctuation">.</span>now<span class="token operator">+</span><span class="token string">'" frameborder="0" border="0" marginwidth="0" marginheight="0" scrolling="no"  allowfullscreen="true">&lt;/iframe>'</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><blockquote><p>然后相对的另外一个播放器修改代码统一如下</p></blockquote><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/1999/xhtml<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>IE<span class="token punctuation">=</span>EmulateIE9<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Content-Type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/html; charset<span class="token punctuation">=</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SCRIPT</span> <span class="token attr-name">LANGUAGE</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JavaScript1.2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">adTime<span class="token operator">=</span>parent<span class="token punctuation">.</span>adsTime<span class="token punctuation">;</span> chanceAd<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">var</span> ns<span class="token operator">=</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>layers<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> ie<span class="token operator">=</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>all<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> w3<span class="token operator">=</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>getElementById  <span class="token operator">&amp;&amp;</span>  <span class="token operator">!</span>ie<span class="token punctuation">)</span><span class="token punctuation">;</span>adCount<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">initAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ns  <span class="token operator">&amp;&amp;</span>  <span class="token operator">!</span>ie  <span class="token operator">&amp;&amp;</span>  <span class="token operator">!</span>w3<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>ie<span class="token punctuation">)</span>             adDiv<span class="token operator">=</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'document.all.sponsorAdDiv.style'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span>        adDiv<span class="token operator">=</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'document.layers["sponsorAdDiv"]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>w3<span class="token punctuation">)</span>        adDiv<span class="token operator">=</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'document.getElementById("sponsorAdDiv").style'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        randAd<span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>chanceAd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ie<span class="token operator">||</span>w3<span class="token punctuation">)</span>        adDiv<span class="token punctuation">.</span>visibility<span class="token operator">=</span><span class="token string">"visible"</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>        adDiv<span class="token punctuation">.</span>visibility <span class="token operator">=</span><span class="token string">"show"</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>randAd<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">showAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"zzzif"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src<span class="token operator">=</span>parent<span class="token punctuation">.</span>adsPage<span class="token punctuation">;</span>         document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"zzzif"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>height<span class="token operator">=</span>parent<span class="token punctuation">.</span>playerh <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"zzzif"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token operator">=</span>parent<span class="token punctuation">.</span>playerw<span class="token punctuation">;</span>         <span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">showAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span>adCount<span class="token operator">&lt;</span>adTime<span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>adCount<span class="token operator">+</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ie<span class="token punctuation">)</span><span class="token punctuation">{</span>documentWidth  <span class="token operator">=</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>offsetWidth<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollLeft<span class="token number">-20</span><span class="token punctuation">;</span>        documentHeight <span class="token operator">=</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>offsetHeight<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop<span class="token number">-20</span><span class="token punctuation">;</span><span class="token punctuation">}</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">{</span>documentWidth<span class="token operator">=</span>window<span class="token punctuation">.</span>innerWidth<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>window<span class="token punctuation">.</span>pageXOffset<span class="token number">-20</span><span class="token punctuation">;</span>        documentHeight<span class="token operator">=</span>window<span class="token punctuation">.</span>innerHeight<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>window<span class="token punctuation">.</span>pageYOffset<span class="token number">-20</span><span class="token punctuation">;</span><span class="token punctuation">}</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>w3<span class="token punctuation">)</span><span class="token punctuation">{</span>documentWidth<span class="token operator">=</span>self<span class="token punctuation">.</span>innerWidth<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>window<span class="token punctuation">.</span>pageXOffset<span class="token number">-20</span><span class="token punctuation">;</span>        documentHeight<span class="token operator">=</span>self<span class="token punctuation">.</span>innerHeight<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>window<span class="token punctuation">.</span>pageYOffset<span class="token number">-20</span><span class="token punctuation">;</span><span class="token punctuation">}</span>        adDiv<span class="token punctuation">.</span>left<span class="token operator">=</span>documentWidth<span class="token number">-200</span><span class="token punctuation">;</span>adDiv<span class="token punctuation">.</span>top <span class="token operator">=</span>documentHeight<span class="token number">-200</span><span class="token punctuation">;</span>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">"showAd()"</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token function">closeAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">closeAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span>ie<span class="token operator">||</span>w3<span class="token punctuation">)</span>adDiv<span class="token punctuation">.</span>display<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">;</span><span class="token keyword">else</span>adDiv<span class="token punctuation">.</span>visibility <span class="token operator">=</span><span class="token string">"hide"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>onload<span class="token operator">=</span>initAd<span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sponsorAdDiv<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">visibility</span><span class="token punctuation">:</span>hidden<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span><span class="token number">999</span><span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span><span class="token number">105%</span><span class="token punctuation">;</span> <span class="token property">width</span><span class="token punctuation">:</span><span class="token number">100%</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>zzzif<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>zzzif<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">scrolling</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no<span class="token punctuation">"</span></span> <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>player<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript"><span class="token keyword">var</span> playerh<span class="token operator">=</span>parent<span class="token punctuation">.</span>playerh<span class="token punctuation">;</span><span class="token keyword">var</span> str <span class="token operator">=</span> parent<span class="token punctuation">.</span>now<span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'player'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML  <span class="token operator">=</span> <span class="token string">'&lt;iframe width="100%" height="'</span><span class="token operator">+</span>playerh<span class="token operator">+</span><span class="token string">'" src="'</span><span class="token operator">+</span>parent<span class="token punctuation">.</span>now<span class="token operator">+</span><span class="token string">'" frameborder="0" border="0" marginwidth="0" marginheight="0" scrolling="no"  allowfullscreen="true">&lt;/iframe>'</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><ul><li>然后点击 <code>采集 &gt; 资源库管理</code>，添加你百度找到的资源库地址</li></ul><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian12.png" alt=""></p><ul><li>然后点击 <code>采集 &gt; 资源库列表</code></li></ul><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian13.png" alt=""></p><ul><li><p>点击<code>分类绑定</code>，并一一绑定你的信息</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian14.png" alt=""></p></li><li><p>绑定完继续点击<code>资源库列表</code>，点击 <code>采集所有</code></p></li></ul><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian13.png" alt=""></p><ul><li>等待完成就好啦</li><li>其他一些信息修改和细节自己摸索啦！</li></ul><h3 id="四、前台展示"><a href="#四、前台展示" class="headerlink" title="四、前台展示"></a>四、前台展示</h3><blockquote><p>访问你自己的域名，如我的是 <a href="https://movie.onfree.cn" target="_blank" rel="noopener">https://movie.onfree.cn</a></p></blockquote><blockquote><p>这样就成功了，是不是很激动和开心呢哈哈</p></blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/yinshidajian15.png" alt=""></p><blockquote><p>自己继续换个主题模板就更好看了</p></blockquote><blockquote><p>海洋CMS开源免费，建议官网下载最新版，避免第三方有后门和广告</p></blockquote><blockquote><p>再也不用四处找资源了，自己做个影视站给自己开心的看电影吧！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 影视 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟详析Spring MVC</title>
      <link href="/posts/65754b0a.html"/>
      <url>/posts/65754b0a.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟详析Spring-MVC"><a href="#11分钟详析Spring-MVC" class="headerlink" title="11分钟详析Spring MVC"></a>11分钟详析Spring MVC</h2><blockquote><p><code>我手中的魔法，是守护挚爱的力量，是坚定这个信念所必须的力量，我一定会拯救你的，无论在何时、何地。</code></p></blockquote><hr><p>Spring MVC是当前最优秀的MVC框架，支持注解配置，易用性有了大幅度的提高，使用简单，学习成本低，灵活性高，易拓展。</p><h3 id="1-工作流程"><a href="#1-工作流程" class="headerlink" title="1. 工作流程"></a>1. 工作流程</h3><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/Springmvc1.png" alt="image"></p><pre><code>    &lt;!-- 配置处理器 Handle，映射 “/controller1”请求 --&gt;    &lt;bean name=&quot;/controller1&quot; class=&quot;com.controller.Controller1&quot; /&gt;    &lt;!-- 已下默认不用写 在Spring 4.0 会自动使用默认的来处理 --&gt;    &lt;!-- 处理器映射器  将处理器的name作为URL请求进行查找--&gt;    &lt;bean class=&quot;org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping&quot;/&gt;        &lt;!-- 处理器适配器 配置对处理器中handleRequest（）方法的调用 --&gt;    &lt;bean class=&quot;org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter&quot;/&gt;    &lt;!--视图解析器  --&gt;    &lt;bean class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;/&gt;</code></pre><h3 id="2-DispatcherServlet"><a href="#2-DispatcherServlet" class="headerlink" title="2. DispatcherServlet"></a>2. DispatcherServlet</h3><pre><code>    &lt;!-- 配置Springmvc --&gt;    &lt;servlet&gt;        &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;        &lt;init-param&gt;            &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;            &lt;param-value&gt;classpath:spring-mvc.xml&lt;/param-value&gt;        &lt;/init-param&gt;        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;    &lt;/servlet&gt;    &lt;servlet-mapping&gt;        &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;        &lt;url-pattern&gt;/&lt;/url-pattern&gt;    &lt;/servlet-mapping&gt;</code></pre><blockquote><p>// <load-on-startup> 1为启动程序立即加载该<servlet> </p></blockquote><blockquote><p>//  <url-pattern> /  为拦截所有URL交给DispatcherServlet处理</p></blockquote><h3 id="3-Controller-层"><a href="#3-Controller-层" class="headerlink" title="3.Controller 层"></a>3.Controller 层</h3><h4 id="3-1实现接口-org-springframework-web-servlet-mvc-Controller"><a href="#3-1实现接口-org-springframework-web-servlet-mvc-Controller" class="headerlink" title="3.1实现接口 org.springframework.web.servlet.mvc.Controller"></a>3.1实现接口 org.springframework.web.servlet.mvc.Controller</h4><pre><code>public class Controller1 implements Controller {    public ModelAndView handleRequest(HttpServletRequest arg0, HttpServletResponse arg1) throws Exception {        ModelAndView modelAndView =new ModelAndView();        modelAndView.addObject(&quot;msg&quot;, &quot;hello world&quot;);        modelAndView.setViewName(&quot;WEB-INF/jsp/index1.jsp&quot;);        return modelAndView;    }    &lt;!-- 配置处理器 Handle，映射 “/controller1”请求 --&gt;    &lt;bean name=&quot;/controller1&quot; class=&quot;com.controller.Controller1&quot; /&gt;</code></pre><h4 id="3-2-使用注解-Controller-RequestMapping"><a href="#3-2-使用注解-Controller-RequestMapping" class="headerlink" title="3.2 使用注解 @Controller   @RequestMapping"></a>3.2 使用注解 @Controller   @RequestMapping</h4><pre><code>@Controller@RequestMapping(value=&quot;/hello&quot;)  //标注在类上时所有请求前必须有定义的名称下&quot;/hellopublic class Controller1{    //跳转登录界面    @RequestMapping(value=&quot;/login&quot;,method=RequestMethod.GET)  //使用 /login 即可调用    public String toLogin(){        return &quot;login&quot;;    }    //获取登录视图传递来的信息进行配对 成功后视图跳转    @RequestMapping(value=&quot;/login&quot;,method=RequestMethod.POST)    public String login(User user,Model model,HttpSession session) {        System.out.println(&quot;当前用户： &quot;+user);        String name=user.getName();        String password=user.getPassword();        if(name.equals(&quot;jz&quot;)&amp;&amp;password.equals(&quot;123&quot;)) {            session.setAttribute(&quot;session_user&quot;, user);            //redirect 重定向的意思时跳转到相应的方法而不是跳到jsp视图            return &quot;redirect:main&quot;;          }else if(name.equals(&quot;aa&quot;)&amp;&amp;password.equals(&quot;123&quot;)) {            session.setAttribute(&quot;session_user&quot;, user);            return &quot;redirect:upload&quot;;        }        model.addAttribute(&quot;msg&quot;, &quot;用户名或密码错误&quot;);        return &quot;login&quot;;    }</code></pre><blockquote><p>//组合注解:   GetMapping  PostMapping  PutMapping  DeleteMapping  PatchMapping</p></blockquote><h3 id="4-视图解析器"><a href="#4-视图解析器" class="headerlink" title="4. 视图解析器"></a>4. 视图解析器</h3><pre><code>   &lt;!-- 定义视图 --&gt;    &lt;bean id=&quot;viewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/jsp/&quot;&gt;&lt;/property&gt;        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;&gt;&lt;/property&gt;    &lt;/bean&gt;</code></pre><h3 id="5-数据绑定"><a href="#5-数据绑定" class="headerlink" title="5.数据绑定"></a>5.数据绑定</h3><h4 id="5-1绑定默认数据类型"><a href="#5-1绑定默认数据类型" class="headerlink" title="5.1绑定默认数据类型"></a>5.1绑定默认数据类型</h4><ul><li>HttpServletRequest</li><li>HttpServletResponse</li><li>HttpSession</li><li>Model/ModelMap  <blockquote><p>//model是接口  ModelMap是接口实现 作用是将数据填充到Request</p></blockquote></li></ul><h4 id="5-2绑定简单数据类型"><a href="#5-2绑定简单数据类型" class="headerlink" title="5.2绑定简单数据类型"></a>5.2绑定简单数据类型</h4><pre><code>String 、Interget、double..//视图传递来的name属性要和控制器方法的形参相同//不同要使用注解 @RequestParam(value=&quot;name&quot;) String name 定义</code></pre><h4 id="5-3绑定POJO类型"><a href="#5-3绑定POJO类型" class="headerlink" title="5.3绑定POJO类型"></a>5.3绑定POJO类型</h4><blockquote></blockquote><pre><code>public String login(User user) {}</code></pre><blockquote></blockquote><pre><code>&lt;form action=&quot;${pageContext.request.contextPath}/hello/login &quot; method=&quot;post&quot; onsubmit=&quot;return check() &quot;&gt;              账号： &lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;name&quot;&gt;&lt;br/&gt;            密码： &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot;&gt;&lt;br/&gt;            &lt;input type=&quot;submit&quot; value=&quot;登录&quot;&gt;            &lt;input type=&quot;reset&quot; value=&quot;重置&quot;&gt;    &lt;/form&gt;</code></pre><blockquote><p>//解决请求参数中中文乱码问题</p></blockquote><pre><code>    &lt;!-- 字符过滤为UTF-8 --&gt;&lt;filter&gt;    &lt;filter-name&gt;Encoding&lt;/filter-name&gt;    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;    &lt;init-param&gt;        &lt;param-name&gt;encoding&lt;/param-name&gt;        &lt;param-value&gt;UTF-8&lt;/param-value&gt;    &lt;/init-param&gt;&lt;/filter&gt;&lt;filter-mapping&gt;    &lt;filter-name&gt;Encoding&lt;/filter-name&gt;    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;&lt;/filter-mapping&gt;</code></pre><h4 id="5-4绑定包装POJO类型"><a href="#5-4绑定包装POJO类型" class="headerlink" title="5.4绑定包装POJO类型"></a>5.4绑定包装POJO类型</h4><pre><code>public class Order {    private Integer id;    private User user;}    //获取order.jsp界面传递来的参数    @RequestMapping(&quot;/order&quot;)    public String order(Order order) {        System.out.println(order);        return &quot;index2&quot;;    }    &lt;form action=&quot;${pageContext.request.contextPath}/hello/order &quot; method=&quot;post&quot;&gt;         订单号： &lt;input type=&quot;text&quot; name=&quot;order.id&quot;&gt;&lt;br/&gt;        用户名： &lt;input type=&quot;text&quot; name=&quot;user.name&quot;&gt;&lt;br/&gt;        &lt;input type=&quot;submit&quot; value=&quot;继续&quot;&gt;        &lt;input type=&quot;reset&quot; value=&quot;重置&quot;&gt;    &lt;/form&gt;</code></pre><blockquote><p>//两种规范：</p></blockquote><blockquote><p>1.查询条件参数是包装类的直接基本属性 则参数名直接用对应的属性名</p></blockquote><blockquote><p>2.查询条件参数是包装类的POJO的子属性  则参数名必须为 【对象.属性】对象为包装类里POJO的对象名</p></blockquote><h4 id="5-5自定义绑定数据"><a href="#5-5自定义绑定数据" class="headerlink" title="5.5自定义绑定数据"></a>5.5自定义绑定数据</h4><h5 id="5-5-1-Converter转换器-源格式可以为任何格式"><a href="#5-5-1-Converter转换器-源格式可以为任何格式" class="headerlink" title="5.5.1 Converter转换器  //源格式可以为任何格式"></a>5.5.1 Converter转换器  //源格式可以为任何格式</h5><blockquote><p>public interface Converter&lt;S, T&gt;{<br>T convert(S source)<br>}    //S 为源格式 T为目标格式</p></blockquote><pre><code>public class DateConverter implements Converter&lt;String, Date&gt; {    public Date convert(String source) {        String datePattern=&quot;yyyy-MM-dd HH:MM:SS&quot;;        SimpleDateFormat simpleDateFormat=new SimpleDateFormat(datePattern);        try {            return simpleDateFormat.parse(source);        } catch (ParseException e) {            throw new IllegalArgumentException(&quot;无效格式，请使用这种格式&quot;+datePattern);        }    }}xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;xsi:schemaLocation=&quot;http://www.springframework.org/schema/mvc                              http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;    &lt;!-- 显示装配的自定义的转换器 --&gt;  &lt;mvc:annotation-driven conversion-service=&quot;conversionservice1&quot;&gt;&lt;/mvc:annotation-driven&gt;     &lt;!-- 自定义类型转换器配置 converters--&gt;  &lt;bean id=&quot;conversionservice1&quot; class=&quot;org.springframework.context.support.ConversionServiceFactoryBean&quot;&gt;        &lt;property name=&quot;converters&quot;&gt;            &lt;set&gt;                &lt;bean class=&quot;com.converter.DateConverter&quot;&gt;&lt;/bean&gt;            &lt;/set&gt;        &lt;/property&gt;    &lt;/bean&gt;</code></pre><blockquote></blockquote><pre><code>    //通过自定义绑定数据Converter或DateFormat 获取Date    @RequestMapping(&quot;customDate&quot;)    public String customDate(Date date) {        System.out.println(date);        return &quot;index2&quot;;    }</code></pre><h5 id="5-5-2-Formatter格式化-源格式只能为String"><a href="#5-5-2-Formatter格式化-源格式只能为String" class="headerlink" title="5.5.2 Formatter格式化  //源格式只能为String"></a>5.5.2 Formatter格式化  //源格式只能为String</h5><blockquote><p>public interface Formatter<T> extends Printer<T>,Parser<T>{}</p></blockquote><pre><code>public class DateFormatter implements Formatter&lt;Date&gt; {    private String datePattern=&quot;yyyy-MM-dd HH:MM:SS&quot;;    private SimpleDateFormat simpleDateFormat;    //返回目标对象的字符串    public String print(Date date, Locale locale) {        return new SimpleDateFormat().format(date);    }    //利用指定的local将一个String类型解析成目类型    public Date parse(String source, Locale locale) throws ParseException {        simpleDateFormat=new SimpleDateFormat(datePattern);        return simpleDateFormat.parse(source);    }}</code></pre><blockquote></blockquote><pre><code>xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;xsi:schemaLocation=&quot;http://www.springframework.org/schema/mvc                              http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;    &lt;!-- 显示装配的自定义的转换器 --&gt;  &lt;mvc:annotation-driven conversion-service=&quot;conversionservice1&quot;&gt;&lt;/mvc:annotation-driven&gt;     &lt;!-- 自定义类型转换器配置formatters--&gt;    &lt;bean id=&quot;conversionservice2&quot; class=&quot;org.springframework.format.support.FormattingConversionServiceFactoryBean&quot;&gt;        &lt;property name=&quot;formatters&quot;&gt;            &lt;set&gt;                &lt;bean class=&quot;com.converter.DateFormatter&quot;&gt;&lt;/bean&gt;            &lt;/set&gt;        &lt;/property&gt;    &lt;/bean&gt;</code></pre><h4 id="5-6绑定数组"><a href="#5-6绑定数组" class="headerlink" title="5.6绑定数组"></a>5.6绑定数组</h4><pre><code>    //获取绑定要执行删除的数组     @RequestMapping(&quot;/delID&quot;)    public String delID(Integer[] ids) {        if(ids!=null) {            for (Integer id : ids) {                System.out.println(&quot;你删除了第 &quot;+id+&quot;数据&quot;);            }        }else{            System.out.println(&quot;ids为null&quot;);        }        return &quot;editUser&quot;;    }    &lt;form action=&quot;${pageContext.request.contextPath}/hello/delID&quot; method=&quot;post&quot;&gt;        &lt;table border=1 width=&quot;20%&quot;&gt;            &lt;thead&gt;删除用户&lt;/thead&gt;            &lt;tbody&gt;                &lt;tr&gt;                    &lt;td&gt;选择&lt;/td&gt;                    &lt;td&gt;用户名&lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt; &lt;input type=&quot;checkbox&quot; name=&quot;ids&quot; value=&quot;1&quot;&gt;&lt;/input&gt; &lt;/td&gt;                    &lt;td&gt;aa&lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt; &lt;input type=&quot;checkbox&quot; name=&quot;ids&quot; value=&quot;2&quot;&gt;&lt;/input&gt; &lt;/td&gt;                    &lt;td&gt;bb&lt;/td&gt;                &lt;/tr&gt;            &lt;/tbody&gt;        &lt;/table&gt;        &lt;br/&gt;&lt;input type=&quot;submit&quot; value=&quot;确定&quot;&gt;    &lt;/form&gt;</code></pre><h4 id="5-6绑定集合"><a href="#5-6绑定集合" class="headerlink" title="5.6绑定集合"></a>5.6绑定集合</h4><blockquote><p>//后台不允许使用集合作为形参 只能用包装类来包装一个集合</p></blockquote><blockquote><p>public class UserList {<br>    private List<User> userList;<br>}</p></blockquote><pre><code>    //获取绑定要执行修改数据的集合    @RequestMapping(&quot;/editUser&quot;)    public String editUser(UserList userList1) {        List&lt;User&gt; users=userList1.getUserList();        for (User user : users) {            if(user.getId()!=null) {                System.out.println(&quot;修改了第 &quot;+user.getId()+&quot;数据&quot;);                System.out.println(&quot;用户名为：&quot;+user.getName());            }        }        return &quot;index2&quot;;    }&lt;form action=&quot;${pageContext.request.contextPath}/hello/editUser&quot; method=&quot;post&quot;&gt;        &lt;table border=1&gt;            &lt;thead&gt;修改用户&lt;/thead&gt;            &lt;tr&gt;                &lt;td&gt;选择&lt;/td&gt;                &lt;td&gt;用户名&lt;/td&gt;            &lt;/tr&gt;            &lt;tr&gt;                &lt;td&gt; &lt;input type=&quot;checkbox&quot; name=&quot;userList[0].id&quot; value=&quot;1&quot;&gt;&lt;/input&gt; &lt;/td&gt;                &lt;td&gt; &lt;input type=&quot;text&quot; name=&quot;userList[0].name&quot; value=&quot;jz&quot;&gt;&lt;/input&gt;&lt;/td&gt;            &lt;/tr&gt;            &lt;tr&gt;                &lt;td&gt; &lt;input type=&quot;checkbox&quot; name=&quot;userList[1].id&quot; value=&quot;2&quot;&gt;&lt;/input&gt; &lt;/td&gt;                &lt;td&gt; &lt;input type=&quot;text&quot; name=&quot;userList[1].name&quot; value=&quot;aa&quot;&gt;&lt;/input&gt;&lt;/td&gt;            &lt;/tr&gt;        &lt;/table&gt;        &lt;br/&gt;&lt;input type=&quot;submit&quot; value=&quot;确定&quot;&gt;    &lt;/form&gt;</code></pre><h3 id="6-JSON-和RESTful"><a href="#6-JSON-和RESTful" class="headerlink" title="6.JSON 和RESTful"></a>6.JSON 和RESTful</h3><h4 id="6-1-JSON-格式"><a href="#6-1-JSON-格式" class="headerlink" title="6.1 JSON 格式"></a>6.1 JSON 格式</h4><blockquote><p>对象结构：</p></blockquote><pre><code>{key1:value1,key2:value2}</code></pre><blockquote><p>数组结构：</p></blockquote><pre><code>[value1,value2]</code></pre><h4 id="6-2JSON数据交换"><a href="#6-2JSON数据交换" class="headerlink" title="6.2JSON数据交换"></a>6.2JSON数据交换</h4><blockquote><p>包类：</p></blockquote><blockquote><p>jackson-annotations-2.9.9.jar</p></blockquote><blockquote><p>jackson-core-2.9.9.jar</p></blockquote><blockquote><p>databind-2.9.9.jar</p></blockquote><blockquote><p>注解：</p></blockquote><blockquote><p>@RequestBody  //将请求体的数据绑定在形参上  作用在形参<br>@ResponseBody  //返回JSON格式  作用在方法上</p></blockquote><pre><code>    &lt;!-- 配置注解驱动 自动注册 org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping        和org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter --&gt;    &lt;mvc:annotation-driven /&gt;    &lt;!--第1种. 配置静态资源的访问映射 使其不被前端控制器拦截 --&gt;    &lt;mvc:resources location=&quot;/js/&quot; mapping=&quot;/js/**&quot; /&gt;    &lt;!-- 第2种.使用使用默认的服务器请求处理器自动判断筛选 --&gt;    &lt;!-- &lt;mvc:default-servlet-handler/&gt; --&gt;</code></pre><p>​    </p><blockquote></blockquote><pre><code>//测试JSON @RequestMapping(value=&quot;/login2&quot;,method=RequestMethod.POST)@ResponseBody  //返回JSON格式public User login2(@RequestBody User user) {    System.out.println(&quot;login2 测试&quot;);    System.out.println(user);    return user;}</code></pre><blockquote></blockquote><pre><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;    pageEncoding=&quot;UTF-8&quot;%&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;title&gt;Insert title here&lt;/title&gt;    &lt;script type=&quot;text/javascript&quot; src=&quot;${pageContext.request.contextPath}/js/jquery-3.3.1.min.js&quot;&gt;&lt;/script&gt;    &lt;script type=&quot;text/javascript&quot;&gt;        function check() {            var name=$(&quot;#name&quot;).val();            var password=$(&quot;#password&quot;).val();            if(name==null||password==null||name==&quot;&quot;||password==&quot;&quot;){                alert(&quot;账号或密码不能为空！！&quot;);                return false;            }            return true;        }//使用JQuery的AJAX传递JSON格式        function login2(){            //alert(&quot;1&quot;);            var name=$(&quot;#name&quot;).val();            var password=$(&quot;#password&quot;).val();            var id=1;                if(check()){                $.ajax({//url前往路径                    url:&quot;${pageContext.request.contextPath}/hello/login2&quot;,                     type:&quot;post&quot;,//data请求发送的数据                    data:JSON.stringify({id:id,name:name,password:password}),//json格式时 必须为application/json                    contentType:&quot;application/json;charset=UTF-8&quot;,//定义回调属性为json                    dataType:&quot;json&quot;,                    success:function(data){                        alert(data.name+data.password);                    }                    });            }            }    &lt;/script&gt;&lt;/head&gt;&lt;body&gt;    &lt;!-- ${pageContext.request.contextPath}&lt;br/&gt;--&gt;    &lt;div style=&quot;color: red&quot;&gt;${msg}&lt;/div&gt;    &lt;form action=&quot;${pageContext.request.contextPath}/hello/login &quot; method=&quot;post&quot; onsubmit=&quot;return check()&quot;&gt;         账号： &lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;name&quot;&gt;&lt;br/&gt;        密码： &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot;&gt;&lt;br/&gt;        &lt;input type=&quot;submit&quot; value=&quot;登录&quot;&gt;        &lt;input type=&quot;reset&quot; value=&quot;重置&quot;&gt;        &lt;input type=&quot;button&quot; value=&quot;登录2&quot; onclick=&quot;login2()&quot; /&gt;    &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><h4 id="6-3RESTful风格"><a href="#6-3RESTful风格" class="headerlink" title="6.3RESTful风格"></a>6.3RESTful风格</h4><blockquote><p>如：<a href="http://hello/items/1" target="_blank" rel="noopener">http://hello/items/1</a><br>//参数写在连接之后</p></blockquote><pre><code>    //用RESTful风格测试JSON    @RequestMapping(value=&quot;/user/{id}&quot;,method=RequestMethod.GET)    @ResponseBody    public User selectUser(@PathVariable(&quot;id&quot;) Integer id) {        User user1=new User();        //模拟在数据库找到此ID数据        if(id.equals(1)) {            user1.setName(&quot;jzz&quot;);            user1.setId(id);            System.out.println(&quot;ID: &quot;+user1.getId()+&quot; 用户名： &quot;+user1.getName());        }else {            System.out.println(&quot;没有找到此ID的用户&quot;);        }        return user1;    }</code></pre><blockquote></blockquote><pre><code>&lt;script type=&quot;text/javascript&quot; src=&quot;${pageContext.request.contextPath}/js/jquery-3.3.1.min.js&quot;&gt;&lt;/script&gt;    &lt;script type=&quot;text/javascript&quot;&gt;        function select1(){            //alert(&quot;1&quot;);            var id=$(&quot;#number&quot;).val();            $.ajax({                url:&quot;${pageContext.request.contextPath}/hello/user/&quot;+id,                type:&quot;GET&quot;,                dataType:&quot;json&quot;,                success:function(data){                    if(data.id!=null&amp;&amp;data.name!=null){                        alert(&quot;id: &quot;+data.id+&quot;用户名： &quot;+data.name);                    }else{                        alert(&quot;没有找到此ID的用户&quot;);                    }                }            })         }    &lt;/script&gt;</code></pre><h3 id="7-拦截器interceptor"><a href="#7-拦截器interceptor" class="headerlink" title="7.拦截器interceptor"></a>7.拦截器interceptor</h3><ul><li><p>// 拦截器需实现接口 HandlerInterceptor 或它的实现类 HandlerInterceptorAdapter</p></li><li><p>//或者 实现接口WebRequestInterceptor或实现类WebRequestHandlerInterceptorAdapter</p><pre><code>  public class LoginInterceptor extends HandlerInterceptorAdapter {          //此方法在控制器方法前执行  返回true时继续执行  fasle时中断控制器方法及拦截器方法      public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object object) throws Exception {          //判断是否登录 /login 连接          String url=request.getRequestURI();          System.out.println(&quot;当前连接：&quot;+url);          if(url.indexOf(&quot;/login&quot;)&gt;=0) {              return true;          }          if(url.indexOf(&quot;/login2&quot;)&gt;=0) {              return true;          }          //判断session是否有数据User用户          HttpSession session=request.getSession();          User user =(User) session.getAttribute(&quot;session_user&quot;);          if(user!=null) {              return true;          }      //不符合条件重新转发到登录界面      request.setAttribute(&quot;msg&quot;, &quot;你还没有登录，请登录！&quot;);      request.getRequestDispatcher(&quot;/WEB-INF/jsp/login.jsp&quot;).forward(request, response);      return false;  }  //此方法在控制器调用之后 视图解析前执行  以便对模型和视图进行修改  public void postHandle(HttpServletRequest request, HttpServletResponse response, Object object, ModelAndView modelAndView)          throws Exception {      // TODO Auto-generated method stub  }  //此方法在视图解析之后进行  可进行资源清理、日子记录等等      public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object object, Exception arg3)              throws Exception {          // TODO Auto-generated method stub      }  }      &lt;!-- 配置拦截器 --&gt;      &lt;mvc:interceptors&gt;          &lt;!-- 全局拦截器 --&gt;          &lt;!--&lt;bean class=&quot;&quot; /&gt;  --&gt;          &lt;mvc:interceptor&gt;              &lt;mvc:mapping path=&quot;/**&quot;/&gt; &lt;!-- 配置拦截器作用的路径 --&gt;              &lt;mvc:exclude-mapping path=&quot;&quot;/&gt; &lt;!-- 配置拦截器不作用的路径 --&gt;              &lt;bean class=&quot;com.interceptor.LoginInterceptor&quot;&gt;&lt;/bean&gt;          &lt;/mvc:interceptor&gt;      &lt;/mvc:interceptors&gt;</code></pre></li></ul><blockquote><p>/* 假设配置多个拦截器interceptor1   interceptor2<br>则其拦截器的方法的调用的顺序是：<br>interceptor1(preHandle) - interceptor2(preHandle) - handleAdapter(Handle) -interceptor2(postHandle) - interceptor1(postHandle) - DispatcherServlet(reader) - interceptor2(afterCompletion) -  interceptor1(afterCompletion)  */</p></blockquote><h3 id="7-文件上传"><a href="#7-文件上传" class="headerlink" title="7.文件上传"></a>7.文件上传</h3><blockquote><p>类包：</p></blockquote><ul><li><p>commons-fileupload-1.4.jar </p></li><li><p>commons-io-2.6.jar</p><pre><code>  &lt;!-- 配置文件上传解析器 multipartResolver --&gt;      &lt;!-- 因为CommonsMultipartResolver内部是引用MultipartResolver字符串来完成文件解析 所以指定的ID必须为multipartResolver  --&gt;  &lt;bean id=&quot;multipartResolver&quot; class=&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;&gt;      &lt;!-- 配置缓存中最大阈值 低于此值，只保留在内存里，超过此阈值，生成硬盘上的临时文件 --&gt;      &lt;property name=&quot;maxInMemorySize&quot; value=&quot;&quot; /&gt;       &lt;!-- 推迟文件解析 --&gt;      &lt;property name=&quot;resolveLazily&quot; value=&quot;&quot;/&gt;      &lt;!-- 允许文件上传的最大尺寸 --&gt;      &lt;property name=&quot;maxUploadSize&quot; value=&quot;10485760&quot; /&gt;      &lt;!-- 默认编码格式 --&gt;      &lt;property name=&quot;defaultEncoding&quot; value=&quot;UTF-8&quot; /&gt;  &lt;/bean&gt;</code></pre></li></ul><blockquote></blockquote><pre><code>&lt;!--  enctype属性必须为&quot;multipart/form-data&quot;   multiple=&quot;multiple&quot; 表示可以多文件上传 --&gt;    &lt;form id=&quot;form1&quot; action=&quot;${pageContext.request.contextPath}/hello/upload&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot; onsubmit=&quot;return check()&quot; &gt;        上传人： &lt;input type=&quot;text&quot; id=&quot;name1&quot; name=&quot;name1&quot; /&gt; &lt;br/&gt;            &lt;input type=&quot;file&quot; multiple=&quot;multiple&quot;  name=&quot;ufile&quot; id=&quot;ufile&quot; /&gt;        &lt;input type=&quot;submit&quot; value=&quot;上传&quot; /&gt;    &lt;/form&gt;</code></pre><blockquote></blockquote><pre><code>//上传文件处理    @RequestMapping(value=&quot;/upload&quot; ,method=RequestMethod.POST)    public String upload(@RequestParam(value=&quot;name1&quot;) String name1,@RequestParam(value=&quot;ufile&quot;) List&lt;MultipartFile&gt; ufile,HttpServletRequest request,HttpSession session) {        //System.out.println(&quot;1成功&quot;);        User user=(User) session.getAttribute(&quot;session_user&quot;);        //System.out.println(user);        //判断上传文件是否存在        if(!ufile.isEmpty()&amp;&amp;ufile.size()&gt;0) {            for (MultipartFile multipartFile : ufile) {                //获取上传文件的源名字                String sfilename=multipartFile.getOriginalFilename();                //上传文件的最后的保存路径                String dirPath=request.getServletContext().getRealPath(&quot;/upload&quot;)+&quot;/&quot;+user.getName();                System.out.println(&quot;dirPath :&quot;+dirPath);                //假设目录不存在 就创建目录                File pathfile=new File(dirPath);                if(!pathfile.exists()) {                    pathfile.mkdirs();                }                //上传文件的最后的文件名 上传人_UUID_源文件名                String lfilename=name1+&quot;_&quot;+UUID.randomUUID()+&quot; &quot;+sfilename;                try {                    multipartFile.transferTo(new File(dirPath,lfilename));                } catch (IllegalStateException | IOException e) {                    // TODO Auto-generated catch block                    e.printStackTrace();                    System.out.println(&quot;错误&quot;+e);                }            }            return &quot;index2&quot;;        }else {            System.out.println(&quot;错误2&quot;);            return null;        }    }</code></pre><blockquote><p>// MultipartFile 接口常用方法</p></blockquote><ul><li>byte[] getBytes() 返回文件的内容作为一个字节数组</li><li>String getContentType() 返回文件的内容类型</li><li>InputStream getInputStream() 返回InputStream读取文件的内容</li><li>String getName() 返回参数的名称多部分的形式</li><li>String getOriginalFilename() 返回原来的文件名</li><li>long getSize() 返回文件的大小,以字节为单位</li><li>boolean isEmpty() 返回是否上传文件是空</li><li>void transferTo(File dest) 接收到的文件转移到给定的目标文件。</li></ul><h3 id="8-文件下载"><a href="#8-文件下载" class="headerlink" title="8.文件下载"></a>8.文件下载</h3><blockquote><p>// 使用 ResponseEntity&lt;byte[]&gt; 对象设置 HttpHeaders 和 HttpStatus 配置信息下载</p></blockquote><pre><code>&lt;%@ page import=&quot;java.net.URLEncoder&quot;%&gt;...&lt;a href=&quot;${pageContext.request.contextPath}/hello/download?filename=&lt;%=URLEncoder.encode(&quot;看.jpg&quot;,&quot;UTF-8&quot;)%&gt;&quot;&gt;下载&lt;/a&gt;//下载文件处理    @RequestMapping(value=&quot;/download&quot;)    public ResponseEntity&lt;byte[]&gt; download(@RequestParam(&quot;filename&quot;) String filename,HttpSession session,HttpServletRequest request) throws IOException{        System.out.println(&quot;download 开始！&quot;);        //System.out.println(filename);        User user =(User) session.getAttribute(&quot;session_user&quot;);        //下载文件路径    //String pathname=request.getServletContext().getRealPath(&quot;/upload&quot;)+&quot;/&quot;+user.getName();    //File pathfile=new File(pathname+File.separator+filename);        File pathfile=new File(&quot;C:\\Users\\jz\\Pictures\\Camera Roll\\&quot;+filename);        System.out.println(pathfile);        if(!pathfile.exists()) {            System.out.println(&quot;文件为空&quot;);        }        //设置头信息        HttpHeaders headers = new HttpHeaders();         //中文文件名处理        String filename1=new String(filename.getBytes(&quot;utf-8&quot;),&quot;ISO-8859-1&quot;);         //设置请求头内容,告诉浏览器以下载方式打开窗口        headers.setContentDispositionFormData(&quot;attachment&quot;, filename1);        //定义以流的形式返回下载数据        headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);        return new ResponseEntity&lt;byte[]&gt;(FileUtils.readFileToByteArray(pathfile),                                                  headers, HttpStatus.OK);      }</code></pre>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Spring MVC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟学习JavaWeb中Listener和Filter</title>
      <link href="/posts/68f34ac0.html"/>
      <url>/posts/68f34ac0.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟学习JavaWeb中Listener和Filter"><a href="#11分钟学习JavaWeb中Listener和Filter" class="headerlink" title="11分钟学习JavaWeb中Listener和Filter"></a>11分钟学习JavaWeb中Listener和Filter</h2><blockquote><p><code>别迷惘，别烦恼，加速吧，只要行动就好，别停下，迷惘什么的一点都不像你，像那样纵身轻跃，拾级而上，就像那一天一样，让我再次追逐你的身影，我的英雄</code></p></blockquote><hr><h3 id="一、Listener"><a href="#一、Listener" class="headerlink" title="一、Listener"></a>一、Listener</h3><blockquote><p>监听器</p></blockquote><ul><li>能做什么事？</li></ul><blockquote><p>监听某一个事件的发生和状态的改变。</p></blockquote><ul><li>监听器的内部机制</li></ul><blockquote><p>其实就是接口回调. </p></blockquote><h4 id="Web监听器"><a href="#Web监听器" class="headerlink" title="Web监听器"></a>Web监听器</h4><blockquote><p>总共有8个 划分成三种类型</p></blockquote><ol><li><p>定义一个类，实现接口</p></li><li><p>注册 | 配置监听器</p></li></ol><h4 id="监听三个作用域创建和销毁"><a href="#监听三个作用域创建和销毁" class="headerlink" title="监听三个作用域创建和销毁"></a>监听三个作用域创建和销毁</h4><pre><code>     request  ---httpServletRequest    session  ---httpSession    aapplication  --- ServletContext1. ServletContextListener    servletcontext创建：        1. 启动服务器的时候    servletContext销毁：        2. 关闭服务器. 从服务器移除项目2. ServletRequestListener    request创建:        访问服务器上的任意资源都会有请求出现。        访问 html： 会        访问 jsp:    会        访问 servlet : 会     request销毁：        服务器已经对这次请求作出了响应。        public class MyRequestListener implements ServletRequestListener {                @Override                public void requestDestroyed(ServletRequestEvent sre) {                    System.out.println(&quot;servletrequest 销毁了&quot;);                }                @Override                public void requestInitialized(ServletRequestEvent sre) {                    System.out.println(&quot;servletrequest 初始化了&quot;);                }            }          &lt;listener&gt;              &lt;listener-class&gt;com.itheima.listener.MyRequestListener&lt;/listener-class&gt;          &lt;/listener&gt;    3. HttpSessionListener    session的创建        只要调用getSession        html:        不会        jsp:        会      getSession();        servlet:     会    session的销毁        超时  30分钟        非正常关闭 销毁        正常关闭服务器(序列化)        public class MySessionListener implements HttpSessionListener {            @Override            public void sessionCreated(HttpSessionEvent se) {                System.out.println(&quot;创建session了&quot;);            }            @Override            public void sessionDestroyed(HttpSessionEvent se) {                System.out.println(&quot;销毁session了&quot;);            }        }</code></pre><p><strong>作用：</strong>    </p><pre><code>ServletContextListener    利用它来，在servletcontext创建的时候，         1. 完成自己想要的初始化工作        2. 执行自定义任务调度。 执行某一个任务。 Timer  HttpSessionListener    统计在线人数.</code></pre><h4 id="监听三个作用域属性状态变更"><a href="#监听三个作用域属性状态变更" class="headerlink" title="监听三个作用域属性状态变更"></a>监听三个作用域属性状态变更</h4><blockquote><p>可以监听在作用域中值 添加  | 替换  | 移除的动作。 </p></blockquote><ul><li><p>servletContext — ServletContextAttributeListener<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/ServletContextAttributeListener.png" alt=""></p></li><li><p>request — ServletRequestAttributeListener<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/ServletRequestAttributeListener%20.png" alt="image"></p></li><li><p>session — HttpSessionAttributeListener<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/HttpSessionAttributeListener.png" alt="image"></p></li></ul><h4 id="监听httpSession里面存值的状态变更"><a href="#监听httpSession里面存值的状态变更" class="headerlink" title="监听httpSession里面存值的状态变更"></a>监听httpSession里面存值的状态变更</h4><blockquote><p>这一类监听器不用注册。</p></blockquote><ul><li>HttpSessionBindingListener</li></ul><blockquote><p>监听对象与session 绑定和解除绑定 的动作</p></blockquote><pre><code>1. 让javaBean 实现该接口即可        @Override        public void valueBound(HttpSessionBindingEvent event) {            System.out.println(&quot;对象被绑定进来了&quot;);        }        @Override        public void valueUnbound(HttpSessionBindingEvent event) {            System.out.println(&quot;对象被解除绑定&quot;);        }</code></pre><ul><li>HttpSessionActivationListener</li></ul><blockquote><p>用于监听现在session的值 是 钝化 （序列化）还是活化 （反序列化）的动作</p></blockquote><ul><li>钝化 （序列化） </li></ul><blockquote><p>把内存中的数据 存储到硬盘上</p></blockquote><ul><li>活化 （反序列化）</li></ul><blockquote><p>把硬盘中的数据读取到内存中。</p></blockquote><ul><li>session的钝化活化的用意何在</li></ul><blockquote><p> session中的值可能会很多， 并且我们有很长一段时间不使用这个内存中的值， 那么可以考虑把session的值可以存储到硬盘上【钝化】，等下一次在使用的时候，在从硬盘上提取出来。 【活化】</p></blockquote><ul><li>如何让session的在一定时间内钝化. </li></ul><blockquote><p>做配置即可</p></blockquote><pre><code>1. 在tomcat里面 conf/context.xml 里面配置        对所有的运行在这个服务器的项目生效  2. 在conf/Catalina/localhost/context.xml 配置        对 localhost生效。  localhost:80803. 在自己的web工程项目中的 META-INF/context.xml        只对当前的工程生效。    maxIdleSwap ： 1分钟不用就钝化    directory ：  钝化后的那个文件存放的目录位置。         D:\tomcat\apache-tomcat-7.0.52\work\Catalina\localhost\ListenerDemo\itheima    &lt;Context&gt;        &lt;Manager className=&quot;org.apache.catalina.session.PersistentManager&quot; maxIdleSwap=&quot;1&quot;&gt;            &lt;Store className=&quot;org.apache.catalina.session.FileStore&quot; directory=&quot;itheima&quot;/&gt;        &lt;/Manager&gt;    &lt;/Context&gt;</code></pre><h3 id="二、Filter"><a href="#二、Filter" class="headerlink" title="二、Filter"></a>二、Filter</h3><blockquote><p>过滤器 ， 其实就是对客户端发出来的请求进行过滤。 浏览器发出， 然后服务器派servlet处理。  在中间就可以过滤， 其实过滤器起到的是拦截的作用。</p></blockquote><ul><li><p>作用</p><ol><li><p>对一些敏感词汇进行过滤</p></li><li><p>统一设置编码</p></li><li><p>自动登录</p><p>…</p></li></ol></li></ul><h4 id="如何使用Filter"><a href="#如何使用Filter" class="headerlink" title="如何使用Filter"></a>如何使用Filter</h4><ol><li><p>定义一个类， 实现Filter</p><pre><code> public class FilterDemo implements Filter {     public void destroy() {     }     public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {         System.out.println(&quot;来到过虑器了。。。&quot;);         chain.doFilter(request, response);     }     public void init(FilterConfig fConfig) throws ServletException {     } }</code></pre></li><li><p>注册过滤器</p></li></ol><blockquote><p>在web.xml里面注册，注册的手法与servlet基本一样。</p></blockquote><pre><code>          &lt;filter&gt;        &lt;display-name&gt;FilterDemo&lt;/display-name&gt;        &lt;filter-name&gt;FilterDemo&lt;/filter-name&gt;        &lt;filter-class&gt;com.itheima.filter.FilterDemo&lt;/filter-class&gt;      &lt;/filter&gt;      &lt;filter-mapping&gt;        &lt;filter-name&gt;FilterDemo&lt;/filter-name&gt;        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;      &lt;/filter-mapping&gt;</code></pre><h4 id="Filter的生命周期"><a href="#Filter的生命周期" class="headerlink" title="Filter的生命周期"></a>Filter的生命周期</h4><ul><li>创建</li></ul><blockquote><p>在服务器启动的时候就创建。 </p></blockquote><ul><li>销毁</li></ul><blockquote><p>服务器停止的时候。</p></blockquote><h4 id="Filter执行顺序"><a href="#Filter执行顺序" class="headerlink" title="Filter执行顺序"></a>Filter执行顺序</h4><ol><li><p>客户端发出请求，先经过过滤器， 如果过滤器放行，那么才能到servlet</p></li><li><p>如果有多个过滤器， 那么他们会按照注册的映射顺序 来 排队。 只要有一个过滤器， 不放行，那么后面排队的过滤器以及咱们的servlet都不会收到请求。</p></li></ol><h4 id="Filter细节："><a href="#Filter细节：" class="headerlink" title="Filter细节："></a>Filter细节：</h4><ol><li><p>init方法的参数 FilterConfig , 可以用于获取filter在注册的名字 以及初始化参数。  其实这里的设计的初衷与ServletConfig是一样的。</p></li><li><p>如果想放行，那么在doFilter 方法里面操作，使用参数 chain</p></li></ol><pre><code>    chain.doFilter(request, response); 放行， 让请求到达下一个目标。</code></pre><ol start="3"><li><p><url-pattern>/*</url-pattern> 写法格式与servlet一样。</p><ol><li><p>全路径匹配  以 /  开始 </p><pre><code> /LoginServlet</code></pre></li><li><p>以目录匹配 以 / 开始  以 * 结束</p><p> /demo01/*  </p></li><li><p>以后缀名匹配  以 * 开始 以后缀名结束</p><p> *.jsp  *.html *.do </p></li></ol></li><li><p>针对 dispatcher 设置</p><pre><code> REQUEST ： 只要是请求过来，都拦截，默认就是REQUEST  FORWARD : 只要是转发都拦截。  ERROR ： 页面出错发生跳转  INCLUDE ： 包含页面的时候就拦截。</code></pre></li></ol><h4 id="自动登录"><a href="#自动登录" class="headerlink" title="自动登录"></a>自动登录</h4><h5 id="登录servlet代码"><a href="#登录servlet代码" class="headerlink" title="登录servlet代码"></a>登录servlet代码</h5><pre><code>    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {    try {        String userName = request.getParameter(&quot;username&quot;);        String password = request.getParameter(&quot;password&quot;);        String autoLogin = request.getParameter(&quot;auto_login&quot;);        UserBean user = new UserBean();        user.setUsername(userName);        user.setPassword(password);        UserDao dao = new UserDaoImpl();        UserBean userBean = dao.login(user);        if(userBean != null){            //成功了，进入首页            request.getSession().setAttribute(&quot;userBean&quot;, userBean);            response.sendRedirect(&quot;index.jsp&quot;);        }else{            //不成功...            request.getRequestDispatcher(&quot;login.jsp&quot;).forward(request, response);        }    } catch (SQLException e) {        e.printStackTrace();    }}</code></pre><h5 id="过滤器代码"><a href="#过滤器代码" class="headerlink" title="过滤器代码"></a>过滤器代码</h5><blockquote><p> 过滤器的核心不是完成拦截不给 ， 还是放行显示。 它的核心是在放行之前，帮用户完成登录的功能。 </p></blockquote><ul><li>实现思路</li></ul><ol><li><p>先判断session是否有效， 如果有效，就不用取cookie了，直接放行。</p></li><li><p>如果session失效了，那么就取 cookie。</p><ul><li><p>没有cookie 放行</p></li><li><p>有cookie    </p><p>a.取出来cookie的值，然后完成登录</p><p>b.把这个用户的值存储到session中</p><p>c.放行。</p></li></ul><pre><code>/** * @see Filter#doFilter(ServletRequest, ServletResponse, FilterChain)   */   public void doFilter(ServletRequest req, ServletResponse response, FilterChain chain) throws IOException, ServletException {try {    HttpServletRequest request = (HttpServletRequest) req;//先判断，现在session中还有没有那个userBean.UserBean userBean = (UserBean) request.getSession().getAttribute(&quot;userBean&quot;);//还有，有效。if(userBean != null){    chain.doFilter(request, response);}else{    //代表session失效了。    //2. 看cookie。    //1. 来请求的时候，先从请求里面取出cookie , 但是cookie有很多的key-value    Cookie[] cookies = request.getCookies();    //2. 从一堆的cookie里面找出我们以前给浏览器发的那个cookie    Cookie cookie = CookieUtil.findCookie(cookies, &quot;auto_login&quot;);    //第一次来    if(cookie  == null){        chain.doFilter(request, response);    }else{        //不是第一次。        String value = cookie.getValue();        String username = value.split(&quot;#itheima#&quot;)[0];        String password = value.split(&quot;#itheima#&quot;)[1];        //完成登录        UserBean user = new UserBean();        user.setUsername(username);        user.setPassword(password);        UserDao dao = new UserDaoImpl();        userBean = dao.login(user);        //使用session存这个值到域中，方便下一次未过期前还可以用。        request.getSession().setAttribute(&quot;userBean&quot;, userBean);        chain.doFilter(request, response);    }}} catch (Exception e) {    e.printStackTrace();    chain.doFilter(req, response);}}</code></pre></li></ol><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li><p>Listener</p><p>  三种类型 </p><p>  针对三个作用域的创建和销毁<br>  针对三个作用域的值改变 【添加 | 替换 | 移除】</p></li></ul><blockquote><p>ServletContextListner  ： 应用被部署的时候， 服务器加载这个项目的时候，做一些初始化工作， 任务调度。<br>    HttpSessionListener    ： 统计在线人数<br>    HttpSessionActivationListener  ： 钝化活化处理</p></blockquote><ul><li>Filter </li></ul><blockquote><p>使用频率更高</p></blockquote><ul><li>如果要写一个过滤器。</li></ul><blockquote><ol><li>定义一个类，实现接口 Filter</li></ol></blockquote><blockquote><ol start="2"><li>注册 . web.xml . 与servlet相似。</li></ol></blockquote><ul><li>过滤器放行。 </li></ul><blockquote><p>chain.doFilter(request, response);</p></blockquote><ul><li><p>过滤器生命周期</p><p>  创建： 服务器加载这个项目的时候创建实例</p><p>  销毁： 关闭服务器或者从服务器中移除项目的时候。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> JavaWeb </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaWeb </tag>
            
            <tag> Listener </tag>
            
            <tag> Filter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟浅析Spring AOP</title>
      <link href="/posts/145eface.html"/>
      <url>/posts/145eface.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟浅析Spring-AOP"><a href="#11分钟浅析Spring-AOP" class="headerlink" title="11分钟浅析Spring AOP"></a>11分钟浅析Spring AOP</h2><blockquote><p><code>既然认准这条路，何必去打听要走多久</code></p></blockquote><hr><p>AOP是Spring框架面向切面的编程思想，AOP采用一种称为“横切”的技术，将涉及多业务流程的通用功能抽取并单独封装，形成独立的切面，在合适的时机将这些切面横向切入到业务流程指定的位置中。</p><h3 id="1-AOP名词解释"><a href="#1-AOP名词解释" class="headerlink" title="1.AOP名词解释"></a>1.AOP名词解释</h3><ul><li><p>JoinPoint(连接点):目标对象中,所有可以增强的方法，就是spring允许你是通知（Advice）的地方，那可就真多了，基本每个方法的前、后（两者都有也行），或抛出异常是时都可以是连接点，spring只支持方法连接点。</p></li><li><p>Pointcut(切入点):目标对象中,已经被增强的方法。调用这几个方法之前、之后或者抛出异常时干点什么，那么就用切入点来定义这几个方法。</p></li><li><p>Advice(通知/增强) :增强方法的代码、想要的功能。</p></li><li><p>Target(目标对象):被代理对象，被通知的对象，被增强的类对象。</p></li><li><p>Weaving(织入):将通知应用到连接点形成切入点的过程</p></li><li><p>Proxy(代理):将通知织入到目标对象之后形成的代理对象</p></li><li><p>aspect(切面):切入点+通知—通知(Advice)说明了干什么的内容(即方法体代码)和什么时候干（什么时候通过方法名中的before，after，around等就能知道），二切入点说明了在哪干（指定到底是哪个方法），切点表达式等定义。</p></li></ul><h3 id="2-两种代理方式"><a href="#2-两种代理方式" class="headerlink" title="2.两种代理方式"></a>2.两种代理方式</h3><h4 id="2-1-JDK动态代理"><a href="#2-1-JDK动态代理" class="headerlink" title="2.1.JDK动态代理"></a>2.1.JDK动态代理</h4><blockquote><p>主要是代理接口；</p></blockquote><blockquote><p>jdk的动态代理调用了Proxy.newProxyInstance(ClassLoader loader,Class&lt;?&gt;[] interfaces,InvocationHandler h) 方法；</p></blockquote><blockquote><p>代理类需要继承java.lang.reflect.invocationHandle 接口；</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>InvocationHandler<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Method<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Proxy<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>aspect<span class="token punctuation">.</span>MyAspect<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>jdk<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdkProxy</span> <span class="token keyword">implements</span> <span class="token class-name">InvocationHandler</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> Userdao userdao<span class="token punctuation">;</span>    <span class="token keyword">public</span> Object <span class="token function">creatProxy</span><span class="token punctuation">(</span>Userdao userdao<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>userdao<span class="token operator">=</span>userdao<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//类加载器</span>        ClassLoader classLoader<span class="token operator">=</span>JdkProxy<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//获取所有目标对象所有接口</span>        Class<span class="token punctuation">[</span><span class="token punctuation">]</span> clazz<span class="token operator">=</span>userdao<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//返回代理后对象</span>        <span class="token keyword">return</span> Proxy<span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">,</span> clazz<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> Object <span class="token function">invoke</span><span class="token punctuation">(</span>Object proxy<span class="token punctuation">,</span> Method method<span class="token punctuation">,</span> Object<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>            <span class="token keyword">throws</span> Throwable <span class="token punctuation">{</span>        MyAspect myAspect<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyAspect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        myAspect<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Object obj<span class="token operator">=</span>method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>userdao<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>        myAspect<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> obj<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="2-2-CGLIB代理"><a href="#2-2-CGLIB代理" class="headerlink" title="2.2  CGLIB代理"></a>2.2  CGLIB代理</h4><blockquote><p>主要是代理类。</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>proxy<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Method<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>MethodInterceptor<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>MethodProxy<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>Enhancer<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>aspect<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CglibPoxy</span> <span class="token keyword">implements</span> <span class="token class-name">MethodInterceptor</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> Object <span class="token function">crearProxy</span><span class="token punctuation">(</span>Object target<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//创建动态对象</span>        Enhancer enhancer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Enhancer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//确定要增强胡类及设置父类</span>        enhancer<span class="token punctuation">.</span><span class="token function">setSuperclass</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        enhancer<span class="token punctuation">.</span><span class="token function">setCallback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> enhancer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> Object <span class="token function">intercept</span><span class="token punctuation">(</span>Object proxy<span class="token punctuation">,</span> Method method<span class="token punctuation">,</span> Object<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">,</span>            MethodProxy methodProxy<span class="token punctuation">)</span> <span class="token keyword">throws</span> Throwable <span class="token punctuation">{</span>        MyAspect myAspect<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyAspect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        myAspect<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Object object<span class="token operator">=</span> methodProxy<span class="token punctuation">.</span><span class="token function">invokeSuper</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>        myAspect<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> object<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="3-Spring-AOP的实现"><a href="#3-Spring-AOP的实现" class="headerlink" title="3.Spring AOP的实现"></a>3.Spring AOP的实现</h3><h4 id="3-1-所需类包："><a href="#3-1-所需类包：" class="headerlink" title="3.1.所需类包："></a>3.1.所需类包：</h4><ul><li>spring 核心包</li><li>spring-aop-4.3-release.jar</li><li>aopalliance-1.0.jar<blockquote><p>主要是通过 ProxyFactoryBean 来创建代理实例</p></blockquote></li></ul><h4 id="3-2-实现："><a href="#3-2-实现：" class="headerlink" title="3.2.实现："></a>3.2.实现：</h4><ul><li><p>Myaspect切面类：</p><pre class=" language-java"><code class="language-java">  <span class="token keyword">package</span> com<span class="token punctuation">.</span>aspect<span class="token punctuation">;</span>  <span class="token keyword">import</span> org<span class="token punctuation">.</span>aopalliance<span class="token punctuation">.</span>intercept<span class="token punctuation">.</span>MethodInterceptor<span class="token punctuation">;</span>  <span class="token keyword">import</span> org<span class="token punctuation">.</span>aopalliance<span class="token punctuation">.</span>intercept<span class="token punctuation">.</span>MethodInvocation<span class="token punctuation">;</span>  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Myaspect</span> <span class="token keyword">implements</span> <span class="token class-name">MethodInterceptor</span> <span class="token punctuation">{</span>      <span class="token keyword">public</span> Object <span class="token function">invoke</span><span class="token punctuation">(</span>MethodInvocation method<span class="token punctuation">)</span> <span class="token keyword">throws</span> Throwable <span class="token punctuation">{</span>          <span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          Object object<span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">return</span> object<span class="token punctuation">;</span>      <span class="token punctuation">}</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"模拟检查权限。。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"模拟检查日志。。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span></code></pre><p>  }</p></li><li><p>application配置文件:</p><pre class=" language-xaml"><code class="language-xaml">  <?xml version="1.0" encoding="UTF-8"?>  <beans xmlns="http://www.springframework.org/schema/beans"      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"      xsi:schemaLocation="http://www.springframework.org/schema/beans          http://www.springframework.org/schema/beans/spring-beans.xsd">      <bean id="userdao" class="com.dao.Userdaoimpl"/>      <bean id="myaspect" class="com.aspect.Myaspect"/>      <bean id="userdaoproxy" class="org.springframework.aop.framework.ProxyFactoryBean">      <!-- <property name="proxyInterfaces" value="com.dao.Userdao"></property> -->              <property name="target" ref="userdao"></property>          <property name="interceptorNames" value="myaspect"></property>      </bean>  </beans></code></pre></li></ul><h3 id="4-Aspectj-开发"><a href="#4-Aspectj-开发" class="headerlink" title="4.Aspectj 开发"></a>4.Aspectj 开发</h3><blockquote><p>主要包类：</p></blockquote><ul><li>spring 核心包</li><li>spring-aop-4.3-release.jar</li><li>aspectjweaver-1.8.10.jar</li></ul><h4 id="4-1-基于XML声明"><a href="#4-1-基于XML声明" class="headerlink" title="4.1 基于XML声明"></a>4.1 基于XML声明</h4><blockquote><p>实现：</p></blockquote><ul><li><p>applicationContext配置文件:</p><pre class=" language-xml"><code class="language-xml">  <span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>aop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/aop<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans          http://www.springframework.org/schema/beans/spring-beans.xsd          http://www.springframework.org/schema/aop          http://www.springframework.org/schema/aop/spring-aop-4.3.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>userdao<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.dao.Userdao<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myaspect<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.aspect.Myaspect<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myaspect<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pointcut1<span class="token punctuation">"</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>execution(* com.dao.*.*(..))<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>pointcut</span><span class="token punctuation">></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>before</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mybefore<span class="token punctuation">"</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pointcut1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>after-returning</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myafterRetern<span class="token punctuation">"</span></span> <span class="token attr-name">returning</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>returnVal<span class="token punctuation">"</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pointcut1<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>around</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myAround<span class="token punctuation">"</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pointcut1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>after-throwing</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mythrow<span class="token punctuation">"</span></span> <span class="token attr-name">throwing</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>e<span class="token punctuation">"</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pointcut1<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>after</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myAfter<span class="token punctuation">"</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pointcut1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span></code></pre></li></ul><ul><li><p>Aspect切面类：</p><pre class=" language-java"><code class="language-java">  <span class="token keyword">package</span> com<span class="token punctuation">.</span>aspect<span class="token punctuation">;</span>  <span class="token keyword">import</span> org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>JoinPoint<span class="token punctuation">;</span>  <span class="token keyword">import</span> org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ProceedingJoinPoint<span class="token punctuation">;</span>  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Myaspect</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">//前置通知</span>      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mybefore</span><span class="token punctuation">(</span>JoinPoint joinPoint<span class="token punctuation">)</span><span class="token punctuation">{</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"模拟前置执行通知。。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"执行的目标类： "</span><span class="token operator">+</span>joinPoint<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"目标方法： "</span><span class="token operator">+</span>joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token comment" spellcheck="true">//后置通知</span>      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">myafterRetern</span><span class="token punctuation">(</span>JoinPoint joinPoint<span class="token punctuation">,</span>Object returnVal<span class="token punctuation">)</span><span class="token punctuation">{</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>returnVal<span class="token punctuation">)</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"模拟后置记录日志"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"目标方法： "</span><span class="token operator">+</span>joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token comment" spellcheck="true">//环绕通知</span>      <span class="token keyword">public</span> Object <span class="token function">myAround</span><span class="token punctuation">(</span>ProceedingJoinPoint proceedingJoinPoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> Throwable<span class="token punctuation">{</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"环绕前置开始：---"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          Object object<span class="token operator">=</span>proceedingJoinPoint<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"环绕后置结束：---"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">return</span> object<span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token comment" spellcheck="true">//异常通知</span>      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mythrow</span><span class="token punctuation">(</span>JoinPoint joinPoint<span class="token punctuation">,</span>Throwable e<span class="token punctuation">)</span><span class="token punctuation">{</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"异常发生： "</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token comment" spellcheck="true">//最终通知</span>      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">myAfter</span><span class="token punctuation">(</span>JoinPoint joinPoint<span class="token punctuation">)</span><span class="token punctuation">{</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"最终通知。。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>  <span class="token punctuation">}</span></code></pre></li></ul><h4 id="4-1-基于注解声明"><a href="#4-1-基于注解声明" class="headerlink" title="4.1 基于注解声明"></a>4.1 基于注解声明</h4><ul><li><p>applicationContext配置文件:</p><pre class=" language-xml"><code class="language-xml">  <span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>aop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/aop<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans          http://www.springframework.org/schema/beans/spring-beans.xsd          http://www.springframework.org/schema/aop          http://www.springframework.org/schema/aop/spring-aop-4.3.xsd          http://www.springframework.org/schema/context          http://www.springframework.org/schema/context/spring-context-4.3.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspectj-autoproxy</span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span></code></pre></li></ul><p>*Aspect切面类：</p><pre class=" language-java"><code class="language-java">    <span class="token keyword">package</span> com<span class="token punctuation">.</span>aspect<span class="token punctuation">;</span>    <span class="token keyword">import</span> org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>JoinPoint<span class="token punctuation">;</span>    <span class="token keyword">import</span> org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ProceedingJoinPoint<span class="token punctuation">;</span>    <span class="token keyword">import</span> org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>*<span class="token punctuation">;</span>    <span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span>Component<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Aspect</span>    <span class="token annotation punctuation">@Component</span>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Myaspect</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//定义切入点</span>        <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">"execution(* com.dao.*.*(..))"</span><span class="token punctuation">)</span>        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">mypointcut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//前置通知</span>        <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">"mypointcut()"</span><span class="token punctuation">)</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mybefore</span><span class="token punctuation">(</span>JoinPoint joinPoint<span class="token punctuation">)</span><span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"模拟前置执行通知。。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"执行的目标类： "</span><span class="token operator">+</span>joinPoint<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"目标方法： "</span><span class="token operator">+</span>joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//后置通知</span>        <span class="token annotation punctuation">@AfterReturning</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"mypointcut()"</span><span class="token punctuation">,</span>returning<span class="token operator">=</span><span class="token string">"returnVal"</span><span class="token punctuation">)</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">myafterRetern</span><span class="token punctuation">(</span>JoinPoint joinPoint<span class="token punctuation">,</span>Object returnVal<span class="token punctuation">)</span><span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>returnVal<span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"模拟后置记录日志"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"目标方法： "</span><span class="token operator">+</span>joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//环绕通知</span>        <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">"mypointcut()"</span><span class="token punctuation">)</span>        <span class="token keyword">public</span> Object <span class="token function">myAround</span><span class="token punctuation">(</span>ProceedingJoinPoint proceedingJoinPoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> Throwable<span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"环绕前置开始：---"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Object object<span class="token operator">=</span>proceedingJoinPoint<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"环绕后置结束：---"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> object<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//异常通知</span>        <span class="token annotation punctuation">@AfterThrowing</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"mypointcut()"</span><span class="token punctuation">,</span>throwing<span class="token operator">=</span><span class="token string">"e"</span><span class="token punctuation">)</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mythrow</span><span class="token punctuation">(</span>JoinPoint joinPoint<span class="token punctuation">,</span>Throwable e<span class="token punctuation">)</span><span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"异常发生： "</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//最终通知</span>        <span class="token annotation punctuation">@After</span><span class="token punctuation">(</span><span class="token string">"mypointcut()"</span><span class="token punctuation">)</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">myAfter</span><span class="token punctuation">(</span>JoinPoint joinPoint<span class="token punctuation">)</span><span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"最终通知。。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> AOP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>阿里云服务器￥67/年</title>
      <link href="/posts/24658226.html"/>
      <url>/posts/24658226.html</url>
      
        <content type="html"><![CDATA[<h2 id="阿里云服务器￥67-年"><a href="#阿里云服务器￥67-年" class="headerlink" title="阿里云服务器￥67/年"></a>阿里云服务器￥67/年</h2><blockquote><p>今天天气不错！！</p></blockquote><hr><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/aliyun-esc-1.png" alt=""></p><p><strong>阿里云新用户￥67一年，配置1核 CPU、2G 内存、1M 带宽、40G 高效云盘</strong></p><h3 id="服务器作用？"><a href="#服务器作用？" class="headerlink" title="服务器作用？"></a>服务器作用？</h3><p>服务器就就相当于一个远程永不关机的电脑，在服务器上操作就好像在自己电脑操作一样，你可以用来搭建自己网站，博客，以及应用等。</p><p>同时服务器可以说是个全新的电脑，你可以安装你想安装的应用，想怎么玩都行。不想有些虚拟主机，就只能有PHP环境而已，局限性也很多。</p><p>相对服务器来说，你可以安装任何你想安装的环境，如Java、nodeJs、php等..</p><h3 id="活动介绍"><a href="#活动介绍" class="headerlink" title="活动介绍"></a>活动介绍</h3><p>阿里云新用户最低可以<code>券后￥67</code>购买一年国内ECS突发性能型t5服务器,超划算！</p><p>另外还可以以附送了其它产品(对象存储OSS、云数据库mysql等)</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/aliyun-esc-5.png" alt=""></p><p>记得想领取以下优惠券在购买更实惠呢，同时还要其他众多优惠价领取！</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/athink8/cdn/imgs/arctle/aliyun-esc-4.png" alt=""></p><blockquote><p>学生机都要 114 元呢，当初我买的时候瞬间都觉得好亏哦。</p></blockquote><p>活动链接：<a href="https://www.aliyun.com/minisite/goods?userCode=as7ll10k" target="_blank" rel="noopener">点我进入购买</a></p><p>活动时间：活动长期有效</p><hr><h3 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h3><blockquote><p>国内外免费主机大多数我基本都用过，总结一句，不是文件容易丢失就是速度慢访问不了或者带个常常的网站logo或者各种约束限制等，用的真糟心。</p><p>便宜的主机又也基本不理想，有着闲工夫还不如用服务器踏实..</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 分享 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 分享 </tag>
            
            <tag> 服务器 </tag>
            
            <tag> 阿里云 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟安装ssl证书在Tomcat上</title>
      <link href="/posts/2fddf34.html"/>
      <url>/posts/2fddf34.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟安装ssl证书在Tomcat上"><a href="#11分钟安装ssl证书在Tomcat上" class="headerlink" title="11分钟安装ssl证书在Tomcat上"></a>11分钟安装ssl证书在Tomcat上</h2><blockquote><p><code>正是因为这一点一滴觉得还有希望的自己，才是最无可救药的吧。</code></p></blockquote><hr><p>在Tomcat上正确的配置ssl证书,可使你的网站的HTTP转为HTTPS协议，能够让你的网站更加安全，同时也使域名在浏览器上显示小绿标更加美观点。</p><p><strong>HTTPS有如下特点：</strong></p><ol><li>内容加密：采用混合加密技术，中间者无法直接查看明文内容</li><li>验证身份：通过证书认证客户端访问的是自己的服务器</li><li>保护数据完整性：防止传输的内容被中间人冒充或者篡改</li></ol><h3 id="1-在server-xm配置证书"><a href="#1-在server-xm配置证书" class="headerlink" title="1.在server.xm配置证书"></a>1.在server.xm配置证书</h3><blockquote><p>添加如下 并在主端口修改  redirectPort=”443” </p></blockquote><pre><code>&lt;Connector port=&quot;443&quot;    protocol=&quot;org.apache.coyote.http11.Http11NioProtocol&quot;     SSLEnabled=&quot;true&quot;    scheme=&quot;https&quot;    secure=&quot;true&quot;    keystoreFile=&quot;/tomcat8/conf/mySSL/2826717_onfree.cn.pfx&quot;       keystoreType=&quot;PKCS12&quot;    keystorePass=&quot;TlB73znA&quot;       clientAuth=&quot;false&quot;    SSLProtocol=&quot;TLSv1+TLSv1.1+TLSv1.2&quot;    ciphers=&quot;TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;/&gt;SSLCipherSuite:配置符合PFS规范的加密套餐,苹果ATS特性服务器需要（是否配置自行选择）ciphers：服务器加密套件（是否配置自行选择）SSLProtocol：在服务端TLS协议中启用TLS1.2，苹果ATS特性服务器和微信小程序都需要TLS版本为1.2以上，这个还需要jdk支持TLS1.2，jdk1.6和jdk1.7都需要第三方插件，jdk1.8默认支持TLS1.2（是否配置自行选择）keystoreFile：证书文件的绝对路径keystorePass：证书密码，这个文件里面</code></pre><h3 id="2-在web-xml配置强制将http跳转至https（可选配置）"><a href="#2-在web-xml配置强制将http跳转至https（可选配置）" class="headerlink" title="2.在web.xml配置强制将http跳转至https（可选配置）"></a>2.在web.xml配置强制将http跳转至https（可选配置）</h3><pre><code>#在&lt;/welcome-file-list&gt;后添加以下内容：&lt;login-config&gt;      &lt;!-- Authorization setting for SSL --&gt;      &lt;auth-method&gt;CLIENT-CERT&lt;/auth-method&gt;      &lt;realm-name&gt;Client Cert Users-only Area&lt;/realm-name&gt;  &lt;/login-config&gt;  &lt;security-constraint&gt;      &lt;!-- Authorization setting for SSL --&gt;      &lt;web-resource-collection &gt;          &lt;web-resource-name &gt;SSL&lt;/web-resource-name&gt;          &lt;url-pattern&gt;/*&lt;/url-pattern&gt;      &lt;/web-resource-collection&gt;      &lt;user-data-constraint&gt;          &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;      &lt;/user-data-constraint&gt;  &lt;/security-constraint&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> Tomcat </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tomcat </tag>
            
            <tag> ssl </tag>
            
            <tag> https </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟使用SpringBoot整合redis组件</title>
      <link href="/posts/c0ba78a5.html"/>
      <url>/posts/c0ba78a5.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟使用SpringBoot整合redis组件"><a href="#11分钟使用SpringBoot整合redis组件" class="headerlink" title="11分钟使用SpringBoot整合redis组件"></a>11分钟使用SpringBoot整合redis组件</h2><blockquote><p><code>不要跟过去的自己比，要期待未来的自己，珍爱现在的自己</code></p></blockquote><h3 id="1-添加Redis相关依赖"><a href="#1-添加Redis相关依赖" class="headerlink" title="1.添加Redis相关依赖"></a>1.添加Redis相关依赖</h3><pre class=" language-xml"><code class="language-xml"><span class="token comment" spellcheck="true">&lt;!--Redis相关依赖--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><h3 id="2-application-properties中redis相关配置"><a href="#2-application-properties中redis相关配置" class="headerlink" title="2.application.properties中redis相关配置"></a>2.<strong>application.properties中redis相关配置</strong></h3><pre class=" language-xml"><code class="language-xml"># Redis数据库索引（默认为0）spring.redis.database=0  # Redis服务器地址spring.redis.host=127.0.0.1# Redis服务器连接端口spring.redis.port=6379  # Redis服务器连接密码（默认为空）spring.redis.password=# 连接池最大连接数（使用负值表示没有限制）spring.redis.jedis.pool.max-active=200 # 连接池最大阻塞等待时间（使用负值表示没有限制）spring.redis.jedis.pool.max-wait=-1# 连接池中的最大空闲连接spring.redis.jedis.pool.max-idle=10 # 连接池中的最小空闲连接spring.redis.jedis.pool.min-idle=10 # 连接超时时间（毫秒）spring.redis.timeout=1000</code></pre><h3 id="3-redis自定义配置"><a href="#3-redis自定义配置" class="headerlink" title="3.redis自定义配置"></a>3.redis自定义配置</h3><blockquote><p>SpringBoot自动在容器中生成了一个<code>RedisTemplate</code>和一个<code>StringRedisTemplate</code></p></blockquote><p> 第一种：（添加方式添加配置）</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyRedisConfig</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/**      * 修改默认序列化得方式为Json解析    **/</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> RedisTemplate<span class="token operator">&lt;</span>Object<span class="token punctuation">,</span> Employee<span class="token operator">></span> <span class="token function">empRedisTemplate</span><span class="token punctuation">(</span>            RedisConnectionFactory redisConnectionFactory<span class="token punctuation">)</span>            <span class="token keyword">throws</span> UnknownHostException <span class="token punctuation">{</span>        RedisTemplate<span class="token operator">&lt;</span>Object<span class="token punctuation">,</span> Employee<span class="token operator">></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token operator">&lt;</span>Object<span class="token punctuation">,</span> Employee<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>        Jackson2JsonRedisSerializer<span class="token operator">&lt;</span>Employee<span class="token operator">></span> ser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token operator">&lt;</span>Employee<span class="token operator">></span><span class="token punctuation">(</span>Employee<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setDefaultSerializer</span><span class="token punctuation">(</span>ser<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> template<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> RedisTemplate<span class="token operator">&lt;</span>Object<span class="token punctuation">,</span> Department<span class="token operator">></span> <span class="token function">deptRedisTemplate</span><span class="token punctuation">(</span>            RedisConnectionFactory redisConnectionFactory<span class="token punctuation">)</span>            <span class="token keyword">throws</span> UnknownHostException <span class="token punctuation">{</span>        RedisTemplate<span class="token operator">&lt;</span>Object<span class="token punctuation">,</span> Department<span class="token operator">></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token operator">&lt;</span>Object<span class="token punctuation">,</span> Department<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>        Jackson2JsonRedisSerializer<span class="token operator">&lt;</span>Department<span class="token operator">></span> ser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token operator">&lt;</span>Department<span class="token operator">></span><span class="token punctuation">(</span>Department<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setDefaultSerializer</span><span class="token punctuation">(</span>ser<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> template<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//CacheManagerCustomizers可以来定制缓存的一些规则</span>    <span class="token annotation punctuation">@Primary</span>  <span class="token comment" spellcheck="true">//将某个缓存管理器作为默认的</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> RedisCacheManager <span class="token function">employeeCacheManager</span><span class="token punctuation">(</span>RedisTemplate<span class="token operator">&lt;</span>Object<span class="token punctuation">,</span> Employee<span class="token operator">></span> empRedisTemplate<span class="token punctuation">)</span><span class="token punctuation">{</span>        RedisCacheManager cacheManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisCacheManager</span><span class="token punctuation">(</span>empRedisTemplate<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//key多了一个前缀</span>        <span class="token comment" spellcheck="true">//使用前缀，默认会将CacheName作为key的前缀</span>        cacheManager<span class="token punctuation">.</span><span class="token function">setUsePrefix</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> cacheManager<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> RedisCacheManager <span class="token function">deptCacheManager</span><span class="token punctuation">(</span>RedisTemplate<span class="token operator">&lt;</span>Object<span class="token punctuation">,</span> Department<span class="token operator">></span> deptRedisTemplate<span class="token punctuation">)</span><span class="token punctuation">{</span>        RedisCacheManager cacheManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisCacheManager</span><span class="token punctuation">(</span>deptRedisTemplate<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//key多了一个前缀</span>        <span class="token comment" spellcheck="true">//使用前缀，默认会将CacheName作为key的前缀</span>        cacheManager<span class="token punctuation">.</span><span class="token function">setUsePrefix</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> cacheManager<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p> 第二种：（重写redisTemplate）</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"all"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> RedisTemplate<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span>RedisConnectionFactory factory<span class="token punctuation">)</span> <span class="token punctuation">{</span>        RedisTemplate<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span><span class="token punctuation">;</span>        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ObjectMapper om <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        om<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>PropertyAccessor<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> JsonAutoDetect<span class="token punctuation">.</span>Visibility<span class="token punctuation">.</span>ANY<span class="token punctuation">)</span><span class="token punctuation">;</span>        om<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span>ObjectMapper<span class="token punctuation">.</span>DefaultTyping<span class="token punctuation">.</span>NON_FINAL<span class="token punctuation">)</span><span class="token punctuation">;</span>        jackson2JsonRedisSerializer<span class="token punctuation">.</span><span class="token function">setObjectMapper</span><span class="token punctuation">(</span>om<span class="token punctuation">)</span><span class="token punctuation">;</span>        StringRedisSerializer stringRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// key采用String的序列化方式</span>        template<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span>stringRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// hash的key也采用String的序列化方式</span>        template<span class="token punctuation">.</span><span class="token function">setHashKeySerializer</span><span class="token punctuation">(</span>stringRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// value序列化方式采用jackson</span>        template<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// hash的value序列化方式采用jackson</span>        template<span class="token punctuation">.</span><span class="token function">setHashValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> template<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> SpringBoot </tag>
            
            <tag> 整合 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟使用Java中HttpClient</title>
      <link href="/posts/2d8346af.html"/>
      <url>/posts/2d8346af.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟使用Java中HttpClient"><a href="#11分钟使用Java中HttpClient" class="headerlink" title="11分钟使用Java中HttpClient"></a>11分钟使用Java中HttpClient</h2><blockquote><p><code>从现在开始，我将追寻你的名字</code></p></blockquote><hr><h3 id="一、HttpClient简介"><a href="#一、HttpClient简介" class="headerlink" title="一、HttpClient简介"></a>一、HttpClient简介</h3><blockquote><p>在 Internet ，HTTP 协议上是使用得最多、最重要的协议了，越来越多的 Java 应用程序需要直接通过 HTTP 协议来访问网络资源。HttpClient 是 Apache Jakarta Common 下的子项目，用来提供高效的、最新的、功能丰富的支持 HTTP 协议的客户端编程工具包，并且它支持 HTTP 协议最新的版本和建议。</p><p>HttpClient实现了所有 HTTP 的方法（GET、POST、PUT、HEAD、DELETE、HEAD、OPTIONS 等）<br>支持 HTTPS 协议<br>支持代理服务器（Nginx等）等<br>支持自动（跳转）转向</p></blockquote><h3 id="二、HttpClient的主要功能："><a href="#二、HttpClient的主要功能：" class="headerlink" title="二、HttpClient的主要功能："></a>二、HttpClient的主要功能：</h3><h4 id="GET无参："><a href="#GET无参：" class="headerlink" title="GET无参："></a>GET无参：</h4><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** * GET---无参测试 * @date 2020年2月23日 下午4:18:50 */</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doGetTestOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 获得Http客户端(可以理解为:你得先有一个浏览器;注意:实际上HttpClient与浏览器是不一样的)</span>    CloseableHttpClient httpClient <span class="token operator">=</span> HttpClientBuilder<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 创建Get请求</span>    HttpGet httpGet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpGet</span><span class="token punctuation">(</span><span class="token string">"http://localhost:12345/doGetControllerOne"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 响应模型</span>    CloseableHttpResponse response <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 由客户端执行(发送)Get请求</span>        response <span class="token operator">=</span> httpClient<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>httpGet<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 从响应模型中获取响应实体</span>        HttpEntity responseEntity <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应状态为:"</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getStatusLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>responseEntity <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应内容长度为:"</span> <span class="token operator">+</span> responseEntity<span class="token punctuation">.</span><span class="token function">getContentLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应内容为:"</span> <span class="token operator">+</span> EntityUtils<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>responseEntity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClientProtocolException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// 释放资源</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>httpClient <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                httpClient<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>response <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                response<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="GET有参-方式一：直接拼接URL-："><a href="#GET有参-方式一：直接拼接URL-：" class="headerlink" title="GET有参(方式一：直接拼接URL)："></a>GET有参(方式一：直接拼接URL)：</h4><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** * GET---有参测试 (方式一:手动在url后面加上参数) * @date 2020年2月23日 下午4:19:23 */</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doGetTestWayOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 获得Http客户端(可以理解为:你得先有一个浏览器;注意:实际上HttpClient与浏览器是不一样的)</span>    CloseableHttpClient httpClient <span class="token operator">=</span> HttpClientBuilder<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 参数</span>    StringBuffer params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 字符数据最好encoding以下;这样一来，某些特殊字符才能传过去(如:某人的名字就是“&amp;”,不encoding的话,传不过去)</span>        params<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"name="</span> <span class="token operator">+</span> URLEncoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">"&amp;"</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        params<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"&amp;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        params<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"age=24"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnsupportedEncodingException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 创建Get请求</span>    HttpGet httpGet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpGet</span><span class="token punctuation">(</span><span class="token string">"http://localhost:12345/doGetControllerTwo"</span> <span class="token operator">+</span> <span class="token string">"?"</span> <span class="token operator">+</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 响应模型</span>    CloseableHttpResponse response <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 配置信息</span>        RequestConfig requestConfig <span class="token operator">=</span> RequestConfig<span class="token punctuation">.</span><span class="token function">custom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">// 设置连接超时时间(单位毫秒)</span>                <span class="token punctuation">.</span><span class="token function">setConnectTimeout</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">// 设置请求超时时间(单位毫秒)</span>                <span class="token punctuation">.</span><span class="token function">setConnectionRequestTimeout</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">// socket读写超时时间(单位毫秒)</span>                <span class="token punctuation">.</span><span class="token function">setSocketTimeout</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">// 设置是否允许重定向(默认为true)</span>                <span class="token punctuation">.</span><span class="token function">setRedirectsEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 将上面的配置信息 运用到这个Get请求里</span>        httpGet<span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span>requestConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 由客户端执行(发送)Get请求</span>        response <span class="token operator">=</span> httpClient<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>httpGet<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 从响应模型中获取响应实体</span>        HttpEntity responseEntity <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应状态为:"</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getStatusLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>responseEntity <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应内容长度为:"</span> <span class="token operator">+</span> responseEntity<span class="token punctuation">.</span><span class="token function">getContentLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应内容为:"</span> <span class="token operator">+</span> EntityUtils<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>responseEntity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClientProtocolException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// 释放资源</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>httpClient <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                httpClient<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>response <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                response<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="GET有参-方式二：使用URI获得HttpGet-："><a href="#GET有参-方式二：使用URI获得HttpGet-：" class="headerlink" title="GET有参(方式二：使用URI获得HttpGet)："></a>GET有参(方式二：使用URI获得HttpGet)：</h4><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** * GET---有参测试 (方式二:将参数放入键值对类中,再放入URI中,从而通过URI得到HttpGet实例) * @date 2020年2月23日 下午4:19:23 */</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doGetTestWayTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 获得Http客户端(可以理解为:你得先有一个浏览器;注意:实际上HttpClient与浏览器是不一样的)</span>    CloseableHttpClient httpClient <span class="token operator">=</span> HttpClientBuilder<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 参数</span>    URI uri <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 将参数放入键值对类NameValuePair中,再放入集合中</span>        List<span class="token operator">&lt;</span>NameValuePair<span class="token operator">></span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        params<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BasicNameValuePair</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"&amp;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        params<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BasicNameValuePair</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 设置uri信息,并将参数集合放入uri;</span>        <span class="token comment" spellcheck="true">// 注:这里也支持一个键值对一个键值对地往里面放setParameter(String key, String value)</span>        uri <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URIBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setScheme</span><span class="token punctuation">(</span><span class="token string">"http"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">)</span>                              <span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">12345</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">"/doGetControllerTwo"</span><span class="token punctuation">)</span>                              <span class="token punctuation">.</span><span class="token function">setParameters</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">URISyntaxException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 创建Get请求</span>    HttpGet httpGet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpGet</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 响应模型</span>    CloseableHttpResponse response <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 配置信息</span>        RequestConfig requestConfig <span class="token operator">=</span> RequestConfig<span class="token punctuation">.</span><span class="token function">custom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">// 设置连接超时时间(单位毫秒)</span>                <span class="token punctuation">.</span><span class="token function">setConnectTimeout</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">// 设置请求超时时间(单位毫秒)</span>                <span class="token punctuation">.</span><span class="token function">setConnectionRequestTimeout</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">// socket读写超时时间(单位毫秒)</span>                <span class="token punctuation">.</span><span class="token function">setSocketTimeout</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">// 设置是否允许重定向(默认为true)</span>                <span class="token punctuation">.</span><span class="token function">setRedirectsEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 将上面的配置信息 运用到这个Get请求里</span>        httpGet<span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span>requestConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 由客户端执行(发送)Get请求</span>        response <span class="token operator">=</span> httpClient<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>httpGet<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 从响应模型中获取响应实体</span>        HttpEntity responseEntity <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应状态为:"</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getStatusLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>responseEntity <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应内容长度为:"</span> <span class="token operator">+</span> responseEntity<span class="token punctuation">.</span><span class="token function">getContentLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应内容为:"</span> <span class="token operator">+</span> EntityUtils<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>responseEntity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClientProtocolException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// 释放资源</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>httpClient <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                httpClient<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>response <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                response<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="POST无参："><a href="#POST无参：" class="headerlink" title="POST无参："></a>POST无参：</h4><pre><code>/** * POST---无参测试 * @date 2020年2月23日 下午4:18:50 */@Testpublic void doPostTestOne() {    // 获得Http客户端(可以理解为:你得先有一个浏览器;注意:实际上HttpClient与浏览器是不一样的)    CloseableHttpClient httpClient = HttpClientBuilder.create().build();    // 创建Post请求    HttpPost httpPost = new HttpPost(&quot;http://localhost:12345/doPostControllerOne&quot;);    // 响应模型    CloseableHttpResponse response = null;    try {        // 由客户端执行(发送)Post请求        response = httpClient.execute(httpPost);        // 从响应模型中获取响应实体        HttpEntity responseEntity = response.getEntity();        System.out.println(&quot;响应状态为:&quot; + response.getStatusLine());        if (responseEntity != null) {            System.out.println(&quot;响应内容长度为:&quot; + responseEntity.getContentLength());            System.out.println(&quot;响应内容为:&quot; + EntityUtils.toString(responseEntity));        }    } catch (ClientProtocolException e) {        e.printStackTrace();    } catch (ParseException e) {        e.printStackTrace();    } catch (IOException e) {        e.printStackTrace();    } finally {        try {            // 释放资源            if (httpClient != null) {                httpClient.close();            }            if (response != null) {                response.close();            }        } catch (IOException e) {            e.printStackTrace();        }    }}</code></pre><h4 id="POST有参-普通参数-："><a href="#POST有参-普通参数-：" class="headerlink" title="POST有参(普通参数)："></a>POST有参(普通参数)：</h4><blockquote><p>注：POST传递普通参数时，方式与GET一样即可，这里以直接在url后缀上参数的方式示例。</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** * POST---有参测试(普通参数) * @date 2020年2月23日 下午4:18:50 */</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doPostTestFour</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 获得Http客户端(可以理解为:你得先有一个浏览器;注意:实际上HttpClient与浏览器是不一样的)</span>    CloseableHttpClient httpClient <span class="token operator">=</span> HttpClientBuilder<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 参数</span>    StringBuffer params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 字符数据最好encoding以下;这样一来，某些特殊字符才能传过去(如:某人的名字就是“&amp;”,不encoding的话,传不过去)</span>        params<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"name="</span> <span class="token operator">+</span> URLEncoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">"&amp;"</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        params<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"&amp;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        params<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"age=24"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnsupportedEncodingException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 创建Post请求</span>    HttpPost httpPost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpPost</span><span class="token punctuation">(</span><span class="token string">"http://localhost:12345/doPostControllerFour"</span> <span class="token operator">+</span> <span class="token string">"?"</span> <span class="token operator">+</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 设置ContentType(注:如果只是传普通参数的话,ContentType不一定非要用application/json)</span>    httpPost<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"application/json;charset=utf8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 响应模型</span>    CloseableHttpResponse response <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 由客户端执行(发送)Post请求</span>        response <span class="token operator">=</span> httpClient<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>httpPost<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 从响应模型中获取响应实体</span>        HttpEntity responseEntity <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应状态为:"</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getStatusLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>responseEntity <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应内容长度为:"</span> <span class="token operator">+</span> responseEntity<span class="token punctuation">.</span><span class="token function">getContentLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应内容为:"</span> <span class="token operator">+</span> EntityUtils<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>responseEntity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClientProtocolException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// 释放资源</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>httpClient <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                httpClient<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>response <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                response<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="POST有参-对象参数-："><a href="#POST有参-对象参数-：" class="headerlink" title="POST有参(对象参数)："></a>POST有参(对象参数)：</h4><pre><code>/** * POST---有参测试(对象参数) * @date 2020年2月23日 下午4:18:50 */@Testpublic void doPostTestTwo() {    // 获得Http客户端(可以理解为:你得先有一个浏览器;注意:实际上HttpClient与浏览器是不一样的)    CloseableHttpClient httpClient = HttpClientBuilder.create().build();    // 创建Post请求    HttpPost httpPost = new HttpPost(&quot;http://localhost:12345/doPostControllerTwo&quot;);    User user = new User();    user.setName(&quot;潘晓婷&quot;);    user.setAge(18);    user.setGender(&quot;女&quot;);    user.setMotto(&quot;姿势要优雅~&quot;);    // 我这里利用阿里的fastjson，将Object转换为json字符串;    // (需要导入com.alibaba.fastjson.JSON包)    String jsonString = JSON.toJSONString(user);    StringEntity entity = new StringEntity(jsonString, &quot;UTF-8&quot;);    // post请求是将参数放在请求体里面传过去的;这里将entity放入post请求体中    httpPost.setEntity(entity);    httpPost.setHeader(&quot;Content-Type&quot;, &quot;application/json;charset=utf8&quot;);    // 响应模型    CloseableHttpResponse response = null;    try {        // 由客户端执行(发送)Post请求        response = httpClient.execute(httpPost);        // 从响应模型中获取响应实体        HttpEntity responseEntity = response.getEntity();        System.out.println(&quot;响应状态为:&quot; + response.getStatusLine());        if (responseEntity != null) {            System.out.println(&quot;响应内容长度为:&quot; + responseEntity.getContentLength());            System.out.println(&quot;响应内容为:&quot; + EntityUtils.toString(responseEntity));        }    } catch (ClientProtocolException e) {        e.printStackTrace();    } catch (ParseException e) {        e.printStackTrace();    } catch (IOException e) {        e.printStackTrace();    } finally {        try {            // 释放资源            if (httpClient != null) {                httpClient.close();            }            if (response != null) {                response.close();            }        } catch (IOException e) {            e.printStackTrace();        }    }}</code></pre><h4 id="POST有参-普通参数-对象参数-："><a href="#POST有参-普通参数-对象参数-：" class="headerlink" title="POST有参(普通参数 + 对象参数)："></a>POST有参(普通参数 + 对象参数)：</h4><blockquote><p>注：POST传递普通参数时，方式与GET一样即可，这里以通过URI获得HttpPost的方式为例。</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** * POST---有参测试(普通参数 + 对象参数) * @date 2020年2月23日 下午4:18:50 */</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doPostTestThree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 获得Http客户端(可以理解为:你得先有一个浏览器;注意:实际上HttpClient与浏览器是不一样的)</span>    CloseableHttpClient httpClient <span class="token operator">=</span> HttpClientBuilder<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 创建Post请求</span>    <span class="token comment" spellcheck="true">// 参数</span>    URI uri <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 将参数放入键值对类NameValuePair中,再放入集合中</span>        List<span class="token operator">&lt;</span>NameValuePair<span class="token operator">></span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        params<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BasicNameValuePair</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">,</span> <span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        params<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BasicNameValuePair</span><span class="token punctuation">(</span><span class="token string">"meaning"</span><span class="token punctuation">,</span> <span class="token string">"这是什么鬼？"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 设置uri信息,并将参数集合放入uri;</span>        <span class="token comment" spellcheck="true">// 注:这里也支持一个键值对一个键值对地往里面放setParameter(String key, String value)</span>        uri <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URIBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setScheme</span><span class="token punctuation">(</span><span class="token string">"http"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">12345</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">"/doPostControllerThree"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setParameters</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">URISyntaxException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    HttpPost httpPost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpPost</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// HttpPost httpPost = new</span>    <span class="token comment" spellcheck="true">// HttpPost("http://localhost:12345/doPostControllerThree1");</span>    <span class="token comment" spellcheck="true">// 创建user参数</span>    User user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"潘晓婷"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    user<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span><span class="token string">"女"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    user<span class="token punctuation">.</span><span class="token function">setMotto</span><span class="token punctuation">(</span><span class="token string">"姿势要优雅~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 将user对象转换为json字符串，并放入entity中</span>    StringEntity entity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringEntity</span><span class="token punctuation">(</span>JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// post请求是将参数放在请求体里面传过去的;这里将entity放入post请求体中</span>    httpPost<span class="token punctuation">.</span><span class="token function">setEntity</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>    httpPost<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"application/json;charset=utf8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 响应模型</span>    CloseableHttpResponse response <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 由客户端执行(发送)Post请求</span>        response <span class="token operator">=</span> httpClient<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>httpPost<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 从响应模型中获取响应实体</span>        HttpEntity responseEntity <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应状态为:"</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getStatusLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>responseEntity <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应内容长度为:"</span> <span class="token operator">+</span> responseEntity<span class="token punctuation">.</span><span class="token function">getContentLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"响应内容为:"</span> <span class="token operator">+</span> EntityUtils<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>responseEntity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClientProtocolException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// 释放资源</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>httpClient <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                httpClient<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>response <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                response<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="ssl证书忽略"><a href="#ssl证书忽略" class="headerlink" title="ssl证书忽略"></a>ssl证书忽略</h4><pre><code>    private static CloseableHttpClient getCloseableHttpClient() {            try {                SSLContextBuilder builder = new SSLContextBuilder();                builder.loadTrustMaterial(null, new TrustSelfSignedStrategy());                SSLConnectionSocketFactory sslConnectionSocketFactory = new SSLConnectionSocketFactory(builder.build(), NoopHostnameVerifier.INSTANCE);                Registry&lt;ConnectionSocketFactory&gt; registry = RegistryBuilder.&lt;ConnectionSocketFactory&gt;create()                        .register(&quot;http&quot;, new PlainConnectionSocketFactory())                        .register(&quot;https&quot;, sslConnectionSocketFactory)                        .build();                PoolingHttpClientConnectionManager cm = new PoolingHttpClientConnectionManager(registry);                cm.setMaxTotal(100);                return HttpClients.custom()                        .setSSLSocketFactory(sslConnectionSocketFactory)                        .setConnectionManager(cm)                        .build();            } catch (NoSuchAlgorithmException e) {                e.printStackTrace();            } catch (KeyStoreException e) {                e.printStackTrace();            } catch (KeyManagementException e) {                e.printStackTrace();            }            return null;        }</code></pre><hr>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> HttpClient </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟掌握Java中string和InputStream转换</title>
      <link href="/posts/ca446a09.html"/>
      <url>/posts/ca446a09.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟掌握Java中string和InputStream转换"><a href="#11分钟掌握Java中string和InputStream转换" class="headerlink" title="11分钟掌握Java中string和InputStream转换"></a>11分钟掌握Java中string和InputStream转换</h2><blockquote><p><code>相信奇迹的人本身就和奇迹一样了不起啊</code></p></blockquote><hr><h3 id="1、InputStream转化为String"><a href="#1、InputStream转化为String" class="headerlink" title="1、InputStream转化为String"></a>1、InputStream转化为String</h3><h4 id="1-1-JDK原生提供"><a href="#1-1-JDK原生提供" class="headerlink" title="1.1 JDK原生提供"></a>1.1 JDK原生提供</h4><h5 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h5><pre><code>byte[] bytes = new byte[0];bytes = new byte[inputStream.available()];inputStream.read(bytes);String str = new String(bytes);</code></pre><h5 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h5><pre><code>String result = new BufferedReader(new InputStreamReader(inputStream))        .lines().collect(Collectors.joining(System.lineSeparator()));</code></pre><h5 id="方法三："><a href="#方法三：" class="headerlink" title="方法三："></a>方法三：</h5><pre><code>String result = new BufferedReader(new InputStreamReader(inputStream))       .lines().parallel().collect(Collectors.joining(System.lineSeparator()));</code></pre><h5 id="方法四："><a href="#方法四：" class="headerlink" title="方法四："></a>方法四：</h5><pre><code>Scanner s = new Scanner(inputStream).useDelimiter(&quot;\\A&quot;);String str = s.hasNext() ? s.next() : &quot;&quot;;</code></pre><h5 id="方法五："><a href="#方法五：" class="headerlink" title="方法五："></a>方法五：</h5><pre><code>String resource = new Scanner(inputStream).useDelimiter(&quot;\\Z&quot;).next();return resource;</code></pre><h5 id="方法六："><a href="#方法六：" class="headerlink" title="方法六："></a>方法六：</h5><pre><code>StringBuilder sb = new StringBuilder();String line;BufferedReader br = new BufferedReader(new InputStreamReader(inputStream));while ((line = br.readLine()) != null) {    sb.append(line);}String str = sb.toString();return str;</code></pre><h5 id="方法七："><a href="#方法七：" class="headerlink" title="方法七："></a>方法七：</h5><pre><code>ByteArrayOutputStream result = new ByteArrayOutputStream();byte[] buffer = new byte[inStream.available()];int length;while ((length = inputStream.read(buffer)) != -1) {    result.write(buffer, 0, length);}String str = result.toString(StandardCharsets.UTF_8.name());return str;</code></pre><h5 id="方法八："><a href="#方法八：" class="headerlink" title="方法八："></a>方法八：</h5><pre><code>BufferedInputStream bis = new BufferedInputStream(inputStream);ByteArrayOutputStream buf = new ByteArrayOutputStream();int result = bis.read();while(result != -1) {    buf.write((byte) result);    result = bis.read();}String str = buf.toString();return str;</code></pre><h4 id="1-2-Apache-Common提供"><a href="#1-2-Apache-Common提供" class="headerlink" title="1.2  Apache Common提供"></a>1.2  Apache Common提供</h4><h5 id="方法九："><a href="#方法九：" class="headerlink" title="方法九："></a>方法九：</h5><pre><code>StringWriter writer = new StringWriter();IOUtils.copy(inputStream, writer, StandardCharsets.UTF_8.name());String str = writer.toString();</code></pre><h5 id="方法十："><a href="#方法十：" class="headerlink" title="方法十："></a>方法十：</h5><pre><code>String str = IOUtils.toString(inputStream, &quot;utf-8&quot;);</code></pre><h4 id="1-3-Google-Guava提供"><a href="#1-3-Google-Guava提供" class="headerlink" title="1.3  Google Guava提供"></a>1.3  Google Guava提供</h4><h5 id="方法十一："><a href="#方法十一：" class="headerlink" title="方法十一："></a>方法十一：</h5><pre><code>String str = CharStreams.toString(new InputStreamReader(inputStream, StandardCharsets.UTF_8));</code></pre><h5 id="方法十二："><a href="#方法十二：" class="headerlink" title="方法十二："></a>方法十二：</h5><pre><code>String str = new String(ByteStreams.toByteArray(inputStream));</code></pre><h3 id="2、String转化为InputStream"><a href="#2、String转化为InputStream" class="headerlink" title="2、String转化为InputStream"></a>2、String转化为InputStream</h3><h4 id="2-1-JDK原生提供"><a href="#2-1-JDK原生提供" class="headerlink" title="2.1 JDK原生提供"></a>2.1 JDK原生提供</h4><pre><code>InputStream is = new ByteArrayInputStream(str.getBytes());</code></pre><h4 id="2-2-Apache-Common提供"><a href="#2-2-Apache-Common提供" class="headerlink" title="2.2 Apache Common提供"></a>2.2 Apache Common提供</h4><pre><code>InputStream targetStream = IOUtils.toInputStream(str, StandardCharsets.UTF_8.name());</code></pre><h4 id="2-3-Google-Guava提供"><a href="#2-3-Google-Guava提供" class="headerlink" title="2.3 Google Guava提供"></a>2.3 Google Guava提供</h4><pre><code>InputStream targetStream =        new ReaderInputStream(CharSource.wrap(str).openStream(), StandardCharsets.UTF_8.name());</code></pre>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> IO流 </tag>
            
            <tag> 转换 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟掌握Java对象和Map转换</title>
      <link href="/posts/b59ed7a2.html"/>
      <url>/posts/b59ed7a2.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟掌握Java对象和Map转换"><a href="#11分钟掌握Java对象和Map转换" class="headerlink" title="11分钟掌握Java对象和Map转换"></a>11分钟掌握Java对象和Map转换</h2><blockquote><p><code>或许前路永夜，即便如此我也要前进，因为星光即使微弱也会为我照亮前路</code></p></blockquote><hr><h3 id="1-将Javabean对象装换为map"><a href="#1-将Javabean对象装换为map" class="headerlink" title="1. 将Javabean对象装换为map"></a>1. 将Javabean对象装换为map</h3><pre class=" language-java"><code class="language-java">        <span class="token comment" spellcheck="true">/**         * @param bean         * @return         */</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">></span> <span class="token function">beanToMap</span><span class="token punctuation">(</span>T bean<span class="token punctuation">)</span> <span class="token punctuation">{</span>            Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">></span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">newHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                BeanMap beanMap <span class="token operator">=</span> BeanMap<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>bean<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>Object key <span class="token operator">:</span> beanMap<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">,</span> beanMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token keyword">return</span> map<span class="token punctuation">;</span>        <span class="token punctuation">}</span></code></pre><h3 id="2-将map装换为Javabean对象"><a href="#2-将map装换为Javabean对象" class="headerlink" title="2.将map装换为Javabean对象"></a>2.将map装换为Javabean对象</h3><pre class=" language-java"><code class="language-java">        <span class="token comment" spellcheck="true">/**         * @param map         * @param bean         * @return         */</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> T <span class="token function">mapToBean</span><span class="token punctuation">(</span>Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">></span> map<span class="token punctuation">,</span> T bean<span class="token punctuation">)</span> <span class="token punctuation">{</span>            BeanMap beanMap <span class="token operator">=</span> BeanMap<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>bean<span class="token punctuation">)</span><span class="token punctuation">;</span>            beanMap<span class="token punctuation">.</span><span class="token function">putAll</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> bean<span class="token punctuation">;</span>        <span class="token punctuation">}</span></code></pre><h3 id="3-将List转换为List-lt-Map-lt-String-Object-gt-gt"><a href="#3-将List转换为List-lt-Map-lt-String-Object-gt-gt" class="headerlink" title="3.将List转换为List&lt;Map&lt;String, Object&gt;&gt;"></a>3.将List<T>转换为List&lt;Map&lt;String, Object&gt;&gt;</h3><pre class=" language-java"><code class="language-java">        <span class="token comment" spellcheck="true">/**         * @param objList         * @return         * @throws JsonGenerationException         * @throws JsonMappingException         * @throws IOException         */</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> List<span class="token operator">&lt;</span>Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">>></span> <span class="token function">objectsToMaps</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>T<span class="token operator">></span> objList<span class="token punctuation">)</span> <span class="token punctuation">{</span>            List<span class="token operator">&lt;</span>Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">>></span> list <span class="token operator">=</span> Lists<span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>objList <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> objList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">></span> map <span class="token operator">=</span> null<span class="token punctuation">;</span>                T bean <span class="token operator">=</span> null<span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> size <span class="token operator">=</span> objList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    bean <span class="token operator">=</span> objList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                    map <span class="token operator">=</span> <span class="token function">beanToMap</span><span class="token punctuation">(</span>bean<span class="token punctuation">)</span><span class="token punctuation">;</span>                    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token keyword">return</span> list<span class="token punctuation">;</span>        <span class="token punctuation">}</span></code></pre><h3 id="4-将List-lt-Map-lt-String-Object-gt-gt-转换为List"><a href="#4-将List-lt-Map-lt-String-Object-gt-gt-转换为List" class="headerlink" title="4. 将List&lt;Map&lt;String,Object&gt;&gt;转换为List"></a>4. 将List&lt;Map&lt;String,Object&gt;&gt;转换为List<T></h3><pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**         * @param maps         * @param clazz         * @return         * @throws InstantiationException         * @throws IllegalAccessException       */</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> List<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">mapsToObjects</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">>></span> maps<span class="token punctuation">,</span> Class<span class="token operator">&lt;</span>T<span class="token operator">></span> clazz<span class="token punctuation">)</span>                <span class="token keyword">throws</span> InstantiationException<span class="token punctuation">,</span> IllegalAccessException <span class="token punctuation">{</span>            List<span class="token operator">&lt;</span>T<span class="token operator">></span> list <span class="token operator">=</span> Lists<span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>maps <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> maps<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">></span> map <span class="token operator">=</span> null<span class="token punctuation">;</span>                T bean <span class="token operator">=</span> null<span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> size <span class="token operator">=</span> maps<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    map <span class="token operator">=</span> maps<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                    bean <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token function">mapToBean</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span>                    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>bean<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token keyword">return</span> list<span class="token punctuation">;</span>        <span class="token punctuation">}</span></code></pre><p>…</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Map </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟学习Java的五种json库及操作</title>
      <link href="/posts/d5737b81.html"/>
      <url>/posts/d5737b81.html</url>
      
        <content type="html"><![CDATA[<hr><h2 id="11分钟学习Java的五种json库及操作"><a href="#11分钟学习Java的五种json库及操作" class="headerlink" title="11分钟学习Java的五种json库及操作"></a>11分钟学习Java的五种json库及操作</h2><blockquote><p><code>你的所言所行，全都闪烁着光芒，太过刺目，于是我闭上双眼，但内心还是无法停止对你的憧憬</code></p></blockquote><hr><p>​    Java 中json格式的字符串写法 </p><pre><code>String paramess=&quot;{\&quot;name\&quot;:\&quot;Mahesh\&quot;,\&quot;password\&quot;:21}&quot;;</code></pre><h3 id="1-json-lib"><a href="#1-json-lib" class="headerlink" title="1. json-lib"></a>1. json-lib</h3><blockquote><p>json-lib具有通用性，但是比较麻烦，且时间有些久远，jar包只更新到2010年</p><p>项目地址：<a href="http://json-lib.sourceforge.net/index.html" target="_blank" rel="noopener">http://json-lib.sourceforge.net/index.html</a></p></blockquote><h5 id="1-1-maven依赖"><a href="#1-1-maven依赖" class="headerlink" title="1.1 maven依赖"></a>1.1 maven依赖</h5><pre><code>&lt;dependency&gt;    &lt;groupId&gt;net.sf.json-lib&lt;/groupId&gt;    &lt;artifactId&gt;json-lib&lt;/artifactId&gt;    &lt;version&gt;2.4&lt;/version&gt;    &lt;classifier&gt;jdk15&lt;/classifier&gt;//jar包区分jdk1.3和jdk1.5版本&lt;/dependency&gt;</code></pre><h5 id="1-2-具体操作"><a href="#1-2-具体操作" class="headerlink" title="1.2 具体操作"></a>1.2 具体操作</h5><ul><li><p>1.2.1 JSONObject与String相互转换</p><pre><code>  JSONObject jsonobject= JSONObject.fromObject(str);  String str = JSONObject.toString</code></pre></li><li><p>1.2.2 获取JSONObject数据及遍历JSONArray</p><p>  String str = JSONObject.getInt(“keys”)<br>  String str = JSONObject.getString(“keys”)<br>  JSONArray = JSONObject.getJSONArray(String);</p></li><li><p>遍历：</p><pre><code>  for(i&lt;JSONArray.size())  {     JSONObject = JSONArray.getJSONObject(i);      JSONObject.getInt()...  }  Iterator&lt;String&gt; iterator = JSONObject.keys();     while(iterator.hasNext()){      String keys = iterator.next();  }</code></pre></li><li><p>1.2.2 JSONObject转对象</p><pre><code>  Grade grade = (Grade)JSONObject.toBean(jsonObject,Grade.class);</code></pre></li></ul><h3 id="2-org-json"><a href="#2-org-json" class="headerlink" title="2.org.json"></a>2.org.json</h3><blockquote><p>与json-lib相类似</p></blockquote><h5 id="2-1maven依赖"><a href="#2-1maven依赖" class="headerlink" title="2.1maven依赖"></a>2.1maven依赖</h5><pre><code>    &lt;dependency&gt;          &lt;groupId&gt;org.json&lt;/groupId&gt;          &lt;artifactId&gt;json&lt;/artifactId&gt;          &lt;version&gt;20170516&lt;/version&gt;    &lt;/dependency&gt;</code></pre><h5 id="2-2-创建json对象"><a href="#2-2-创建json对象" class="headerlink" title="2.2 创建json对象"></a>2.2 创建json对象</h5><pre><code>    JSONObject = new JSONObject(str);</code></pre><h5 id="2-3-操作"><a href="#2-3-操作" class="headerlink" title="2.3 操作"></a>2.3 操作</h5><pre><code>net.sf.json.JSONObject： 没有严格要求获取字段的类型跟getXXX()的类型一样org.json.JSONObject：获取的字段类型必须跟getXXX()的类型一样</code></pre><h5 id="2-4-JSONArray-length"><a href="#2-4-JSONArray-length" class="headerlink" title="2.4 JSONArray.length()"></a>2.4 JSONArray.length()</h5><h3 id="3-jackSon"><a href="#3-jackSon" class="headerlink" title="3. jackSon"></a>3. jackSon</h3><blockquote><p>springMVC内置解析器就是jackson </p><p>项目地址：<a href="https://github.com/FasterXML/jackson" target="_blank" rel="noopener">https://github.com/FasterXML/jackson</a></p></blockquote><h5 id="3-1-maven依赖"><a href="#3-1-maven依赖" class="headerlink" title="3.1 maven依赖"></a>3.1 maven依赖</h5><pre><code>    &lt;dependency&gt;          &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;          &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;          &lt;version&gt;2.9.0&lt;/version&gt;    &lt;/dependency&gt;</code></pre><h5 id="3-2-对象和String之间的转换"><a href="#3-2-对象和String之间的转换" class="headerlink" title="3.2 对象和String之间的转换"></a>3.2 对象和String之间的转换</h5><pre><code>    ObjectMapper mapper=new ObjectMapper();    //json转对象    Grade grade=mapper.readValue(json1, Grade.class);    //对象转json    mapper.writeValueAsString(grade);</code></pre><h5 id="3-3-对JsonNode的遍历"><a href="#3-3-对JsonNode的遍历" class="headerlink" title="3.3 对JsonNode的遍历"></a>3.3 对JsonNode的遍历</h5><pre><code>    JsonNode jsonNode = mapper.readTree(jsonStr);    Iterator&lt;String&gt; keys = jsonNode.fieldNames();    while(keys.hasNext()){        String fieldName = keys.next();        System.out.println(fieldName + &quot; : &quot; + jsonNode.path(fieldName).toString());    }</code></pre><h3 id="4-fastjson"><a href="#4-fastjson" class="headerlink" title="4. fastjson"></a>4. fastjson</h3><blockquote><p>阿里巴巴开源框架，效率最高</p><p>项目地址：<a href="https://github.com/alibaba/fastjson" target="_blank" rel="noopener">https://github.com/alibaba/fastjson</a></p></blockquote><h5 id="4-1-maven依赖"><a href="#4-1-maven依赖" class="headerlink" title="4.1 maven依赖"></a>4.1 maven依赖</h5><pre><code>    &lt;dependency&gt;          &lt;groupId&gt;com.alibaba&lt;/groupId&gt;          &lt;artifactId&gt;fastjson&lt;/artifactId&gt;          &lt;version&gt;1.2.37&lt;/version&gt;    &lt;/dependency&gt;</code></pre><h5 id="4-2-String转对象"><a href="#4-2-String转对象" class="headerlink" title="4.2 String转对象"></a>4.2 String转对象</h5><pre><code>    Student stu = JSON.parseObject(json,Student.class);    List&lt;String&gt; list=JSON.parseArray(json2, String.class);</code></pre><h5 id="4-3-对象转String"><a href="#4-3-对象转String" class="headerlink" title="4.3 对象转String"></a>4.3 对象转String</h5><pre><code>    JSON.toJSONString(stu);    //or String json = JSON.toJSON(stu).toString();</code></pre><h3 id="5-GSON"><a href="#5-GSON" class="headerlink" title="5.GSON"></a>5.GSON</h3><blockquote><p>谷歌产品 ，前功能最全</p><p>项目地址：<a href="https://github.com/google/gson" target="_blank" rel="noopener">https://github.com/google/gson</a></p></blockquote><h5 id="5-1-maven依赖"><a href="#5-1-maven依赖" class="headerlink" title="5.1 maven依赖"></a>5.1 maven依赖</h5><pre><code>    &lt;dependency&gt;          &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;          &lt;artifactId&gt;gson&lt;/artifactId&gt;          &lt;version&gt;2.8.1&lt;/version&gt;    &lt;/dependency&gt;</code></pre><h5 id="5-2-String转对象"><a href="#5-2-String转对象" class="headerlink" title="5.2 String转对象"></a>5.2 String转对象</h5><pre><code>    Gson gson = new Gson();    Grade grade = gson.fromJson(json1,Grade.class);    ArrayList&lt;String&gt; list=gson.fromJson(json2,new TypeToken&lt;ArrayList&lt;String&gt;&gt;(){}.getType());</code></pre><h5 id="5-3-对象转String"><a href="#5-3-对象转String" class="headerlink" title="5.3 对象转String"></a>5.3 对象转String</h5><pre><code>    String json=gson.toJson(grade);</code></pre>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> json </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟详解Redis的常用命令类型和配置</title>
      <link href="/posts/6996938c.html"/>
      <url>/posts/6996938c.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟详解Redis的常用命令类型和配置"><a href="#11分钟详解Redis的常用命令类型和配置" class="headerlink" title="11分钟详解Redis的常用命令类型和配置"></a>11分钟详解Redis的常用命令类型和配置</h2><blockquote><p><code>苦恼着，歇斯底里着，痛苦着，不断挣扎的数月时间，这一切会在未来的某一瞬间得到回报。我们或许就是被那个瞬间迷住的，一种无可救药的生物吧</code></p></blockquote><h3 id="一、数据类型"><a href="#一、数据类型" class="headerlink" title="一、数据类型"></a>一、数据类型</h3><h4 id="key"><a href="#key" class="headerlink" title="key"></a>key</h4><pre><code>keys* 查看当前库全部keysexists key 判断某个key是否存在move key db 移动当前库的key到别的库expire key 秒钟  设置给定的key设置过期时间ttl key 查看剩余多少秒过期，-1表示永不过期，-2表示已过期type key 查看你的key是什么类型</code></pre><h4 id="String"><a href="#String" class="headerlink" title="String"></a>String</h4><pre><code>set/get/del/append/strlen 设置/获取/删除/在值后追加/值的长度Incr/decr/incrby/decrby，加/减/加多少/减多少 必须为数字getrange/setrange 获取值的范围/设置范围的值为什么setex（set with expire）键秒值/setnx（set if not exist）[key] [time] [value] 设置带有效期的键值对/不存在同名键时添加mset/mget/msetnx 同时多个键值对 设置/添加/不存在添加（只要一个存在都不执行）</code></pre><h4 id="List"><a href="#List" class="headerlink" title="List"></a>List</h4><pre><code>lpush/rpush/lrange 左边入栈/右边入栈/获取范围的值（0 -1 为获取全部）lpop/rpop 尾部出栈/头部出栈lindex 按照索引下标获得元素（从上到下）llen 获取list值长度lrem key n value 删N个值Itrim key 开始index 结束index  截取指定范围的值后再赋值给key rpoplpush 源key 目的key  从源list的头部出栈一位到目的list左边入栈lset key index value 设置索引位的值linsert key before/after 值1 值2  在某个值前或后插入值</code></pre><h4 id="set"><a href="#set" class="headerlink" title="set"></a>set</h4><blockquote><p>zset 和 set 基本一样，不同的是zset 都会关联一个double类型的-score(分数)</p></blockquote><pre><code>sadd/smembers/sismember 添加/查询所有/查询是否存在scard 获取集合里元素个数srem key value 删除集合中元素srandmember key [n]  随机出n个数spop key 随机出栈smove key1 key2    将key1里的某个值移动到key2sdiff/sinter/sunion key1 key2    比较两key的差值/交集/并集</code></pre><h4 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h4><pre><code>hset/hget/hmset/hmget/hgetall/hdel 插入/获取/多插入/多获取/获取全部/删除hlen 获取长度hexists key  在key里面的某个值判断key是否存在hkeys/hvals  获取全部key/获取全部valuehincrby/hincrbyfloat [n] 增加n值hsetnx 插入（不存在时）</code></pre><h3 id="二、常见配置redis-conf介绍"><a href="#二、常见配置redis-conf介绍" class="headerlink" title="二、常见配置redis.conf介绍"></a>二、常见配置redis.conf介绍</h3><pre><code>redis.conf 配置项说明如下：    1.Redis默认不是以守护进程的方式运行，可以通过该配置项修改，使用yes启用守护进程         daemonize no    2.当Redis以守护进程方式运行时，Redis默认会把pid写入/var/run/redis.pid文件，可以通过pidfile指定        pidfile/var/run/redis.pid    3.指定Redis监听端口，默认端口为6379，作者在自己的一篇博文中解释了为什么选用6379作为默认端口，因为6379在手机按键上MERZ对应的号码，而MERZ取自意大利歌女Alessia Merz的名字        port 6379    4.绑定的主机地址        bind 127.0.0.1    5.当客户端闲置多长时间后关闭连接，如果指定为0，表示关闭该功能        timeout 300    6.指定日志记录级别，Redis总共支持四个级别：debug、verbose、notice、warning，默认为verbose         loglevel verbose    7.日志记录方式，默认为标准输出，如果配置Redis为守护进程方式运行，而这里又配置为日志记录方式为标准输出，则日志将会发送给/dev/null         logfile stdout    8.设置数据库的数量，默认数据库为0，可以使用SELECT&lt;dbid&gt;命令在连接上指定数据库id         databases 16    9.指定在多长时间内，有多少次更新操作，就将数据同步到数据文件，可以多个条件配合        save &lt;seconds&gt;&lt;changes&gt;    Redis默认配置文件中提供了三个条件：        save 9001        save 30010        save 6010000分别表示900秒（15分钟）内有1个更改，300秒（5分钟）内有10个更改以及60秒内有10000个更改。    10.指定存储至本地数据库时是否压缩数据，默认为yes，Redis采用LZF压缩，如果为了节省CPU时间，可以关闭该选项，但会导致数据库文件变的巨大        rdbcompression yes    11.指定本地数据库文件名，默认值为dump.rdb         dbfilename dump.rdb    12.指定本地数据库存放目录        dir./    13.设置当本机为lav服务时，设置master服务的IP地址及端口，在Redis启动时，它会自动从master进行数据同步        slaveof &lt;masterip&gt;&lt;masterport&gt;    14.当master服务设置了密码保护时，slav服务连接master的密码        masterauth &lt;master-password&gt;    15.设置Redis连接密码，如果配置了连接密码，客户端在连接Redis时需要通过AUTH &lt;password&gt;命令提供密码，默认关闭        requirepass foobared    16.设置同一时间最大客户端连接数，默认无限制，Redis可以同时打开的客户端连接数为Redis进程可以打开的最大文件描述符数，如果设置maxclients0，表示不作限制。当客户端连接数到达限制时，Redis会关闭新的连接并向客户端返回max number of clients reached错误信息maxclients 12817.指定Redis最大内存限制，Redis在启动时会把数据加载到内存中，达到最大内存后，Redis会先尝试清除已到期或即将到期的Key，当此方法处理后，仍然到达最大内存设置，将无法再进行写入操作，但仍然可以进行读取操作。Reds新的vm机制，会把Key存放内存，Value会存放在swap区        maxmemory&lt;bytes&gt;    18.指定是否在每次更新操作后进行日志记录，Redis在默认情况下是异步的把数据写入磁盘，如果不开启，可能会在断电时导致一段时间内的数据丢失。因为redis本身同步数据文件是按上面save条件来同步的，所以有的数据会在一段时间内只存在于内存中。默认为no         appendonly no    19.指定更新日志文件名，默认为appendonly.aof         appendfilename appendonly.aof    20.指定更新日志条件，共有3个可选值：        no：表示等操作系统进行数据缓存同步到磁盘（快）        always：表示每次更新操作后手动调用fsync（）将数据写到磁盘（慢，安全）        everysec：表示每秒同步一次（折衷，默认值）    21.指定是否启用虚拟内存机制，默认值为no，简单的介绍一下，VM机制将数据分页存放，由Redis将访问量较少的页即冷数据swap到磁盘上，访问多的页面由磁盘自动换出到内存中（在后面的文章我会仔细分析Redis的VM机制）        vm-enabled no    22.虚拟内存文件路径，默认值为/tmp/redis.swap，不可多个Redis实例共享        vm-swap-file/tmp/redis.swap    23.将所有大于vm-max-memory的数据存入虚拟内存，无论vm-max-memory设置多小，所有索引数据都是内存存储的（Redis的索引数据就是keys），也就是说，当vm-max-memory设置为0的时候，其实是所有value都存在于磁盘。默认值为0        vm-max-memory 0    24.Redis swap文件分成了很多的page，一个对象可以保存在多个page上面，但一个page上不能被多个对象共享，vm-page-size是要根据存储的数据大小来设定的，作者建议如果存储很多小对象，page大小最好设置为32或者64bytes；如果存储很大大对象，则可以使用更大的page，如果不确定，就使用默认值        vm-page-size 32    25.设置swap文件中的page数重，由于页表（一种表示页面空闲或使用的bitmap）是在放在内存中的，，在磁盘上每8个pages将消耗1byte的内存。        vm-pages 134217728    26.设置访间swap文件的线程数，最好不要超过机器的核数，如果设置为0，那么所有对swap文件的操作都是串行的，可能会造成比较长时间的延迟。默认值为4        vm-max-threads 4    27.设置在向客户端应答时，是否把较小的包合并为一个包发送，默认为开启        glueoutputbuf yes    28.指定在超过一定的数量或者最大的元素超过某一临界值时，采用一种特殊的哈希算法        hash-max-zipmap-entries64        hash-max-zipmap-value 512    29.指定是否激活重置哈希，默认为开启（后面在介绍Redis的哈希算法时具体介绍）        activerehashing yes    30.指定包含其它的配置文件，可以在同一主机上多个Redis实例之间使用同一份配置文件，而同时各个实例又拥有自己的特定配置文件        include/path/to/local.conf</code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> 配置 </tag>
            
            <tag> 命令类型 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟了解Redis简介及使用场景</title>
      <link href="/posts/fc9ec3a7.html"/>
      <url>/posts/fc9ec3a7.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟了解Redis简介及使用场景"><a href="#11分钟了解Redis简介及使用场景" class="headerlink" title="11分钟了解Redis简介及使用场景"></a>11分钟了解Redis简介及使用场景</h2><blockquote><p><code>星星在你的头顶上闪耀着，与你交互诉说的话语，一句一句地，如同星点般翩然落至眼前</code></p></blockquote><h3 id="一、Redis简介"><a href="#一、Redis简介" class="headerlink" title="一、Redis简介"></a>一、Redis简介</h3><p>​    Redis 是完全开源免费的，遵守BSD协议，是一个高性能的<code>key-value</code>型数据库。</p><h3 id="二、window下的安装"><a href="#二、window下的安装" class="headerlink" title="二、window下的安装"></a>二、window下的安装</h3><blockquote><p>redis 64位下载地址：<a href="https://github.com/ServiceStack/redis-windows" target="_blank" rel="noopener">https://github.com/ServiceStack/redis-windows</a></p></blockquote><p>1.修改redis.windows.conf文件</p><pre><code>    maxmemory 1024*1024*1024</code></pre><p>2.启动redis</p><pre><code>    redis-server.exe redis.windows.conf</code></pre><p>3.将redis加入到windows的服务中</p><pre><code>    redis-server.exe --service-install redis.windows.conf --loglevel verbose</code></pre><p>4.常用的redis服务命令。</p><pre><code>卸载服务：redis-server --service-uninstall开启服务：redis-server --service-start停止服务：redis-server --service-stop重命名服务：redis-server --service-name name</code></pre><p>5.连接服务器</p><pre><code>redis-cli.exe</code></pre><h3 id="三、linix下的安装"><a href="#三、linix下的安装" class="headerlink" title="三、linix下的安装"></a>三、linix下的安装</h3><ol><li>安装<pre><code>$ wget http://download.redis.io/releases/redis-2.8.17.tar.gz$ tar xzf redis-2.8.17.tar.gz$ cd redis-2.8.17$ make</code></pre></li><li>启动服务</li></ol><ul><li><p>默认启动</p><pre><code>$ cd src$ ./redis-server</code></pre></li><li><p>使用指定配置文件启动</p><pre><code>$ cd src$ ./redis-server ../redis.conf</code></pre></li></ul><h3 id="四、redis使用场景"><a href="#四、redis使用场景" class="headerlink" title="四、redis使用场景"></a>四、redis使用场景</h3><blockquote><p>参考<a href="https://blog.csdn.net/Bobdragery/article/details/99711762" target="_blank" rel="noopener"> redis使用场景及案例</a></p></blockquote><h4 id="一、缓存"><a href="#一、缓存" class="headerlink" title="一、缓存"></a>一、缓存</h4><p>项目场景：用户登录或注册时的验证码存储，用户名</p><pre><code>set Code:1:code 1232 EX 100 NXget Code:1:code     # 1232set User:1:name bob EX 100 NXget User:1:name         # bob</code></pre><p>缓存是 redis 出镜率最高的一种使用场景，仅仅使用 set/get 就可以实现，不过也有一些需要考虑的点<br>1、如何更好的设置缓存<br>2、如何保持缓存与上游数据的一致性<br>3、如何解决缓存雪崩，缓存击穿问题（这两个问题会单独写一篇）</p><h4 id="二：消息队列"><a href="#二：消息队列" class="headerlink" title="二：消息队列"></a>二：消息队列</h4><pre><code>lpush UserEmailQueue 1 2 3 4lpop UserEmailQueuerpop UserEmailQueue 1rpop UserEmailQueue 2</code></pre><p>可以把redis的队列看为分布式队列，作为消息队列时，生产者在一头塞入数据。消费者另一条取出数据:(lpush/rpop,rpush/lpop),不过也有一些不足，而这些不足有可能是致命的，不过对于一些丢几条消息也没关系的场景还是可以考虑的:<br>1、没有ack(消息确认机制)，有可能丢消息<br>2、需要做redis的持久化配置</p><h4 id="三：过滤器-dupefilter"><a href="#三：过滤器-dupefilter" class="headerlink" title="三：过滤器(dupefilter)"></a>三：过滤器(dupefilter)</h4><pre><code>sadd UrlSet http://1sadd UrlSet http://2sadd UrlSet http://2smembers UrlSet“http://1”“http://2”scrapy-redis作为分布式的爬虫框架，便是使用了 redis 的 Set 这个数据结构来对将要爬取的 url 进行去重处理。</code></pre><pre><code>def request_seen(self, request):    &quot;&quot;&quot;Returns True if request was already seen.   Parameters   -------request : scrapy.http.Request    Returns    ------- bool     &quot;&quot;&quot;     fp = self.request_fingerprint(request)     added = self.server.sadd(self.key, fp)     return added == 0不过当 url 过多时，会有内存占用过大的问题</code></pre><h4 id="四、分布式锁"><a href="#四、分布式锁" class="headerlink" title="四、分布式锁"></a>四、分布式锁</h4><p>分布式锁，这个是除了 KV 缓存之外最为常用的另一个特色功能。</p><pre><code>set Lock:User:10086 06be97fc-f258-4202-b60b-8d5412dd5605 EX 60 NX#释放锁，一段 LUA 脚本if redis.call(&quot;get&quot;,KEYS[1]) == ARGV[1] then      return redis.call(&quot;del&quot;,KEYS[1])else     return 0end</code></pre><p>这是一个最简单的单机版的分布式锁，有以下要点<br>1）EX 表示锁会过期释放<br>2）NX 保证原子性<br>解锁时对比资源对应产生的 UUID，避免误解锁<br>当你使用分布式锁是为了解决一些性能问题，如分布式定时任务防止执行多次 (做好幂等性)，而且鉴于单点 redis 挂掉的可能性很小，可以使用这种单机版的分布式锁。</p><p>举个例子说明：<br>比如一个很能干的资深工程师，开发效率很快，代码质量也很高，是团队里的明星。所以呢诸多产品经理都要来烦他，让他给自己做需求。如果同一时间来了一堆产品经理都找他，它的思路呢就会陷入混乱，再优秀的程序员，大脑的并发能力也好不到哪里去。所以呢他就在自己的办公室的门把上挂了一个请勿打扰的牌子，当一个产品经理来的时候先看看门把上有没有这个牌子，如果没有呢就可以进来找工程师谈需求，谈之前要把牌子挂起来，谈完了再把牌子摘了。这样其它产品经理也要来烦他的时候，如果看见这个牌子挂在那里，就可以选择睡觉等待或者是先去忙别的事。如是这位明星工程师从此获得了安宁。</p><p>一定要设置这个过期时间，因为遇到特殊情况 —— 比如地震（进程被 kill -9，或者机器宕机），产品经理可能会选择从窗户上跳下去，没机会摘牌，导致了死锁饥饿，让这位优秀的工程师成了一位大闲人，造成严重的资源浪费。同时还需要注意这个 owner_id，它代表锁是谁加的 —— 产品经理的工号。以免你的锁不小心被别人摘掉了。释放锁时要匹配这个 owner_id，匹配成功了才能释放锁。这个 owner_id 通常是一个随机数，存放在 ThreadLocal 变量里（栈变量）。官方其实并不推荐这种方式，因为它在集群模式下会产生锁丢失的问题 —— 在主从发生切换的时候。官方推荐的分布式锁叫 RedLock，作者认为这个算法较为安全，推荐我们使用。不过我们一直还使用上面最简单的分布式锁。为什么我们不去使用 RedLock 呢，因为它的运维成本会高一些，需要 3 台以上独立的 Redis 实例，用起来要繁琐一些。另外，Redis 集群发生主从切换的概率也并不高，即使发生了主从切换出现锁丢失的概率也很低，因为主从切换往往都有一个过程，这个过程的时间通常会超过锁的过期时间，也就不会发生锁的异常丢失。还有呢就是分布式锁遇到锁冲突的机会也不多，这正如一个公司里明星程序员也比较有限一样，总是遇到锁排队那说明结构上需要优化。</p><h4 id="五：定时任务"><a href="#五：定时任务" class="headerlink" title="五：定时任务"></a>五：定时任务</h4><p>分布式定时任务有多种实现方式，最常见的一种是 master-workers 模型。<br>master 负责管理时间，到点了就将任务消息仍到消息中间件里，然后worker们负责监听这些消息队列来消费消息。<br>著名的 Python 定时任务框架 Celery 就是这么干的。但是 Celery 有一个问题，那就是 master 是单点的，如果这个 master 挂了，整个定时任务系统就停止工作了。</p><p><a href="https://imgchr.com/i/3AVW1U" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s2.ax1x.com/2020/02/18/3AVW1U.png" alt="3AVW1U.png"></a></p><p>另一种实现方式是 multi-master 模型。这个模型什么意思呢，就类似于 Java 里面的 Quartz 框架，采用数据库锁来控制任务并发。会有多个进程，每个进程都会管理时间，时间到了就使用数据库锁来争抢任务执行权，抢到的进程就获得了任务执行的机会，然后就开始执行任务，这样就解决了 master 的单点问题。</p><p>这种模型有一个缺点，那就是会造成竞争浪费问题，不过通常大多数业务系统的定时任务并没有那么多，所以这种竞争浪费并不严重。还有一个问题它依赖于分布式机器时间的一致性，如果多个机器上时间不一致就会造成任务被多次执行，这可以通过增加数据库锁的时间来缓解。</p><p><a href="https://imgchr.com/i/3AVnfK" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s2.ax1x.com/2020/02/18/3AVnfK.png" alt="3AVnfK.png"></a></p><p>现在有了 Redis 分布式锁，那么我们就可以在 Redis 之上实现一个简单的定时任务框架。</p><pre><code>#注册定时任务hset tasks name trigger_rule#获取定时任务列表hgetall tasks#争抢任务set lock:$(name) true nx ex=5#任务列表变空#轮询版本号，有变化就重新加载任务列表，重新调度时间有变化的任务set tasks_version $new_versionget tasks_version</code></pre><h4 id="六、频率控制"><a href="#六、频率控制" class="headerlink" title="六、频率控制"></a>六、频率控制</h4><p>项目的社区功能里，不可避免的总是会遇到垃圾内容，一觉醒来你会发现首页突然会被某些恶意的帖子和广告刷屏了，如果不采取适当的机制来控制就会导致用户体验受到严重的影响。</p><p>控制广告垃圾贴的策略很多，高级一点的可以通过AI，最简单的方式是通过关键词扫描，还有比较常用的一种方式是频率控制，限制单个用户内容的生产速度，不通等级的用户会有不同的频率控制参数。</p><p>频率控制就可以使用redis来实现，我们将用户的行为理解为一个时间序列，我们要保证在一定的时间内限制单个用户的时间序列的长度，超过这个长度就禁止用户的行为，它可以是用redis的zset(有序集合)来实现</p><p><a href="https://imgchr.com/i/3AEsJK" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s2.ax1x.com/2020/02/18/3AEsJK.png" alt="3AEsJK.png"></a></p><p>图中绿色的部门就是我们要保留的一个时间段的时间序列信息，灰色的段会被砍掉。统计绿色段中时间序列记录的个数就知道是否超过了频率的阈值。</p><pre><code>下面的代码控制用户的ugc行为为每小时最对N次hist_key:&quot;ugc:${user_id}&quot;with redis.pipeline() as pipe:#记录当前的行为pipe.zadd(hist_key,ts,uuid)#保留1小时内的行为序列pipe.zremrangebyscore(hist_key, 0, now_ts -3600)# 获取这1小时的行为数量pipe.zcard(hist_key)# 设置过期时间，节约内存pipe.expire(hist_key, 3600)# 批量执行_ , _ , count, _ =pipe.exec()return count &gt; N</code></pre><h4 id="七、服务发现"><a href="#七、服务发现" class="headerlink" title="七、服务发现"></a>七、服务发现</h4><p>如果想要技术成熟度再高一些，有的企业会有服务发现的基础设施。通常我们都会选用zookeeper、etcd，consul等分布式配置数据库来作为服务列表的存储。<br>它们有非常及时的通知机制来通知服务消费者服务列表发生了变更。那我们该如何使用 Redis 来做服务发现呢？</p><p><a href="https://imgchr.com/i/3AEurj" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s2.ax1x.com/2020/02/18/3AEurj.png" alt="3AEurj.png"></a></p><p>这里我们要再次使用 zset 数据结构，我们使用 zset 来保存单个服务列表。多个服务列表就使用多个 zset 来存储。<br>zset 的 value 和 score 分别存储服务的地址和心跳的时间。服务提供者需要使用心跳来汇报自己的存活，每隔几秒调用一次 zadd。服务提供者停止服务时，使用 zrem 来移除自己。</p><pre><code>zadd service_key heartbeat_ts addrzrem service_key addr</code></pre><p>这样还不够，因为服务有可能是异常终止，根本没机会执行钩子，所以需要使用一个额外的线程来清理服务列表中的过期项</p><pre><code>zremrangebyscore service_key 0 now_ts -30 # 30s都没来心跳</code></pre><p>接下来还有一个重要的问题是如何通知消费者服务列表发生了变更，这里我们同样使用版本号轮询机制，当服务列表变更时，递增版本号。消费者通过轮询版本号的变化来重加载服务列表</p><pre><code>if zadd() &gt;0 || zrem() &gt;0 ||zremrangebuscore() &gt;0:        incr service_version_key</code></pre><p>但是还有一个问题，如果消费者依赖了很多的服务列表，那么它就需要轮询很多的版本号，这样的IO效率会比较低下。</p><p>这是我们可以再增加一个全局版本号，在任意的服务类表版本号发生变化时，递增全局版本号；</p><p>这样在正常情况下消费者只需要轮询全局版本号就可以了。当全局版本号发生变更时再挨个对依赖的服务类表的子版本号，然后加载有变更的服务列表</p><p><a href="https://imgchr.com/i/3AA48U" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s2.ax1x.com/2020/02/18/3AA48U.png" alt="3AA48U.png"></a></p><h4 id="八、位图"><a href="#八、位图" class="headerlink" title="八、位图"></a>八、位图</h4><p>项目里需要做一个球队成员的签到系统，当用户量比较少的时候，设计上比较简单，就是将用户的签到状态用redis的hash结构来存储，签到一次就再hash结构里记录一条，签到有三种状态：未签到，已签到和部签到，分别是0，1，2三个整数值。</p><pre><code>hset sign:$(user_id) 2019-08-11 1hset sign:$(user_id) 2019-08-12 0hset sign:$(user_id) 2019-08-14 2</code></pre><p>这个其实非常浪费用户空间，后来想做全部用户的签到，技术leader指出，这时候的再用hash就有问题了，他讲到当用户过千万的时候，内存可能会飚到 30G+，我们线上实例通常过了 20G 就开始报警，30G 已经属于严重超标了。</p><p>这时候我们就开始着手解决这个问题，去优化存储。我们选择使用位图来记录签到信息，一个签到状态需要两个位来记录，一个月的存储空间只需要 8 个字节。这样就可以使用一个很短的字符串来存储用户一个月的签到记录。</p><p><a href="https://imgchr.com/i/3AAeBR" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s2.ax1x.com/2020/02/18/3AAeBR.png" alt="3AAeBR.png"></a></p><p>但是位图也有一个缺点，它的底层是字符串，字符串是连续存储空间，位图会自动扩展，比如一个很大的位图 8m 个位，只有最后一个位是 1，其它位都是零，这也会占用1m 的存储空间，这样的浪费非常严重。</p><p>所以呢就有了咆哮位图这个数据结构，它对大位图进行了分段存储，全位零的段可以不用存。</p><p>另外还对每个段设计了稀疏存储结构，如果这个段上置 1 的位不多，可以只存储它们的偏移量整数。这样位图的存储空间就得到了非常显著的压缩。</p><h4 id="九、-模糊计数"><a href="#九、-模糊计数" class="headerlink" title="九、 模糊计数"></a>九、 模糊计数</h4><p>上面提到的签到系统，如果产品经理需要知道这个签到的日活月活怎么办呢？<br>通常我们会直接甩锅——请找数据部门。</p><p>但是数据部门的数据往往不是很实时，经常前一天的数据需要第二天才能跑出来，离线计算是通常是定时的一天一次。那如何实现一个实时的活跃计数？</p><p>最简单的方案就是在 Redis 里面维护一个 set 集合，来一个用户，就 sadd 一下，最终集合的大小就是我们需要的 UV 数字。</p><p>但是这个空间浪费严重怎么办？这时候就需要使用redis提供的HyperLogLog模糊计数功能，它是一种概率计数，有一定的误差，大约是0.81%。</p><p>但是空间占用很小，其底层是一个位图，它最多只会占用12k的存储空间，而且在计数值比较小的时候，位图使用稀疏存储，空间占用就更小了。</p><pre><code>#记录用户pfadd sign_uv_${day} user_id#获取记录数量p count sign_uv_${day}</code></pre><p>微信公众号文章的阅读数可以使用它，网页的 UV 统计它都可以完成。但是如果产品经理非常在乎数字的准确性，比如某个统计需求和金钱直接挂钩，那么你可以考虑一下前面提到的咆哮位图。</p><p>它使用起来会复杂一些，需要提前将用户 ID 进行整数序列化。Redis 没有原生提供咆哮位图的功能，但是有一个开源的 Redis Module 可以拿来即用。</p><h4 id="十、布隆过滤器"><a href="#十、布隆过滤器" class="headerlink" title="十、布隆过滤器"></a>十、布隆过滤器</h4><p>如果系统即将会有大量的新用户涌入时，布隆过滤器就会非常有价值，可以显著降低缓存的穿透率，降低数据库的压力<br>这个新用户的涌入不一定是业务系统的大规模铺开，也可能是因为来自外部的缓存穿透攻击；</p><pre><code>def get_user_state(user_id):        state = cache.get(user_id)        if not state:            state = db.get(user_id) or{}            cache.set(user_id,state)        return statedef save_user_state(user_id,state):        cache.set(user_id,state)        db.set_async(user_id,state)</code></pre><p>比如就上面这个业务系统的用户状态查询接口代码，现在一个新用户过来，会先去缓存里查询有没有这个用户的状态数据<br>因为是新用户，所以肯定缓存里没有，然后它就要去数据库里查，结过数据库也没有，如果这样的新用户大批量瞬间涌入，那么可以遇见数据库的压力会比较大，会存在大量的空查询；</p><p>我们非常希望redis里面有这样一个set，它存放了所有的用户id，这样通过查询这个set集合就知道是不是新用户来了<br>当用户量非常庞大的时候，维护这样的一个集合需要的存储空间是很大的；</p><p>这时候就可以使用布隆过滤器，它相当于一个set，但是又不同于set，它需要的存储空间要小的多；</p><p>比如存储一个用户id需要64个字节，而布隆过滤器存储一个用户ID只需要1个字节多点，其实它存的不是用户id，而是用户id的指纹，所以会存在一定的小概率误判，它是一个具备模糊过滤能力的容器；</p><p>当它说用户 id 不在容器中时，那么就肯定不在。当它说用户 id 在容器里时，99% 的概率下它是正确的，还有 1% 的概率它产生了误判。</p><p><a href="https://imgchr.com/i/3AkEwt" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s2.ax1x.com/2020/02/18/3AkEwt.png" alt="3AkEwt.png"></a></p><p>不过在这个案例中，这个误判并不会产生问题，误判的代价只是缓存穿透而已。<br>相当于有 1% 的新用户没有得到布隆过滤器的保护直接穿透到数据库查询，而剩下的 99% 的新用户都可以被布隆过滤器有效的挡住，避免了缓存穿透</p><p><a href="https://imgchr.com/i/3AFurR" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s2.ax1x.com/2020/02/18/3AFurR.png" alt="3AFurR.png"></a></p><p>布隆过滤器的原理有一个很好的比喻，那就是在冬天一片白雪覆盖的地面上，如果你从上面走过，就会留下你的脚印。如果地面上有你的脚印，那么就可以大概率断定你来过这个地方，但是也不一定，也许别人的鞋正好和你穿的一模一样。可是如果地面上没有你的脚印，那么就可以 100% 断定你没来过这个地方。</p>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> 简介 </tag>
            
            <tag> 使用场景 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟理解Java反射</title>
      <link href="/posts/33aa4888.html"/>
      <url>/posts/33aa4888.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟理解Java反射"><a href="#11分钟理解Java反射" class="headerlink" title="11分钟理解Java反射"></a>11分钟理解Java反射</h2><blockquote><p> <code>星星在你的头顶上闪耀着，与你交互诉说的话语，一句一句地，如同星点般翩然落至眼前</code></p></blockquote><hr><h3 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h3><blockquote><p>  JAVA反射机制是在运行状态中.<br>对于任意一个类，都能够知道这个类的所有属性和方法；对于任意一个对象，都能够调用它的任意一个方法和属性.</p></blockquote><blockquote><p>我们创建的每一个类也都是对象，即类本身是java.lang.Class类的实例对象。这个实例对象称之为类对象，也就是Class对象,或者类类型。</p></blockquote><h3 id="二、方法："><a href="#二、方法：" class="headerlink" title="二、方法："></a>二、方法：</h3><h4 id="1-如何获取-Class文件对象"><a href="#1-如何获取-Class文件对象" class="headerlink" title="1.如何获取.Class文件对象"></a>1.如何获取.Class文件对象</h4><pre><code>a.  通过Object类 getClass()方法获取 Class对象b. 通过类名.class 方式 获取 Class对象c.  通过反射的方式, Class.forName(String classname) 获取Class对象public static Class&lt;?&gt; forName(String className)throws ClassNotFoundException返回与带有给定字符串名的类或接口相关联的 Class 对象</code></pre><h4 id="2-通过反射，获取类中的构造方法，并完成对象的创建"><a href="#2-通过反射，获取类中的构造方法，并完成对象的创建" class="headerlink" title="2.通过反射，获取类中的构造方法，并完成对象的创建"></a>2.通过反射，获取类中的构造方法，并完成对象的创建</h4><ul><li><p>获取指定的构造方法</p><p>  public Constructor<T> getConstructor(Class&lt;?&gt;… parameterTypes)</p></li><li><p>获取指定的public修饰的构造方法</p><p>  public Constructor<T> getDeclaredConstructor(Class&lt;?&gt;… parameterTypes)</p></li><li><p>获取指定的构造方法，包含私有的</p><p>  public Constructor<T> getConstructor(Class&lt;?&gt;… parameterTypes)</p></li><li><p>获取所有的构造方法</p><p>  public Constructor<?>[] getConstructors() 获取所有的public 修饰的构造方法  public Constructor<?>[] getDeclaredConstructors() 获取所有的构造方法，包含私有的</p></li></ul><h4 id="3-通过反射，-获取类中的构造方法，并完成对象的创建"><a href="#3-通过反射，-获取类中的构造方法，并完成对象的创建" class="headerlink" title="3.通过反射， 获取类中的构造方法，并完成对象的创建"></a>3.通过反射， 获取类中的构造方法，并完成对象的创建</h4><pre><code>步骤：a.获取字节码文件对象b.通过字节码文件对象 ，获取到指定的构造方法    getConstructor(参数);c.通过构造方法，创建对象    public T newInstance(Object... initargs)</code></pre><h4 id="4-私有构造方法，创建对象"><a href="#4-私有构造方法，创建对象" class="headerlink" title="4.私有构造方法，创建对象"></a>4.私有构造方法，创建对象</h4><pre><code>a.获取字节码文件对象b.通过字节码文件对象 ，获取到指定的构造方法    getDeclaredConstructor (参数);c.暴力访问     con.setAccessible(true);d.通过构造方法，创建对象     public T newInstance(Object... initargs)</code></pre><h4 id="5-通过反射，获取Class文件中的方法"><a href="#5-通过反射，获取Class文件中的方法" class="headerlink" title="5.通过反射，获取Class文件中的方法"></a>5.通过反射，获取Class文件中的方法</h4><ul><li><p>获取指定的方法</p><p>  public Method getMethod(String name, Class&lt;?&gt;… parameterTypes)</p></li><li><p>获取指定的public方法</p><p>  public Method getDeclaredMethod(String name, Class&lt;?&gt;… parameterTypes)</p></li><li><p>获取指定的任意方法，包含私有的</p><p>  获取所有的方法:<br>  public Method[] getMethods()</p><p>  获取本类与父类中所有public 修饰的方法:<br>  public Method[] getDeclaredMethods()获取本类中包含私有的所有的方法</p></li></ul><blockquote><p>// 数组表示：new Class[]{String.class, String.class}</p></blockquote><h4 id="6-通过反射，调用方法"><a href="#6-通过反射，调用方法" class="headerlink" title="6.通过反射，调用方法"></a>6.通过反射，调用方法</h4><pre><code>步骤：a.获取Class对象b.构造方法，创建对象c.取指定的public方法d.行方法public Object invoke(Object obj, Object... args)</code></pre><h4 id="7-私有方法的调用："><a href="#7-私有方法的调用：" class="headerlink" title="7.私有方法的调用："></a>7.私有方法的调用：</h4><pre><code>a，获取Class对象b,获取构造方法，创建对象c,获取指定的private方法d,开启暴力访问m5.setAccessible(true);e,执行方法public Object invoke(Object obj, Object... args)</code></pre><h4 id="8-通过反射，获取成员变量"><a href="#8-通过反射，获取成员变量" class="headerlink" title="8.通过反射，获取成员变量"></a>8.通过反射，获取成员变量</h4><ul><li><p>获取指定的成员变量</p><p>   public Field getField(String name) </p></li><li><p>获取public修饰的成员变量</p><p>  public Field getDeclaredField(String name)</p></li><li><p>获取任意的成员变量，包含私有</p><p>  public Field[] getFields() </p></li><li><p>获取所有public修饰的成员变量</p><p>  public Field[] getDeclaredFields()</p></li></ul><h4 id="9-通过反射，获取成员-变量，并赋值使用"><a href="#9-通过反射，获取成员-变量，并赋值使用" class="headerlink" title="9.通过反射，获取成员 变量，并赋值使用"></a>9.通过反射，获取成员 变量，并赋值使用</h4><pre><code>步骤：a. 获取字节码文件对象b. 获取构造方法，创建对象c. 获取指定的成员变量d. 对成员变量赋值获取值操作public void set(Object obj, Object value) // 赋值public Object get(Object obj) // 获取值</code></pre><h4 id="10-私有成员变量的使用"><a href="#10-私有成员变量的使用" class="headerlink" title="10.私有成员变量的使用"></a>10.私有成员变量的使用</h4><pre><code>步骤：a. 获取字节码文件对象b. 获取构造方法，创建对象c. 获取指定的成员变量d. 开启暴力访问e. 对成员变量赋值获取值操作public void set(Object obj, Object value) //赋值public Object get(Object obj) //获取值</code></pre>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> 反射 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟优化加速博客网站细节</title>
      <link href="/posts/489a4cf4.html"/>
      <url>/posts/489a4cf4.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟优化加速博客网站细节"><a href="#11分钟优化加速博客网站细节" class="headerlink" title="11分钟优化加速博客网站细节"></a>11分钟优化加速博客网站细节</h2><blockquote><p><code>莫扎特曾经说过大胆地踏上旅途吧，我不知道路途的前方究竟有什么，但是，我们还是迈出了步伐，我们仍在旅途之中</code></p></blockquote><hr><p>目前本人对前端 SEO 等也正处于探索和学习的阶段上，希望有任何问题和建议请留言哦~</p><h3 id="1-为什么要优化呢"><a href="#1-为什么要优化呢" class="headerlink" title="1. 为什么要优化呢?"></a>1. 为什么要优化呢?</h3><blockquote><p>​    当你打开一个网站时迟迟未能看见显示的页面的时候是不是很暴躁好没耐心呢，所以网站的优化对于开发者来说是不可少的工作呢。</p></blockquote><blockquote><p> 而可能大多数人和我一样，对于可以不用购买服务器，直接使用Hexo生成静态页面，使用<code>GitHub Pages</code>作为服务器，这样就可以搭建出自己博客了。</p><p>如何使用Hexo和GitHub搭建博客请参考我另外篇文章 &gt; <a href="https://blog.onfree.cn/qian-duan/c1595c80.html">基于Hexo和 hexo-theme-matery的个性化定制开发</a></p></blockquote><blockquote><p> 然而有个问题，<code>GitHub</code>的访问速度太慢了，对于我来说太暴躁了！所以就想寻找出更多的优化方法来解决这问题。</p></blockquote><h3 id="2-如何优化呢"><a href="#2-如何优化呢" class="headerlink" title="2.如何优化呢?"></a>2.如何优化呢?</h3><h4 id="1-更换搭建环境"><a href="#1-更换搭建环境" class="headerlink" title="1.更换搭建环境"></a>1.更换搭建环境</h4><p>不使用<code>GitHub</code>来搭建博客,而选择使用<code>Gitee</code>或者<code>coding</code>来搭建，当然有些人会觉得还是<code>GitHub</code>的习惯点呢；</p><h4 id="2-所有的类库使用CDN加速"><a href="#2-所有的类库使用CDN加速" class="headerlink" title="2. 所有的类库使用CDN加速"></a>2. 所有的类库使用CDN加速</h4><p>目前稳定且好的推荐如下：</p><ul><li><a href="http://www.jsdelivr.com/" target="_blank" rel="noopener">jsdelivr </a></li><li><a href="https://www.bootcdn.cn/" target="_blank" rel="noopener">bootcdn</a></li><li><a href="http://www.staticfile.org" target="_blank" rel="noopener">staticfile</a></li><li><a href="https://cdn.baomitu.com" target="_blank" rel="noopener">baomitu</a></li></ul><blockquote><p>使用方法就是像本地一样更换成线上的网址就行了</p><p>如：<code>&lt;script src=&quot;https://cdn.bootcss.com/aos/3.0.0-beta.6/aos.js&quot;&gt;&lt;/script&gt;</code></p></blockquote><h4 id="3-自定义Js、Css等文件加速"><a href="#3-自定义Js、Css等文件加速" class="headerlink" title="3.  自定义Js、Css等文件加速"></a>3.  自定义Js、Css等文件加速</h4><p>​    使用GitHub+<a href="http://www.jsdelivr.com/" target="_blank" rel="noopener">jsdelivr </a>的方式加速，jsdelivr 可以直接通过引用 Github 的资源，所有用来做CDN加速也不错;</p><p>使用方法：直接引用就行，如：<code>https://cdn.jsdelivr.net/gh/用户名/仓库名/文件</code>。</p><p>如我的用户名为：athink8 ; 仓库名：myGithub.；想引用的文件：/libs/others/clicklove.js</p><p>那引用链接为：</p><p><code>https://cdn.jsdelivr.net/gh</code>/</p><p>​    + <code>athink8/myGithub/libs/others/clicklove.js</code></p><blockquote><p>防坑指南：正常来说你需要GitHub打包才可以标识访问,虽然偷工减料，但是有时候会出现资源未更新的情况，</p><p>​    正确的做法是 加上<code>@latest</code> 这样就可以依然不打包使用最新提交的资源了。</p><p>​    如:<code>https://cdn.jsdelivr.net/gh/athink8/</code></p><p>​    + <code>myGithub@latest/libs/others/clicklove.js</code></p></blockquote><h4 id="4-图片资源处理"><a href="#4-图片资源处理" class="headerlink" title="4. 图片资源处理"></a>4. 图片资源处理</h4><p>​    图片一般都挺大的，为了加快访问速度当然需要做些变动才行呢。</p><p>​    尽量不使用本地图片，而改成使用线上<code>图床</code>。</p><p>​    什么是图床呢?图床一般是指储存图片的服务器。</p><p>​    图床推荐：</p><ul><li><a href="http://photo.weibo.com" target="_blank" rel="noopener">微博</a> : 免费、有损质量</li><li><a href="https://portal.qiniu.com" target="_blank" rel="noopener">七牛云</a>:10G免费空间，每月10G国内和10G国外流量，速度快</li><li><a href="https://www.upyun.com" target="_blank" rel="noopener">又拍云</a>: 注册认证后有10G免费空间，每月15G的HTTP和HTTPS流量,需加logo</li><li><a href="https://sm.ms" target="_blank" rel="noopener">SM.MS</a>：免费</li><li><a href="https://imgchr.com" target="_blank" rel="noopener">路过图床</a>：免费</li><li>阿里oss：收费、稳定</li><li>腾讯cos：新用户六个月的免费存储容量、免费请求和免费流量</li><li>GitHub+jsdelivr 搭建</li></ul><h4 id="5-代码压缩"><a href="#5-代码压缩" class="headerlink" title="5. 代码压缩"></a>5. 代码压缩</h4><p>精简代码可以有效的提高优化呢，如所说的类库也尽量使用带有min的版本。</p><p>手动压缩代码可以使用一些工具，如 <a href="http://tool.chinaz.com/js.aspx" target="_blank" rel="noopener">站长工具</a>、<a href="http://www.atoolbox.net/Tool.php?Id=664" target="_blank" rel="noopener">压缩工具箱</a>。</p><p>自动压缩的话，如果是使用hexo搭建博客的话可以使用gulp压缩代码，安装如下：</p><ol><li>进入站点根目录下执行下面的命令：</li></ol><pre><code># 全局安装gulp模块npm install gulp -g# 安装各种功能模块npm install gulp gulp-htmlclean gulp-htmlmin gulp-minify-css gulp-uglify gulp-imagemin --save# 安装额外功能模块npm install gulp-debug gulp-clean-css gulp-changed gulp-if gulp-plumber gulp-babel babel-preset-es2015 del @babel/core --save</code></pre><ol start="2"><li>在站点根目录新建文件 <code>gulpfile.js</code>，并复制以下内容</li></ol><pre><code>ar gulp = require(&quot;gulp&quot;);var debug = require(&quot;gulp-debug&quot;);var cleancss = require(&quot;gulp-clean-css&quot;); //css压缩组件var uglify = require(&quot;gulp-uglify&quot;); //js压缩组件var htmlmin = require(&quot;gulp-htmlmin&quot;); //html压缩组件var htmlclean = require(&quot;gulp-htmlclean&quot;); //html清理组件var imagemin = require(&quot;gulp-imagemin&quot;); //图片压缩组件var changed = require(&quot;gulp-changed&quot;); //文件更改校验组件var gulpif = require(&quot;gulp-if&quot;); //任务 帮助调用组件var plumber = require(&quot;gulp-plumber&quot;); //容错组件（发生错误不跳出任务，并报出错误内容）var isScriptAll = true; //是否处理所有文件，(true|处理所有文件)(false|只处理有更改的文件)var isDebug = true; //是否调试显示 编译通过的文件var gulpBabel = require(&quot;gulp-babel&quot;);var es2015Preset = require(&quot;babel-preset-es2015&quot;);var del = require(&quot;del&quot;);var Hexo = require(&quot;hexo&quot;);var hexo = new Hexo(process.cwd(), {}); // 初始化一个hexo对象// 清除public文件夹gulp.task(&quot;clean&quot;, function () {    return del([&quot;public/**/*&quot;]);});// 下面几个跟hexo有关的操作，主要通过hexo.call()去执行，注意return// 创建静态页面 （等同 hexo generate）gulp.task(&quot;generate&quot;, function () {    return hexo.init().then(function () {        return hexo            .call(&quot;generate&quot;, {                watch: false            })            .then(function () {                return hexo.exit();            })            .catch(function (err) {                return hexo.exit(err);            });    });});// 启动Hexo服务器gulp.task(&quot;server&quot;, function () {    return hexo        .init()        .then(function () {            return hexo.call(&quot;server&quot;, {});        })        .catch(function (err) {            console.log(err);        });});// 部署到服务器gulp.task(&quot;deploy&quot;, function () {    return hexo.init().then(function () {        return hexo            .call(&quot;deploy&quot;, {                watch: false            })            .then(function () {                return hexo.exit();            })            .catch(function (err) {                return hexo.exit(err);            });    });});// 压缩public目录下的js文件gulp.task(&quot;compressJs&quot;, function () {    return gulp        .src([&quot;./public/**/*.js&quot;, &quot;!./public/libs/**&quot;]) //排除的js        .pipe(gulpif(!isScriptAll, changed(&quot;./public&quot;)))        .pipe(gulpif(isDebug, debug({ title: &quot;Compress JS:&quot; })))        .pipe(plumber())        .pipe(            gulpBabel({                presets: [es2015Preset] // es5检查机制            })        )        .pipe(uglify()) //调用压缩组件方法uglify(),对合并的文件进行压缩        .pipe(gulp.dest(&quot;./public&quot;)); //输出到目标目录});// 压缩public目录下的css文件gulp.task(&quot;compressCss&quot;, function () {    var option = {        rebase: false,        //advanced: true, //类型：Boolean 默认：true [是否开启高级优化（合并选择器等）]        compatibility: &quot;ie7&quot; //保留ie7及以下兼容写法 类型：String 默认：&#39;&#39;or&#39;*&#39; [启用兼容模式； &#39;ie7&#39;：IE7兼容模式，&#39;ie8&#39;：IE8兼容模式，&#39;*&#39;：IE9+兼容模式]        //keepBreaks: true, //类型：Boolean 默认：false [是否保留换行]        //keepSpecialComments: &#39;*&#39; //保留所有特殊前缀 当你用autoprefixer生成的浏览器前缀，如果不加这个参数，有可能将会删除你的部分前缀    };    return gulp        .src([&quot;./public/**/*.css&quot;, &quot;!./public/**/*.min.css&quot;]) //排除的css        .pipe(gulpif(!isScriptAll, changed(&quot;./public&quot;)))        .pipe(gulpif(isDebug, debug({ title: &quot;Compress CSS:&quot; })))        .pipe(plumber())        .pipe(cleancss(option))        .pipe(gulp.dest(&quot;./public&quot;));});// 压缩public目录下的html文件gulp.task(&quot;compressHtml&quot;, function () {    var cleanOptions = {        protect: /&lt;\!--%fooTemplate\b.*?%--&gt;/g, //忽略处理        unprotect: /&lt;script [^&gt;]*\btype=&quot;text\/x-handlebars-template&quot;[\s\S]+?&lt;\/script&gt;/gi //特殊处理    };    var minOption = {        collapseWhitespace: true, //压缩HTML        collapseBooleanAttributes: true, //省略布尔属性的值 &lt;input checked=&quot;true&quot;/&gt; ==&gt; &lt;input /&gt;        removeEmptyAttributes: true, //删除所有空格作属性值 &lt;input id=&quot;&quot; /&gt; ==&gt; &lt;input /&gt;        removeScriptTypeAttributes: true, //删除&lt;script&gt;的type=&quot;text/javascript&quot;        removeStyleLinkTypeAttributes: true, //删除&lt;style&gt;和&lt;link&gt;的type=&quot;text/css&quot;        removeComments: true, //清除HTML注释        minifyJS: true, //压缩页面JS        minifyCSS: true, //压缩页面CSS        minifyURLs: true //替换页面URL    };    return gulp        .src(&quot;./public/**/*.html&quot;)        .pipe(gulpif(isDebug, debug({ title: &quot;Compress HTML:&quot; })))        .pipe(plumber())        .pipe(htmlclean(cleanOptions))        .pipe(htmlmin(minOption))        .pipe(gulp.dest(&quot;./public&quot;));});// 压缩 public/medias 目录内图片gulp.task(&quot;compressImage&quot;, function () {    var option = {        optimizationLevel: 5, //类型：Number 默认：3 取值范围：0-7（优化等级）        progressive: true, //类型：Boolean 默认：false 无损压缩jpg图片        interlaced: false, //类型：Boolean 默认：false 隔行扫描gif进行渲染        multipass: false //类型：Boolean 默认：false 多次优化svg直到完全优化    };    return gulp        .src(&quot;./public/medias/**/*.*&quot;)        .pipe(gulpif(!isScriptAll, changed(&quot;./public/medias&quot;)))        .pipe(gulpif(isDebug, debug({ title: &quot;Compress Images:&quot; })))        .pipe(plumber())        .pipe(imagemin(option))        .pipe(gulp.dest(&quot;./public&quot;));});// 执行顺序： 清除public目录 -&gt; 产生原始博客内容 -&gt; 执行压缩混淆 -&gt; 部署到服务器gulp.task(    &quot;build&quot;,    gulp.series(        &quot;clean&quot;,        &quot;generate&quot;,        &quot;compressHtml&quot;,        &quot;compressCss&quot;,        &quot;compressJs&quot;,        &quot;compressImage&quot;,        gulp.parallel(&quot;deploy&quot;)    ));// 默认任务gulp.task(    &quot;default&quot;,    gulp.series(        &quot;clean&quot;,        &quot;generate&quot;,        gulp.parallel(&quot;compressHtml&quot;, &quot;compressCss&quot;, &quot;compressJs&quot;,&quot;compressImage&quot;)    ));//Gulp4最大的一个改变就是gulp.task函数现在只支持两个参数，分别是任务名和运行任务的函数</code></pre><ol start="3"><li>执行方式有两种：</li></ol><ul><li>执行 <code>gulp</code>或者 <code>gulp default</code> ，这个命令相当于 <code>hexo cl&amp;&amp;hexo g</code> 并且再把代码压缩。</li><li>执行 <code>gulp build</code> ，这个命令与第1种相比是在最后又加了个 <code>hexo d</code> ，等于说生成、压缩文件后并自动部署。</li></ul><blockquote><p>值得注意的是：这个加入了图片压缩，如果不想用图片压缩可以把第154行的 <code>&quot;compressImage&quot;,</code> 和第165行的 <code>,&quot;compressImage&quot;</code> 去掉即可</p></blockquote><h4 id="6-图片懒加载"><a href="#6-图片懒加载" class="headerlink" title="6.  图片懒加载"></a>6.  图片懒加载</h4><ol><li><p>hexo安装懒加载插件：<a href="https://github.com/Troy-Yang/hexo-lazyload-image" target="_blank" rel="noopener">hexo-lazyload-image</a></p></li><li><p>在站点根目录执行下面的命令：</p><pre><code>npm install hexo-lazyload-image --save</code></pre></li><li><p>在站点配置文件下添加下面的代码：</p></li></ol><pre><code>lazyload:  enable: true  #开启图片懒加载  onlypost: false  # 是否只对文章的图片做懒加载  loadingImg: # eg ./images/loading.gif #图片未加载的图片</code></pre><ol start="4"><li>最后执行<code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</code>就可以看到效果了。</li></ol><h4 id="7-全站托管使用CDN"><a href="#7-全站托管使用CDN" class="headerlink" title="7.  全站托管使用CDN"></a>7.  全站托管使用CDN</h4><blockquote><p>这才是重点嘛</p></blockquote><p>国内付费的CDN服务商有阿里云、腾讯云等应该都不错的样子。</p><p>然而还是看看有没有免费的吧。(穷)</p><p>本人觉得还不错且稳定的推荐:<a href="https://www.cloudflare.com/" target="_blank" rel="noopener">Cloudflare</a></p><p>虽然CloudFlare CDN节点基本上在国外,国内的少且经常不通，但是将就着用吧。</p><blockquote><p>推荐使用第三方 CloudFlare 面板来接入，因为中文可以看的懂，也支持允许 CNAME 方式接入 CloudFlare</p><p> CloudFlare 面板提供商：</p><ul><li><a href="http://cdn.bnxb.com/" target="_blank" rel="noopener">笨牛网-Cloudflare免费CDN管理平台</a> </li><li><a href="https://cf.tlo.xyz/" target="_blank" rel="noopener">TLOXYGEN</a> </li><li><a href="https://cdn.wzfou.com/" target="_blank" rel="noopener">挖站否-CF 管理平台</a></li></ul></blockquote><hr><blockquote><p><code>目前已知优化如上所述，如我发现更多优化技巧将会持续更新的~</code></p></blockquote><blockquote><p><code>欢迎各位朋友还有啥建议的欢迎留言哈~</code></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客 </tag>
            
            <tag> 优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11分钟个性化定制hexo开发个人博客</title>
      <link href="/posts/c1595c80.html"/>
      <url>/posts/c1595c80.html</url>
      
        <content type="html"><![CDATA[<h2 id="11分钟个性化定制hexo开发个人博客"><a href="#11分钟个性化定制hexo开发个人博客" class="headerlink" title="11分钟个性化定制hexo开发个人博客"></a>11分钟个性化定制hexo开发个人博客</h2><blockquote><p><code>就算悲伤难抑，遍体鳞伤地处于谷底，也不能停止演奏！</code></p></blockquote><hr><p><strong>本博客基于hexo开发，使用的主题是 @blinkfox 的主题 <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank" rel="noopener">  hexo-theme-matery</a></strong> </p><blockquote><p>hexo 是基于node.js制作的一个博客工具，支持多种主题更换，主要是基于YAML来配置所需信息即可，通过markdown编写文章，hexo 能够快速构建出静态的html页面，而静态页面可以放在GitHub、Gitee等代码托管上，而无需自己购买服务器。</p></blockquote><blockquote><p>同时<strong>hexo</strong>支持更换不同好看个性的主题,比如 <strong><a href="https://github.com/theme-next/hexo-theme-next" target="_blank" rel="noopener">next</a></strong>  、<strong><a href="https://github.com/litten/hexo-theme-yilia" target="_blank" rel="noopener">yilia</a></strong>  等。</p></blockquote><h3 id="一-环境搭建"><a href="#一-环境搭建" class="headerlink" title="一. 环境搭建"></a>一. 环境搭建</h3><ul><li><p>本地安装Git（版本控制工具）</p></li><li><p>本地安装NodeJs（服务端的 JavaScript）</p></li><li><p>GitHub创建和Github Pages创建</p></li></ul><h4 id="1-本地安装Git"><a href="#1-本地安装Git" class="headerlink" title="1. 本地安装Git"></a>1. 本地安装Git</h4><p>1.1 Git下载地址（本文默认基于Window环境下开发）<a href="https://git-scm.com" target="_blank" rel="noopener">git官网</a></p><blockquote><p>因为官网下载会比较慢，推荐使用淘宝镜像快速下载  <a href="https://npm.taobao.org/mirrors/git-for-windows/v2.25.0.windows.1/Git-2.25.0-32-bit.exe" target="_blank" rel="noopener">点击下载</a></p></blockquote><p>1.2 下载完后点击安装文件并一直下一步运行成功即可，右键会看见 <code>Git Bash</code>，</p><p>打开输入  <code>git --version</code>出现版本数即为成功。</p><p>1.3 有关Git用法请参考 <a href="https://git-scm.com/book/zh/v2" target="_blank" rel="noopener">文档</a></p><blockquote><p>常用命令：</p></blockquote><pre class=" language-console"><code class="language-console">#使用前配置全局信息git config --global user.name '你的名字'git config --global user.email '你的邮箱'#查看是否已配置成功git config --list --global#在你需要使用Git的文件夹下运行git init                        #初始化git add .                        #添加变更文件到暂存区git status                        #查看变更信息git commit -m '你需要写的信息'        #提交到工作区git remote add origin https://github.com/用户名/仓库名.git    #添加Github远程连接git push origin                 #上传到GitHubgit push origin -f                #强制上传到GitHub</code></pre><h4 id="2-本地安装NodeJs"><a href="#2-本地安装NodeJs" class="headerlink" title="2. 本地安装NodeJs"></a>2. 本地安装NodeJs</h4><p>2.1 NodeJs 下载地址： <a href="http://nodejs.cn/download/" target="_blank" rel="noopener">点击下载</a></p><p>2.2 下载完后也是一直下一步就好 ，输入 <strong>node -v</strong> 查询版本就可。</p><blockquote><p>因为官方镜像源比较慢，推荐如下修改为国内的淘宝镜像源</p></blockquote><pre class=" language-console"><code class="language-console"># 临时修改镜像源npm --registry=https://registry.npm.taobao.org# 永久设置为淘宝镜像源npm config set registry https://registry.npm.taobao.org# 查看npm的配置npm config list</code></pre><blockquote><p>修改默认内置路径，在安装路径上创建 node_global<code>和</code>node_cache, 如以下：</p></blockquote><pre><code>D:\Program Files\nodejs\node_globalD:\Program Files\nodejs\node_cache</code></pre><blockquote><p>执行命令：</p></blockquote><pre><code>npm config set prefix&quot;D:\Program Files\nodejs\node_global&quot;npm config set cache &quot;D:\Program Files\nodejs\node_cache&quot;</code></pre><h4 id="3-GitHub创建和Github-Pages创建"><a href="#3-GitHub创建和Github-Pages创建" class="headerlink" title="3. GitHub创建和Github Pages创建"></a>3. GitHub创建和Github Pages创建</h4><p>3.1 打开Github<a href="https://yq.aliyun.com/go/articleRenderRedirect?url=https%3A%2F%2Fgithub.com%2F" target="_blank" rel="noopener">官网首页</a>，注册登录并创建仓库，并创建文件 index.html 即可.</p><p>3.2 在Setting 中往下拉找到 GitHub Pages 配置即可访问连接。</p><h3 id="二-博客开发"><a href="#二-博客开发" class="headerlink" title="二 . 博客开发"></a>二 . 博客开发</h3><h4 id="1-安装Hexo"><a href="#1-安装Hexo" class="headerlink" title="1. 安装Hexo"></a>1. 安装Hexo</h4><blockquote><p>在你想要保存博客文件的路径上创建文件夹，如E:\my\hexo_blog，按住 win+r 弹出框里输入 cmd 进入控制台</p></blockquote><pre><code>#进入博客文件夹的上一级目录 cd E:\my# 安装hexonpm install -g hexo-cli#初始化文件夹hexo init hexo_blog #进入博客文件夹cd E:\my\hexo_blog# 安装博客需要的依赖文件npm install  </code></pre><blockquote><p>hexo命令  <a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">官网文档</a></p></blockquote><pre><code>hexo cl    #清理hexo g    #生成hexo s    #本地服务 hexo d    #发布</code></pre><blockquote><p>本地测试 <a href="http://locakhost:4000" target="_blank" rel="noopener">http://locakhost:4000</a> 或者127.0.0.1:4000</p></blockquote><h4 id="2-hexo配置"><a href="#2-hexo配置" class="headerlink" title="2.hexo配置"></a>2.hexo配置</h4><blockquote><p>hexo 目录结构</p></blockquote><pre><code>_config.yml          配置文件_public            生成的静态文件，这个目录最终会发布到服务器  _scaffolds         通用模板  _source         保存编写的markdown文件drafts            草稿文件themes             博客主题node_modules     类库</code></pre><blockquote><p><code>_config.yml</code>配置</p></blockquote><pre class=" language-yaml"><code class="language-yaml"><span class="token comment" spellcheck="true">#网站</span><span class="token key atrule">title</span><span class="token punctuation">:</span> 你的博客名<span class="token key atrule">subtitle</span><span class="token punctuation">:</span> 博客副标题<span class="token key atrule">description</span><span class="token punctuation">:</span> 博客描述(主要用于SEO)<span class="token key atrule">keywords</span><span class="token punctuation">:</span> 博客关键词(主要用于SEO)<span class="token key atrule">author</span><span class="token punctuation">:</span> 作者(用于主题显示文章的作者)<span class="token key atrule">language</span><span class="token punctuation">:</span> 博客语言  <span class="token key atrule">timezone</span><span class="token punctuation">:</span> 时区<span class="token comment" spellcheck="true">#网址</span>url    <span class="token punctuation">:</span>网址    root <span class="token punctuation">:</span>网站根目录    <span class="token key atrule">permalink</span><span class="token punctuation">:</span> 文章的永久链接格式 <span class="token punctuation">:</span>year/<span class="token punctuation">:</span>month/<span class="token punctuation">:</span>day/<span class="token punctuation">:</span>title/<span class="token key atrule">permalink_defaults</span><span class="token punctuation">:</span>    永久链接中各部分的默认值    <span class="token key atrule">pretty_urls</span><span class="token punctuation">:</span> 改写 permalink 的值来美化 URL    <span class="token key atrule">pretty_urls.trailing_index</span><span class="token punctuation">:</span> 是否在永久链接中保留尾部的 index.html，设置为 false时去除<span class="token key atrule">pretty_urls.trailing_html</span><span class="token punctuation">:</span> 是否在永久链接中保留尾部的 .html<span class="token punctuation">,</span> 设置为 false 时去除<span class="token comment" spellcheck="true">#目录(基本不需改)</span>source_dir        资源文件夹，这个文件夹用来存放内容public_dir        公共文件夹，这个文件夹用于存放chang生成的站点文件tag_dir            标签文件夹archive_dir        归档文件夹category_dir    分类文件夹code_dir        Include code 文件夹，source_dir 下的子目录i18n_dir        国际化（i18n）文件夹skip_render        跳过指定文件的渲染。(常用于跳过GitHub的README.md渲染)<span class="token comment" spellcheck="true">#分页</span>per_page        每页显示的文章量 (0 关闭分页功能<span class="token punctuation">,</span>默认10)pagination_dir    分页目录<span class="token comment" spellcheck="true">#主题</span>theme：当前主题名称<span class="token comment" spellcheck="true">#发布</span><span class="token key atrule">deploy</span><span class="token punctuation">:</span>  <span class="token key atrule">type</span><span class="token punctuation">:</span> git  <span class="token key atrule">repo</span><span class="token punctuation">:</span> 仓库  <span class="token key atrule">branch</span><span class="token punctuation">:</span> 分支</code></pre><h4 id="3-使用主题和配置"><a href="#3-使用主题和配置" class="headerlink" title="3. 使用主题和配置"></a>3. 使用主题和配置</h4><blockquote><p>参考博客 <a href="https://blinkfox.github.io/2018/09/28/qian-duan/hexo-bo-ke-zhu-ti-zhi-hexo-theme-matery-de-jie-shao/" target="_blank" rel="noopener">Hexo博客主题之hexo-theme-matery的介绍</a></p></blockquote><h5 id="3-1-下载主题："><a href="#3-1-下载主题：" class="headerlink" title="3.1 下载主题："></a>3.1 下载主题：</h5><h5 id="hexo-theme-matery-放在站点目录文件夹下-themes-文件夹中即可。"><a href="#hexo-theme-matery-放在站点目录文件夹下-themes-文件夹中即可。" class="headerlink" title=" hexo-theme-matery  放在站点目录文件夹下 themes 文件夹中即可。"></a><a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank" rel="noopener"> hexo-theme-matery</a>  放在站点目录文件夹下 <code>themes</code> 文件夹中即可。</h5><h5 id="3-2-在站点配置文件-config-yml修改theme-主题名"><a href="#3-2-在站点配置文件-config-yml修改theme-主题名" class="headerlink" title="3.2 在站点配置文件_config.yml修改theme: 主题名"></a>3.2 在站点配置文件<code>_config.yml</code>修改<code>theme: 主题名</code></h5><blockquote><p>防坑指南：设置的主题名和下载的主题名要完全一致</p></blockquote><h5 id="3-3-新建分类-categories-页"><a href="#3-3-新建分类-categories-页" class="headerlink" title="3.3 新建分类 categories 页"></a>3.3 新建分类 categories 页</h5><pre class=" language-bash"><code class="language-bash">hexo new page <span class="token string">"categories"</span></code></pre><p>编辑文件 <code>/source/categories/index.md</code>，内容如下：</p><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> categories<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2020-02-10</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"categories"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"categories"</span><span class="token punctuation">---</span></code></pre><h5 id="3-4-新建标签-tags-页"><a href="#3-4-新建标签-tags-页" class="headerlink" title="3.4 新建标签 tags 页"></a>3.4 新建标签 tags 页</h5><pre class=" language-bash"><code class="language-bash">hexo new page <span class="token string">"tags"</span></code></pre><p>编辑文件 <code>/source/tags/index.md</code>，内容如下：</p><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> tags<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2018-09-30 18:23:38</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"tags"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"tags"</span><span class="token punctuation">---</span></code></pre><h5 id="3-5-新建关于我-about-页"><a href="#3-5-新建关于我-about-页" class="headerlink" title="3.5 新建关于我 about 页"></a>3.5 新建关于我 about 页</h5><pre class=" language-bash"><code class="language-bash">hexo new page <span class="token string">"about"</span></code></pre><p>编辑文件 <code>/source/about/index.md</code>，内容如下：</p><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> about<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2018-09-30 17:25:30</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"about"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"about"</span><span class="token punctuation">---</span></code></pre><h5 id="3-6-新建友情连接-friends-页（可选的）"><a href="#3-6-新建友情连接-friends-页（可选的）" class="headerlink" title="3.6 新建友情连接 friends 页（可选的）"></a>3.6 新建友情连接 friends 页（可选的）</h5><pre class=" language-bash"><code class="language-bash">hexo new page <span class="token string">"friends"</span></code></pre><p>编辑文件 <code>/source/friends/index.md</code>，内容如下：</p><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> friends<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2018-12-12 21:25:30</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"friends"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"friends"</span><span class="token punctuation">---</span></code></pre><p>同时，在你的博客 <code>source</code> 目录下新建 <code>_data</code> 目录，在 <code>_data</code> 目录中新建 <code>friends.json</code> 文件，文件内容如下所示：</p><pre class=" language-json"><code class="language-json"><span class="token punctuation">[</span><span class="token punctuation">{</span>    <span class="token property">"avatar"</span><span class="token operator">:</span> <span class="token string">"https://s2.ax1x.com/2020/02/13/1q6iAs.th.png"</span><span class="token punctuation">,</span>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Athink_"</span><span class="token punctuation">,</span>    <span class="token property">"introduction"</span><span class="token operator">:</span> <span class="token string">"加油 你可以的"</span><span class="token punctuation">,</span>    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"https://blog.onfree.cn/"</span><span class="token punctuation">,</span>    <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"前去学习"</span><span class="token punctuation">}</span><span class="token punctuation">]</span></code></pre><h5 id="3-7-代码高亮"><a href="#3-7-代码高亮" class="headerlink" title="3.7 代码高亮"></a>3.7 代码高亮</h5><p>使用<a href="https://github.com/ele828/hexo-prism-plugin" target="_blank" rel="noopener"> hexo-prism-plugin</a>的 Hexo 插件来加强代码高亮，安装命令如下：</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> i -S hexo-prism-plugin</code></pre><p>修改 Hexo 根目录下 <code>_config.yml</code> 中 <code>highlight.enable</code> 的值为 <code>false</code>，并新增 <code>prism</code> 插件相关配置，主要配置如下：</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">highlight</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">prism_plugin</span><span class="token punctuation">:</span>  <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token string">'preprocess'</span>    <span class="token comment" spellcheck="true"># realtime/preprocess</span>  <span class="token key atrule">theme</span><span class="token punctuation">:</span> <span class="token string">'tomorrow'</span>  <span class="token key atrule">line_number</span><span class="token punctuation">:</span> <span class="token boolean important">false    </span><span class="token comment" spellcheck="true"># default false</span>  custom_css<span class="token punctuation">:</span></code></pre><h5 id="3-8-搜索"><a href="#3-8-搜索" class="headerlink" title="3.8 搜索"></a>3.8 搜索</h5><p>使用  <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener">hexo-generator-search</a> 的 Hexo 插件来做内容搜索，安装命令如下：</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> hexo-generator-search --save</code></pre><p>在 Hexo 根目录下的 <code>_config.yml</code> 文件中，新增以下的配置项：</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">search</span><span class="token punctuation">:</span>  <span class="token key atrule">path</span><span class="token punctuation">:</span> search.xml  <span class="token key atrule">field</span><span class="token punctuation">:</span> post</code></pre><h5 id="3-9-中文链接转拼音（可选的）"><a href="#3-9-中文链接转拼音（可选的）" class="headerlink" title="3.9 中文链接转拼音（可选的）"></a>3.9 中文链接转拼音（可选的）</h5><p>使用 <a href="https://github.com/viko16/hexo-permalink-pinyin" target="_blank" rel="noopener">hexo-permalink-pinyin</a> Hexo 插件使在生成文章时生成中文拼音的永久链接，安装命令如下：</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> i hexo-permalink-pinyin --save</code></pre><p>在 Hexo 根目录下的 <code>_config.yml</code> 文件中，新增以下的配置项：</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">permalink_pinyin</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">separator</span><span class="token punctuation">:</span> <span class="token string">'-'</span> <span class="token comment" spellcheck="true"># default: '-'</span></code></pre><blockquote><p><strong>注</strong>：除了此插件外，<a href="https://github.com/rozbo/hexo-abbrlink" target="_blank" rel="noopener">hexo-abbrlink</a> 插件也可以生成非中文的链接。</p></blockquote><p>3.10 文章字数统计插件（可选的）</p><p>安装 <a href="https://github.com/willin/hexo-wordcount" target="_blank" rel="noopener">hexo-wordcount</a>插件，在文章中显示文章字数、阅读时长信息，安装命令如下：</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> i --save hexo-wordcount</code></pre><p>然后只需在本主题下的 _config.yml 文件中，激活以下配置项即可：</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">wordCount</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">postWordCount</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">min2read</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">totalCount</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></code></pre><h5 id="3-11-修改页脚"><a href="#3-11-修改页脚" class="headerlink" title="3.11 修改页脚"></a>3.11 修改页脚</h5><p>页脚信息可在主题文件的 <code>/layout/_partial/footer.ejs</code> 文件中定制化修改，包括站点、使用的主题、访问量等。</p><h5 id="3-12修改社交链接"><a href="#3-12修改社交链接" class="headerlink" title="3.12修改社交链接"></a>3.12修改社交链接</h5><p>在主题的 <code>_config.yml</code> 文件中，默认支持 <code>QQ</code>、<code>GitHub</code> 和邮箱的配置，你可以在主题文件的 <code>/layout/_partial/social-link.ejs</code> 文件中，新增、修改你需要的社交链接地址，增加链接可参考如下代码：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://github.com/blinkfox<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tooltipped<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span> <span class="token attr-name">data-tooltip</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>访问我的GitHub<span class="token punctuation">"</span></span> <span class="token attr-name">data-position</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>top<span class="token punctuation">"</span></span> <span class="token attr-name">data-delay</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-github<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre><p>其中，社交图标（如：<code>fa-github</code>）你可以在 <a href="https://fontawesome.com/icons" target="_blank" rel="noopener">Font Awesome</a> 中搜索找到。以下是常用社交图标的标识，供你参考：</p><ul><li>Facebook: <code>fa-facebook</code></li><li>Twitter: <code>fa-twitter</code></li><li>Google-plus: <code>fa-google-plus</code></li><li>Linkedin: <code>fa-linkedin</code></li><li>Tumblr: <code>fa-tumblr</code></li><li>Medium: <code>fa-medium</code></li><li>Slack: <code>fa-slack</code></li><li>新浪微博: <code>fa-weibo</code></li><li>微信: <code>fa-wechat</code></li><li>QQ: <code>fa-qq</code></li></ul><h5 id="3-13-修改打赏的二维码图片"><a href="#3-13-修改打赏的二维码图片" class="headerlink" title="3.13 修改打赏的二维码图片"></a>3.13 修改打赏的二维码图片</h5><p>在主题文件的 <code>source/medias/reward</code> 文件中，替换成你的的微信和支付宝的打赏二维码图片。</p><h5 id="3-14配置音乐播放器（可选的）"><a href="#3-14配置音乐播放器（可选的）" class="headerlink" title="3.14配置音乐播放器（可选的）"></a>3.14配置音乐播放器（可选的）</h5><p>在主题的 <code>_config.yml</code> 配置文件中激活配置：</p><pre class=" language-yaml"><code class="language-yaml"><span class="token comment" spellcheck="true"># 是否在首页显示音乐.</span><span class="token key atrule">music</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true">#非吸底模式 有效</span>   <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>   <span class="token key atrule">show</span><span class="token punctuation">:</span> 听听音乐  <span class="token key atrule">server</span><span class="token punctuation">:</span> netease   <span class="token comment" spellcheck="true">#必须    服务源: netease, tencent, kugou, xiami, baidu</span>  <span class="token key atrule">type</span><span class="token punctuation">:</span> playlist    <span class="token comment" spellcheck="true">#必须 歌曲, playlist, album, search, artist</span>  <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">260222983     </span><span class="token comment" spellcheck="true">#必须    歌曲 id / playlist id / album id / search keyword</span>  <span class="token key atrule">fixed</span><span class="token punctuation">:</span> <span class="token boolean important">true </span><span class="token comment" spellcheck="true"># 开启吸底模式</span>  <span class="token key atrule">autoplay</span><span class="token punctuation">:</span> <span class="token boolean important">false </span><span class="token comment" spellcheck="true"># 是否自动播放</span>  <span class="token key atrule">theme</span><span class="token punctuation">:</span> '<span class="token comment" spellcheck="true">#C4C4C4'</span>  <span class="token key atrule">loop</span><span class="token punctuation">:</span> all <span class="token comment" spellcheck="true"># 音频循环播放, 可选值: 'all', 'one', 'none'</span>  <span class="token key atrule">order</span><span class="token punctuation">:</span> <span class="token string">'random'</span> <span class="token comment" spellcheck="true"># 音频循环顺序, 可选值: 'list', 'random'</span>  <span class="token key atrule">preload</span><span class="token punctuation">:</span> <span class="token string">'auto'</span> <span class="token comment" spellcheck="true"># 预加载，可选值: 'none', 'metadata', 'auto'</span>  <span class="token key atrule">volume</span><span class="token punctuation">:</span> <span class="token number">0.9 </span><span class="token comment" spellcheck="true"># 默认音量，请注意播放器会记忆用户设置，用户手动设置音量后默认音量即失效</span>  <span class="token key atrule">listFolded</span><span class="token punctuation">:</span> <span class="token boolean important">true </span><span class="token comment" spellcheck="true"># 列表默认折叠</span>  <span class="token key atrule">listMaxHeight</span><span class="token punctuation">:</span> 600px <span class="token comment" spellcheck="true">#列表最大高度</span></code></pre><blockquote><p>防坑指南：主题默认开启歌词的，简单粗暴直接修改aplyer源码</p><pre><code>查找 aplayer-icon aplayer-icon-lrc 在后添加 aplayer-icon-lrc-inactivity查找 this.player.template.lrcButton.addEventListener 在前面添加 e.player.lrc.hide();</code></pre></blockquote><blockquote><p>防坑指南：主题最新播放器背景颜色和歌曲文章列表颜色相近导致看不清</p><p> 在/source/css/matery.css里添加如下：</p><pre><code>.aplayer-list-title {color: #666;}.aplayer-title {    color: #009688}</code></pre></blockquote><h5 id="3-15-文章-Front-matter-介绍"><a href="#3-15-文章-Front-matter-介绍" class="headerlink" title="3.15 文章 Front-matter 介绍"></a>3.15 文章 Front-matter 介绍</h5><p><code>Front-matter</code> 选项中的所有内容均为<strong>非必填</strong>的。但我仍然建议至少填写 <code>title</code> 、<code>categories</code> 、 <code>tags</code>、<code>date</code> 的值。</p><table><thead><tr><th align="left">配置选项</th><th align="left">默认值</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left">title</td><td align="left"><code>Markdown</code> 的文件标题</td><td align="left">文章标题，强烈建议填写此选项</td></tr><tr><td align="left">date</td><td align="left">文件创建时的日期时间</td><td align="left">发布时间，强烈建议填写此选项，且最好保证全局唯一</td></tr><tr><td align="left">author</td><td align="left">根 <code>_config.yml</code>中的 <code>author</code></td><td align="left">文章作者</td></tr><tr><td align="left">img</td><td align="left"><code>featureImages</code>中的某个值</td><td align="left">文章特征图，推荐使用图床(腾讯云、七牛云、又拍云等)来做图片的路径.如: <code>http://xxx.com/xxx.jpg</code></td></tr><tr><td align="left">top</td><td align="left"><code>true</code></td><td align="left">推荐文章（文章是否置顶），如果 <code>top</code> 值为 <code>true</code>，则会作为首页推荐文章</td></tr><tr><td align="left">cover</td><td align="left"><code>false</code></td><td align="left"><code>v1.0.2</code>版本新增，表示该文章是否需要加入到首页轮播封面中</td></tr><tr><td align="left">coverImg</td><td align="left">无</td><td align="left"><code>v1.0.2</code>版本新增，表示该文章在首页轮播封面需要显示的图片路径，如果没有，则默认使用文章的特色图片</td></tr><tr><td align="left">password</td><td align="left">无</td><td align="left">文章阅读密码，如果要对文章设置阅读验证密码的话，就可以设置 <code>password</code> 的值，该值必须是用 <code>SHA256</code> 加密后的密码，防止被他人识破。前提是在主题的 <code>config.yml</code> 中激活了 <code>verifyPassword</code> 选项</td></tr><tr><td align="left">toc</td><td align="left"><code>true</code></td><td align="left">是否开启 TOC，可以针对某篇文章单独关闭 TOC 的功能。前提是在主题的 <code>config.yml</code> 中激活了 <code>toc</code> 选项</td></tr><tr><td align="left">mathjax</td><td align="left"><code>false</code></td><td align="left">是否开启数学公式支持 ，本文章是否开启 <code>mathjax</code>，且需要在主题的 <code>_config.yml</code> 文件中也需要开启才行</td></tr><tr><td align="left">summary</td><td align="left">无</td><td align="left">文章摘要，自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要</td></tr><tr><td align="left">categories</td><td align="left">无</td><td align="left">文章分类，本主题的分类表示宏观上大的分类，只建议一篇文章一个分类</td></tr><tr><td align="left">tags</td><td align="left">无</td><td align="left">文章标签，一篇文章可以多个标签</td></tr></tbody></table><blockquote><p><strong>注意</strong>:</p><ol><li>如果 <code>img</code> 属性不填写的话，文章特色图会根据文章标题的 <code>hashcode</code> 的值取余，然后选取主题中对应的特色图片，从而达到让所有文章都的特色图<strong>各有特色</strong>。</li><li><code>date</code> 的值尽量保证每篇文章是唯一的，因为本主题中 <code>Gitalk</code> 和 <code>Gitment</code> 识别 <code>id</code> 是通过 <code>date</code> 的值来作为唯一标识的。</li><li>如果要对文章设置阅读验证密码的功能，不仅要在 Front-matter 中设置采用了 SHA256 加密的 password 的值，还需要在主题的 <code>_config.yml</code> 中激活了配置。有些在线的 SHA256 加密的地址，可供你使用：<a href="http://tool.oschina.net/encrypt?type=2" target="_blank" rel="noopener">开源中国在线工具</a>、<a href="http://encode.chahuo.com/" target="_blank" rel="noopener">chahuo</a>、<a href="http://tool.chinaz.com/tools/hash.aspx" target="_blank" rel="noopener">站长工具</a>。</li></ol></blockquote><p>以下为文章的 <code>Front-matter</code> 示例。</p><p>最简示例</p><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> hello world<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2020-02-10 08:05:00</span><span class="token key atrule">categories</span><span class="token punctuation">:</span> 杂文<span class="token key atrule">tags</span><span class="token punctuation">:</span> 测试<span class="token punctuation">---</span></code></pre><p>最全示例</p><pre class=" language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> hello world<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2020-02-10 08:05:00</span><span class="token key atrule">author</span><span class="token punctuation">:</span> athink_<span class="token key atrule">img</span><span class="token punctuation">:</span> /source/images/xxx.jpg<span class="token key atrule">top</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">cover</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">coverImg</span><span class="token punctuation">:</span> /images/1.jpg<span class="token key atrule">password</span><span class="token punctuation">:</span> 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92<span class="token key atrule">toc</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">mathjax</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">summary</span><span class="token punctuation">:</span> 这是你自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要<span class="token key atrule">categories</span><span class="token punctuation">:</span> 杂文<span class="token key atrule">tags</span><span class="token punctuation">:</span> 测试<span class="token punctuation">---</span></code></pre><h5 id="3-16-修改主题颜色"><a href="#3-16-修改主题颜色" class="headerlink" title="3.16 修改主题颜色"></a>3.16 修改主题颜色</h5><p>在主题文件的 <code>/source/css/matery.css</code> 文件中，搜索 <code>.bg-color</code> 来修改背景颜色：</p><pre><code>/* 整体背景颜色，包括导航、移动端的导航、页尾、标签页等的背景颜色. */.bg-color {    background-image: linear-gradient(to right, #4cbf30 0%, #0f9d58 100%);}/*如果想去掉banner图的颜色渐变效果，请将以下的css属性注释掉或者删除掉即可*/@-webkit-keyframes rainbow {   /* 动态切换背景颜色. */}@keyframes rainbow {    /* 动态切换背景颜色. */}</code></pre><blockquote><p>推荐<a href="https://www.materialpalette.com/colors" target="_blank" rel="noopener">配色方案</a></p></blockquote><h5 id="3-17修改-banner-图和文章特色图"><a href="#3-17修改-banner-图和文章特色图" class="headerlink" title="3.17修改 banner 图和文章特色图"></a>3.17修改 banner 图和文章特色图</h5><p> banner 图修改在 /layout/_partial/bg-cover-content.ejs` 文件的代码中修改：</p><pre><code>$(&#39;.bg-cover&#39;).css(&#39;background-image&#39;, &#39;url(/medias/banner/&#39; + new Date().getDay() + &#39;.jpg)&#39;);</code></pre><p>在 <code>/source/medias/featureimages</code> 文件夹中默认有 24 张特色图片，你可以再增加或者减少，并需要在 <code>_config.yml</code> 做同步修改。</p><h5 id="3-18-制作动态标题"><a href="#3-18-制作动态标题" class="headerlink" title="3.18 制作动态标题"></a>3.18 制作动态标题</h5><p>实现方法，引入js文件，在主题文件下的<code>/source/js/</code>下新建<code>FunnyTitle.js</code>，然后在添加到<code>themes/matery/layout/layout.ejs</code>或者添加到<code>themes/matery/layout/_partial/head.ejs</code>，其代码如下：</p><pre><code>&lt;!--浏览器搞笑标题--&gt; var OriginTitle = document.title; var titleTime; document.addEventListener(&#39;visibilitychange&#39;, function () {     if (document.hidden) {         $(&#39;[rel=&quot;icon&quot;]&#39;).attr(&#39;href&#39;, &quot;https://cdn.jsdelivr.net/gh/Yafine/cdn@2.5/source/favicon.png&quot;);         document.title = &#39;ヽ(●-`Д´-)ノ你要玩捉迷藏嘛&#39;;         clearTimeout(titleTime);     }     else {         $(&#39;[rel=&quot;icon&quot;]&#39;).attr(&#39;href&#39;, &quot;https://cdn.jsdelivr.net/gh/Yafine/cdn@2.5/source/favicon.png&quot;);         document.title = &#39;ヾ(Ő∀Ő3)ノ好哦！&#39; + OriginTitle;         titleTime = setTimeout(function () {             document.title = OriginTitle;         }, 2000);     } });</code></pre><h5 id="3-19-添加动态诗词"><a href="#3-19-添加动态诗词" class="headerlink" title="3.19 添加动态诗词"></a>3.19 添加动态诗词</h5><p>在<code>/themes/matery/layout/_partial/head.ejs</code>添加下面的一行代码：</p><pre><code>&lt;script src=&quot;https://sdk.jinrishici.com/v2/browser/jinrishici.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;</code></pre><p>然后再将<code>/themes/matery/layout/_partial/bg-cover-content.ejs</code>中的<code>&lt;%= config.description %&gt;</code>修改为把<code>&lt;%= config.description %&gt;</code>改为<code>&lt;%- &#39;正在加载今日诗词....&#39; %&gt;</code>，这个使用前提是将主题配置文件的<code>subtitle</code>的值改为<code>false</code>。</p><h5 id="3-20-添加一言语录"><a href="#3-20-添加一言语录" class="headerlink" title="3.20 添加一言语录"></a>3.20 添加一言语录</h5><p>在<code>\layout\_widget\dream.ejs</code> 中修改如下</p><pre><code>&lt;div class=&quot;dream&quot;&gt;    &lt;% if (theme.dream.showTitle) { %&gt;    &lt;div class=&quot;title center-align&quot;&gt;       &lt;i class=&quot;fa fa-paper-plane&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; &amp;nbsp;&amp;nbsp;&lt;%- theme.dream.title %&gt;    &lt;/div&gt;    &lt;% } %&gt;    &lt;div class=&quot;row&quot;&gt;        &lt;!-- &lt;div class=&quot;col l8 offset-l2 m10 offset-m1 s10 offset-s1 center-align text&quot;&gt;            &lt;%- theme.dream.text %&gt;        &lt;/div&gt; --&gt;        &lt;div class=&quot;col l8 offset-l2 m10 offset-m1 s10 offset-s1 center-align text&quot;&gt;        &lt;/div&gt;        &lt;!-- 添加动态添加一言语录 --&gt;        &lt;% if (theme.dream.textUrl!=null||theme.dream.textUrl!=&quot;&quot;) { %&gt;            &lt;script&gt;                $.ajax({                    type: &quot;Get&quot;,                    url:  &quot;&lt;%- theme.dream.textUrl %&gt;&quot;,                    success: function(data) {                        $(&quot;.text&quot;).html(data)                    },                    error:function(){                        $(&quot;.text&quot;).html(&quot; &lt;%- theme.dream.text %&gt;&quot;)                         }                })            &lt;/script&gt;        &lt;% } %&gt;    &lt;/div&gt;&lt;/div&gt;</code></pre><blockquote><p>引用了 一言语录API : <a href="https://api.uixsj.cn/hitokoto/w.php" target="_blank" rel="noopener">https://api.uixsj.cn/hitokoto/w.php</a></p></blockquote><h5 id="3-21-鼠标点击文字特效"><a href="#3-21-鼠标点击文字特效" class="headerlink" title="3.21 鼠标点击文字特效"></a>3.21 鼠标点击文字特效</h5><p>实现方法，引入js文件，在主题文件下的<code>/source/js/</code>下新建<code>click_show_text.js</code>，并添加到<code>themes/matery/layout/layout.ejs</code>。其代码如下：</p><pre><code>var a_idx = 0;jQuery(document).ready(function ($) {    $(&quot;body&quot;).click(function (e) {        var a = new Array(&quot;富强&quot;, &quot;民主&quot;, &quot;文明&quot;, &quot;和谐&quot;, &quot;自由&quot;, &quot;平等&quot;, &quot;公正&quot;, &quot;法治&quot;, &quot;爱国&quot;, &quot;敬业&quot;, &quot;诚信&quot;, &quot;友善&quot;);        var $i = $(&quot;&lt;span/&gt;&quot;).text(a[a_idx]);        a_idx = (a_idx + 1) % a.length;        var x = e.pageX,            y = e.pageY;        $i.css({            &quot;z-index&quot;: 5,            &quot;top&quot;: y - 20,            &quot;left&quot;: x,            &quot;position&quot;: &quot;absolute&quot;,            &quot;font-weight&quot;: &quot;bold&quot;,            &quot;color&quot;: &quot;#FF0000&quot;        });        $(&quot;body&quot;).append($i);        $i.animate({                &quot;top&quot;: y - 180,                &quot;opacity&quot;: 0            },            3000,            function () {                $i.remove();            });    });    setTimeout(&#39;delay()&#39;, 2000);});function delay() {    $(&quot;.buryit&quot;).removeAttr(&quot;onclick&quot;);}</code></pre><h5 id="3-22-修改原有相册"><a href="#3-22-修改原有相册" class="headerlink" title="3.22. 修改原有相册"></a>3.22. 修改原有相册</h5><p>参考教程：<a href="https://liyangzone.com/2019/07/22/hexo%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E4%B8%80%E7%BA%A7%E5%88%86%E7%B1%BB%E7%9B%B8%E5%86%8C/?spm=a2c4e.10696291.0.0.3f6a19a4hBRD5E" target="_blank" rel="noopener">传送门</a></p><h5 id="3-23-添加天气小插件"><a href="#3-23-添加天气小插件" class="headerlink" title="3.23. 添加天气小插件"></a>3.23. 添加天气小插件</h5><p>首先去中国天气官网：<a href="https://yq.aliyun.com/go/articleRenderRedirect?url=https%3A%2F%2Fcj.weather.com.cn%2Fplugin%2Fpc" target="_blank" rel="noopener">https://cj.weather.com.cn/plugin/pc</a>，配置自己的插件，选择自定义插件—&gt;自定义样式——&gt;生成代码，然后会生成一段代码，复制粘贴到 <code>themes/matery/layout/layout.ejs</code>即可。</p><h5 id="3-24-关于我页面添加个人简历"><a href="#3-24-关于我页面添加个人简历" class="headerlink" title="3.24. 关于我页面添加个人简历"></a>3.24. 关于我页面添加个人简历</h5><p>打开<code>theme/matery/layout/about.ejs</code>文件，大约在13行。有一个``标签，找出其对应结尾的标签，大约在61行左右，然后在新增如下代码：</p><pre><code>&lt;div class=&quot;card&quot;&gt;     &lt;div class=&quot;card-content&quot;&gt;         &lt;div class=&quot;card-content article-card-content&quot;&gt;             &lt;div class=&quot;title center-align&quot; data-aos=&quot;zoom-in-up&quot;&gt;                 &lt;i class=&quot;fa fa-address-book&quot;&gt;&lt;/i&gt;&amp;nbsp;&amp;nbsp;&lt;%- __(&#39;个人简历&#39;) %&gt;              &lt;/div&gt;                 &lt;div id=&quot;articleContent&quot; data-aos=&quot;fade-up&quot;&gt;                     &lt;%- page.content %&gt;                 &lt;/div&gt;           &lt;/div&gt;      &lt;/div&gt;&lt;/div&gt;</code></pre><p>注意粘贴的位置和空格要正确，这里的位置随你自己设置，你也可以把简历作为第一个card，然后<code>/source/about/index.md</code>下面写上你的简历了（就像写博客一样）。</p><h5 id="3-25外链跳转插件"><a href="#3-25外链跳转插件" class="headerlink" title="3.25外链跳转插件"></a>3.25外链跳转插件</h5><blockquote><p><a href="https://blog.hvnobug.com/go.html?url=aHR0cHM6Ly9naXRodWIuY29tL2h2bm9idWcvaGV4by1leHRlcm5hbC1saW5r" target="_blank" rel="noopener">hexo-external-link</a>是一个跳转外链相关插件。自动为所有html文件中外链的a标签生成对应的属性。 比如 设置<code>target=’_blank’, rel=’external nofollow noopener noreferrer’</code> 告诉搜索引擎这是外部链接,不要将该链接计入权重。 同时自动生成外链跳转页面,默认在根目录下 go.html;</p></blockquote><p>使用 npm 或者 yarn 安装</p><pre><code>## npm 安装npm install hexo-external-link --save## yarn 安装yarn add hexo-external-link</code></pre><p>之后再hexo博客站点根目录下添加如下配置：</p><pre><code>hexo_external_link:  enable: true  enable_base64_encode: true  url_param_name: &#39;u&#39;  html_file_name: &#39;go.html&#39;  target_blank: true  link_rel: &#39;external nofollow noopener noreferrer&#39;  domain: &#39;your_domain&#39; # 如果开启了防盗链  safety_chain: true</code></pre><ul><li><strong>enable</strong> - 是否开启<code>hexo_external_link</code>插件 - 默认 false</li><li><strong>enable_base64_encode</strong> - 是否对跳转<code>url</code>使用<code>base64编码</code> - 默认 fasle</li><li><strong>url_param_name</strong> - url参数名,在跳转到外链传递给<code>html_file_name</code>的参数名 - 默认 ‘u’</li><li><strong>html_file_name</strong> - 跳转到外链的页面文件路径 - 默认 ‘go.html’</li><li><strong>target_blank</strong> - 是否为外链的<code>a</code>标签添加<code>target=&#39;_blank&#39;</code> - 默认 true</li><li><strong>link_rel</strong> - 设置外链的<code>a</code>标签的rel属性 - 默认 ‘external nofollow noopener noreferrer’</li><li><strong>domain</strong> - 如果开启了防盗链,除了 localhost 和 domain 之外调用会跳到主页,同时也是判断链接是否为外链的依据 - 默认 window.location.host</li><li><strong>safety_chain</strong> - go.html 为了防止外链盗用 对域名进行的判断 - 默认 false</li></ul><p>3.24 添加雪花飘落效果</p><p>在<code>themes/matery/source/js</code>目录下新建<code>snow.js</code>文件，打开这个网址<a href="https://cdn.jsdelivr.net/gh/Yafine/cdn@2.5/source/js/snow1.js" target="_blank" rel="noopener">传送门</a>，将内容复制粘贴到cursor.js即可。</p><p>然后再<code>themes/matery/layout/layout.ejs</code>文件内添加下面的内容：</p><pre><code>&lt;script src=&quot;/js/snow.js&quot;&gt;&lt;/script&gt;</code></pre><h5 id="3-25-添加自定义页面"><a href="#3-25-添加自定义页面" class="headerlink" title="3.25 添加自定义页面"></a>3.25 添加自定义页面</h5><p>首先在站点目录下的source文件夹下新建<code>aboutme</code>文件，文件名可自定义，然后编写一个<code>index.html</code>放入<code>aboutme</code>文件夹下，然后在主题配置文件下的导航配置信息添加下面的配置：</p><pre><code>About:    url: /    icon: fas fa-address-card    children:      - name: 关于我        url: /about        icon: fas fa-user-circle      - name: Another    #这是新添加的，在原有配置基础上添加        url: /aboutme        icon: fa fa-user-secret</code></pre><p>然后在站点配置文件下，找到<code>skip_render</code>，在后面添加属性，如下：</p><pre><code>skip_render: aboutme/**  # 其意思为在对文件进行渲染时跳过aboutme文件下的所有文件</code></pre><p>知道方法后，你可以添加你自己想要添加的页面，让你的博客内容更加充实。</p><h5 id="3-26-添加404页面"><a href="#3-26-添加404页面" class="headerlink" title="3.26 添加404页面"></a>3.26 添加404页面</h5><p>首先再站点根目录下的source文件夹下新建<code>404.md</code>文件，里面内容如下：</p><pre><code>---title: 404date: 2020-02-10 16:41:10type: &quot;404&quot;layout: &quot;404&quot;description: &quot;Oops～，我崩溃了！找不到你想要的页面了&quot;---</code></pre><p>紧接着再新建主题文件夹的layout目录下新建<code>404.ejs</code>文件，添加内容如下：</p><pre><code>&lt;style type=&quot;text/css&quot;&gt;    /* don&#39;t remove. */    .about-cover {        height: 90.2vh;    }&lt;/style&gt;&lt;div class=&quot;bg-cover pd-header about-cover&quot;&gt;    &lt;div class=&quot;container&quot;&gt;        &lt;div class=&quot;row&quot;&gt;            &lt;div class=&quot;col s10 offset-s1 m8 offset-m2 l8 offset-l2&quot;&gt;                &lt;div class=&quot;brand&quot;&gt;                    &lt;div class=&quot;title center-align&quot;&gt;                        404                    &lt;/div&gt;                    &lt;div class=&quot;description center-align&quot;&gt;                        &lt;%= page.description %&gt;                    &lt;/div&gt;                &lt;/div&gt;            &lt;/div&gt;        &lt;/div&gt;    &lt;/div&gt;&lt;/div&gt;&lt;script&gt;    // 每天切换 banner 图.  Switch banner image every day.    $(&#39;.bg-cover&#39;).css(&#39;background-image&#39;, &#39;url(https://cdn.jsdelivr.net/gh/Yafine/cdn@2.6/source/medias/banner/&#39; + new Date().getDay() + &#39;.jpg)&#39;);&lt;/script&gt;</code></pre><h5 id="3-27-文章生成永久链接"><a href="#3-27-文章生成永久链接" class="headerlink" title="3.27 文章生成永久链接"></a>3.27 文章生成永久链接</h5><p>主题默认的文章链接配置是</p><pre><code>premalink: :year/:month/:day/:title</code></pre><p>这种生成的链接地址很长，文章版权的链接地址会出现一大串字符编码，一点也不好看。因此需要修改文章生成链接的格式。</p><p>首先再根目录下执行下面的命令：</p><p><a href="https%3A%2F%2Fgithub.com%2Frozbo%2Fhexo-abbrlink">hexo-abbrlinkGitHub地址</a></p><pre><code>npm install hexo-abbrlink --save</code></pre><p>然后再站点配置文件下添加如下配置：</p><pre><code>abbrlink:    alg: crc16   #算法： crc16(default) and crc32    rep: hex     #进制： dec(default) and hex: dec #输出进制：十进制和十六进制，默认为10进制。丨dec为十进制，hex为十六进制</code></pre><p>再将站点配置文件的<code>permalink</code>的值修改为：</p><pre><code>permalink: posts/:abbrlink.html  # 此处可以自己设置，也可以直接使用 :/abbrlink</code></pre><p>生成文章的链接格式就会是如下样例（官方样例）:</p><pre><code>crc16 &amp; hexhttps://post.zz173.com/posts/66c8.htmlcrc16 &amp; dechttps://post.zz173.com/posts/65535.htmlcrc32 &amp; hexhttps://post.zz173.com/posts/8ddf18fb.htmlcrc32 &amp; dechttps://post.zz173.com/posts/1690090958.html</code></pre><p>生成完后，原md文件的Front-matter 内会增加<code>abbrlink</code> 字段，值为生成的ID 。这个字段确保了在我们修改了Front-matter 内的博客标题title或创建日期date字段之后而不会改变链接地址。</p><h5 id="3-28添加Valine评论系统"><a href="#3-28添加Valine评论系统" class="headerlink" title="3.28添加Valine评论系统"></a>3.28添加Valine评论系统</h5><p>登录<a href="https://leancloud.cn/dashboard/login.html#/signin" target="_blank" rel="noopener">LeanCloud</a>,创建应用,在设置中将其中APPID和APPKey复制，添加到配置文件中。</p><pre><code>valine:  enable: false  # true即为开启评论系统  appId:   #此处填写你的appid  appKey:  #此处填写你的appkey  notify: false  verify: false  visitor: true  avatar: &#39;mm&#39; # Gravatar style : mm/identicon/monsterid/wavatar/retro/hide  pageSize: 10  placeholder: &#39;just go go&#39; # Comment Box placeholder  background:  https://cdn.jsdelivr.net/gh/Yafine/cdn@2.6/social/comment_bg.png</code></pre><h3 id="4-总结"><a href="#4-总结" class="headerlink" title="4.总结"></a>4.总结</h3><blockquote><p>本以为使用hexo开发博客会很复杂很难，</p><p>然而发现大多数都是写好的，只有在配置文件上修改就行,</p><p>对于主题样式内容等不满意再去打开源码修改就行，</p><p>其实只有会一点前端知识便可以对源码大概进行你想要的定制呢，</p><p>耐心的可以研究下主题构造也不错呢。</p><p>今天天气不错！加油！！！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客 </tag>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>你好 hexo</title>
      <link href="/posts/509442df.html"/>
      <url>/posts/509442df.html</url>
      
        <content type="html"><![CDATA[<h2 id="你好-hexo"><a href="#你好-hexo" class="headerlink" title="你好 hexo"></a>你好 hexo</h2><blockquote><p>今天天气不错！！</p></blockquote><hr><h3 id="1-加油自己"><a href="#1-加油自己" class="headerlink" title="1.  加油自己"></a>1.  加油自己</h3><ul><li>今天天气不错！！</li><li>明天的你也要努力哦！</li><li>请一直加油下去哦！</li></ul><h3 id="2-一言语录"><a href="#2-一言语录" class="headerlink" title="2.  一言语录"></a>2.  一言语录</h3><blockquote><p>肌肤冰凉，寂静而干燥的空气，洗过的床单让气氛变得格外柔和，那个残忍的男子，说要让我再做一次美梦</p></blockquote><blockquote><p>正因为有了音乐，才有了相遇的瞬间，有了相会的感动，有了相逢的人们，有了邂逅的思念。</p></blockquote><blockquote><p>或许前路永夜，即便如此我也要前进，因为星光即使微弱也会为我照亮前路</p></blockquote><blockquote><p>仿佛要消失般的羸弱，但是，仍旧拼命绽放着光芒。怦怦，怦怦，如同心跳一般，这就是生命之灯</p></blockquote><blockquote><p>你的所言所行，全都闪烁着光芒，太过刺目，于是我闭上双眼，但内心还是无法停止对你的憧憬</p></blockquote><blockquote><p>车轮的金属音，不规则的足音，舌尖上面残留的淡淡红茶苦涩。平凡而无谓的对话，随处可见的风景。即使如此，却还是记得那么明晰。这一定，一定，是身处夏夜的错</p></blockquote><blockquote><p>四月是你的谎言，我知道…是谎言就一定会有被揭穿的时候。</p></blockquote><blockquote><p>继续踏上旅途，在没有你的春天</p></blockquote><blockquote><p>但是在喜欢和不讨厌之间，可是相隔了数亿光年都不止的距离啊！</p></blockquote><blockquote><p>英雄意味着强大，英雄意味着孤独，最后一幕一定是英雄渐行渐远，我的英雄也是那样的存在</p></blockquote><h3 id="3-未来可期"><a href="#3-未来可期" class="headerlink" title="3.未来可期"></a>3.未来可期</h3><pre class=" language-java"><code class="language-java">system<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"未来的你会感谢现在努力的你！加油！"</span><span class="token punctuation">)</span></code></pre><p><a href="https://imgchr.com/i/1vDjL8" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s2.ax1x.com/2020/02/15/1vDjL8.md.jpg" alt="1vDjL8.md.jpg"></a></p><hr>]]></content>
      
      
      <categories>
          
          <category> 杂文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
